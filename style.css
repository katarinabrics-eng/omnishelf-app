        @import url('./css/tags.css');

        :root {
            --bg: #F9FAFB;
            --surface: #F9FAFB;
            --surface-elevated: #FFFFFF;
            --border: #e5e7eb;
            --border-soft: #f3f4f6;
            --text: #1D1D1F;
            --text-secondary: #6b7280;
            --text-muted: #9ca3af;
            --btn-primary: #1D1D1F;
            --accent: #84cc16;
            --accent-lime: #8DD311;
            --accent-lime-reading: #D1FF52;
            --accent-soft: rgba(141, 211, 17, 0.12);
            --success: #059669;
            --success-soft: rgba(5, 150, 105, 0.1);
            --error: #dc2626;
            --error-soft: rgba(220, 38, 38, 0.1);
            --radius: 14px;
            --radius-card: 20px;
            --radius-sm: 10px;
            --shadow: 0 1px 2px rgba(0, 0, 0, 0.04);
            --shadow-card: 0 10px 40px rgba(0, 0, 0, 0.04);
            --shadow-hover: 0 8px 28px rgba(0, 0, 0, 0.08);
            --kids-yellow: #FFD966;
            --kids-bg: #FEF9C3;
            --kids-bg-active: #FEF08A;
            --pracovna-limo: #8CD632;
        }

        /* Štítky: viz css/tags.css */

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            max-width: 100vw;
            overflow-x: hidden;
        }
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg);
            color: var(--text);
            min-height: 100vh;
            line-height: 1.6;
        }

        /* PWA / mobil: zamezení zasekávání a nechtěného zoomu při tapu */
        button, a, [role="button"], .sidebar-nav-item, .sidebar-submenu-item, .bottom-tab-item,
        .library-module-tab, .reading-bubble, .reading-mood-btn, .reading-genre-btn {
            cursor: pointer;
            touch-action: manipulation;
        }
        .bottom-tab-bar a, .bottom-tab-bar button { cursor: pointer; }

        /* #content-area – načtený modul (Knihovna / Tržiště) */
        #content-area {
            padding: 1.5rem;
            min-height: 60vh;
            background: var(--bg);
        }
        #content-area:not([style*="display: none"]) { display: block !important; }

        /* Placeholder při chybě nebo pro library-content */
        .content-area-placeholder {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 50vh;
            padding: 2rem;
        }
        .content-area-placeholder-box {
            background: var(--surface-elevated);
            border-radius: 20px;
            padding: 2rem;
            max-width: 420px;
            text-align: center;
            box-shadow: var(--shadow-card);
            border: 1px solid var(--border);
        }
        .content-area-placeholder-icon { width: 80px; height: 80px; margin-bottom: 1rem; object-fit: contain; }
        .content-area-placeholder-title { font-size: 1.25rem; margin-bottom: 0.5rem; color: var(--text); }
        .content-area-placeholder-text { color: var(--text-muted); font-size: 0.9375rem; margin-bottom: 0.75rem; }
        .content-area-placeholder-hint { font-size: 0.8125rem; color: var(--text-secondary); margin-top: 1rem; }
        .content-area-placeholder-hint code { background: rgba(141, 211, 17, 0.2); padding: 0.2em 0.4em; border-radius: 6px; font-size: 0.85em; }
        .content-area-placeholder--error .content-area-placeholder-title { color: var(--error); }

        /* === Dashboard Layout === */
        .dashboard {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            width: 260px;
            flex-shrink: 0;
            background: var(--surface-elevated);
            border-right: none;
            box-shadow: 1px 0 0 var(--border-soft);
            display: flex;
            flex-direction: column;
            z-index: 1050;
            position: relative;
        }

        .sidebar-header {
            padding: 28px 24px 24px;
            border-bottom: 1px solid var(--border-soft);
        }
        .viewing-as-child .sidebar-header {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            align-items: center;
        }
        .btn-back-to-dashboard {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 8px 12px;
            background: transparent;
            border: none;
            cursor: pointer;
            font-family: inherit;
        }
        .btn-back-to-dashboard .btn-back-arrow {
            font-size: 1rem;
            font-weight: 700;
        }
        .btn-back-to-dashboard .btn-back-text {
            font-size: 0.75rem;
            font-weight: 500;
            color: #9ca3af;
        }
        .btn-back-to-dashboard:hover .btn-back-text {
            color: #6b7280;
        }

        .sidebar-logo {
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            text-align: left;
            border: none;
            background: none;
            padding: 0;
            width: 100%;
            transition: opacity 0.15s;
        }

        .sidebar-logo:hover {
            opacity: 0.85;
        }

        .sidebar-logo-icon {
            width: 40px;
            height: 40px;
            background: var(--accent);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .sidebar-logo-icon svg {
            width: 22px;
            height: 22px;
            color: white;
        }
        .sidebar-logo-icon img.sidebar-logo-img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .sidebar-logo-inner {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            justify-content: center;
        }

        .sidebar-logo-text {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--text);
        }

        .sidebar-tagline {
            font-size: 0.75rem;
            color: var(--text-muted);
            margin-top: 4px;
        }

        .sidebar-slogan {
            font-size: 0.7rem;
            color: var(--text-muted);
            margin-top: 2px;
            line-height: 1.3;
            max-width: 180px;
        }

        .sidebar-nav {
            padding: 20px 16px;
            flex: 1;
        }
        body:not(.viewing-as-child) .sidebar-nav-item,
        body:not(.viewing-as-child) .sidebar-submenu-item { letter-spacing: 0.03em; padding-top: 14px; padding-bottom: 14px; }
        .sidebar-nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px 18px;
            min-height: 48px;
            box-sizing: border-box;
            border-radius: var(--radius-sm);
            font-size: 0.9375rem;
            font-weight: 500;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.15s;
            border: none;
            background: none;
            width: 100%;
            text-align: left;
            font-family: inherit;
        }

        .sidebar-nav-item:hover {
            background: rgba(0, 0, 0, 0.04);
            color: var(--text);
        }

        .sidebar-nav-item,
        .mood-btn,
        .item-card,
        .add-book-btn,
        .btn-show-more,
        .btn-add-detail-universal,
        .btn-export,
        .btn-add-scan,
        .analyze-button,
        .btn-recommendation,
        .btn-modal-cancel,
        .btn-modal-submit,
        .mood-custom-search-btn {
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .mood-btn:hover,
        .add-book-btn:hover,
        .btn-show-more:hover,
        .btn-add-detail-universal:hover,
        .btn-export:hover,
        .btn-add-scan:hover,
        .analyze-button:hover:not(:disabled),
        .btn-recommendation:hover:not(:disabled),
        .btn-modal-submit:hover,
        .mood-custom-search-btn:hover {
            transform: scale(1.02);
        }

        /* Dospělý režim: tlačítka s tmavým pozadím mají vždy bílý text */
        body:not(.viewing-as-child) .btn-modal-submit,
        body:not(.viewing-as-child) .btn-show-more:hover,
        body:not(.viewing-as-child) .btn-add-scan:hover,
        body:not(.viewing-as-child) .analyze-button,
        body:not(.viewing-as-child) .btn-recommendation:not(:disabled),
        body:not(.viewing-as-child) .manual-add-form .btn-add-manually,
        body:not(.viewing-as-child) .btn-lend,
        body:not(.viewing-as-child) .pracovna-card .btn-ai-presentation,
        body:not(.viewing-as-child) .pracovna-card .btn-voice-briefing,
        body:not(.viewing-as-child) .pracovna-section .btn-ai-presentation,
        body:not(.viewing-as-child) .pracovna-section .btn-voice-briefing,
        body:not(.viewing-as-child) .btn-ai-presentation:hover,
        body:not(.viewing-as-child) .btn-voice-briefing:hover,
        body:not(.viewing-as-child) .content-for-collection .btn-ai-presentation,
        body:not(.viewing-as-child) .content-for-collection .btn-voice-briefing,
        body:not(.viewing-as-child) .discworld-collection-modal .btn-ai-presentation,
        body:not(.viewing-as-child) .discworld-collection-modal .btn-voice-briefing,
        body:not(.viewing-as-child) .mood-custom-search-btn:hover,
        body:not(.viewing-as-child) .btn-qr-shelf:hover,
        body:not(.viewing-as-child) .btn-profile-switcher:hover,
        body:not(.viewing-as-child) .btn-inventory-master:hover,
        body:not(.viewing-as-child) .btn-scan-borrowed:hover,
        body:not(.viewing-as-child) .btn-confirm-loan,
        body:not(.viewing-as-child) .add-book-btn,
        body:not(.viewing-as-child) .read-today-btn,
        body:not(.viewing-as-child) .ai-quiz-modal .btn-submit-quiz,
        body:not(.viewing-as-child) .btn-coming-soon-vote:hover,
        body:not(.viewing-as-child) .btn-reminder-go,
        .btn-upload-new-book:hover,
        .children-library-upload-wrap .btn-upload-new-book:hover { color: #FFFFFF !important; }

        .sidebar-nav-item.active {
            background: #8DD311;
            color: #000;
            font-weight: 600;
        }
        .sidebar-coming-soon {
            opacity: 0.75;
            cursor: not-allowed;
        }
        .sidebar-coming-soon:hover {
            opacity: 0.9;
            background: rgba(0, 0, 0, 0.04);
        }
        .sidebar-badge-coming {
            font-size: 0.65rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.04em;
            color: var(--text-muted);
            margin-left: 6px;
        }
        .sidebar-nav-icon { margin-right: 6px; }
        .sidebar-nav-icon-img {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 22px;
            height: 22px;
            flex-shrink: 0;
        }
        .sidebar-nav-icon-img img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .sidebar-submenu {
            padding-left: 12px;
            margin-top: 4px;
            margin-bottom: 8px;
        }
        .sidebar-section-title {
            font-size: 0.75rem;
            font-weight: 900;
            letter-spacing: 0.08em;
            text-transform: uppercase;
            color: var(--text-muted);
            padding: 10px 16px 0;
        }
        .sidebar-library-accordion-toggle {
            display: flex;
            align-items: center;
            justify-content: space-between;
            width: 100%;
            background: none;
            border: none;
            cursor: pointer;
            font: inherit;
            text-align: left;
            padding: 10px 16px 0;
        }
        .sidebar-library-accordion-toggle:hover { color: var(--text); }
        .sidebar-library-accordion-toggle::after {
            content: '';
            display: inline-block;
            width: 0;
            height: 0;
            border-left: 4px solid transparent;
            border-right: 4px solid transparent;
            border-top: 5px solid currentColor;
            opacity: 0.7;
            transition: transform 0.2s;
        }
        #sidebarMainLibrary:not(.expanded) .sidebar-library-accordion-toggle::after { transform: rotate(-90deg); }
        .sidebar-submenu-visible { display: block !important; }
        .sidebar-group-expandable .sidebar-submenu { display: none; }
        .sidebar-group-expandable.expanded .sidebar-submenu { display: block; }
        .sidebar-divider {
            margin: 10px 16px;
            border: none;
            border-top: 1px solid rgba(0, 0, 0, 0.06);
        }
        .sidebar-back-to-library {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 8px 16px;
            margin: 4px 8px 0;
            font-size: 0.75rem;
            font-weight: 500;
            color: var(--kids-yellow);
            background: none;
            border: none;
            cursor: pointer;
            font-family: inherit;
            text-align: left;
            width: calc(100% - 16px);
            transition: opacity 0.15s;
        }
        .sidebar-back-to-library:hover {
            opacity: 0.85;
        }
        .sidebar-back-to-library .sidebar-back-arrow {
            color: inherit;
            font-weight: 700;
        }
        #sidebarMainLibrary.expanded #librarySubmenu {
            background: #f7fee7;
            border-radius: var(--radius-sm);
            margin: 4px 8px 4px 0;
            padding: 4px 0;
        }
        .sidebar-kids-icon { display: inline-block; margin-right: 6px; font-size: 1rem; line-height: 1; }
        .sidebar-nav-toggle::after {
            content: '';
            display: inline-block;
            margin-left: auto;
            width: 0; height: 0;
            border-left: 5px solid transparent;
            border-right: 5px solid transparent;
            border-top: 6px solid currentColor;
            opacity: 0.6;
            transition: transform 0.2s;
        }
        .sidebar-group-expandable.expanded .sidebar-nav-toggle::after { transform: rotate(180deg); }
        #btnPracovnaToggle::after { display: none !important; }

        /* Pravidla sidebaru: Moje knihovna = jemné podbarvení + limetkový okraj vlevo (jako Tvoje sbírka).
           Pracovna a moduly mimo knihovnu = sytá limetka (Limo). OmniShelf Kids = pastelová žlutá. */
        .sidebar-submenu-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 16px;
            border-radius: var(--radius-sm);
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.15s;
            border: none;
            background: none;
            width: 100%;
            text-align: left;
            font-family: inherit;
        }

        .sidebar-submenu-item:hover {
            background: rgba(0, 0, 0, 0.04);
            color: var(--text);
        }

        .sidebar-submenu-item.active {
            background: #8DD311;
            color: #000;
            font-weight: 600;
        }
        /* Moje knihovna – všechny podsekce stejný styl jako Tvoje sbírka: jemné podbarvení, jemný limetkový okraj vlevo */
        #librarySubmenu .sidebar-submenu-item.active {
            background: #f7fee7;
            color: var(--text);
            font-weight: 600;
            border: none;
            border-left: 4px solid rgba(132, 204, 22, 0.85);
            margin-left: 0;
            padding-left: 12px;
        }
        /* Přátelé doporučují: dle návrhu sytá limetka jako aktivní */
        #librarySubmenu .sidebar-submenu-item[data-view="friendsHighlights"].active {
            background: #8DD311;
            color: #000;
            border-left: none;
            padding-left: 16px;
        }
        /* Pracovna (Studium): stejné zvýraznění jako ostatní složky (limetková) */
        .sidebar-nav-item[data-module="pracovna"].active,
        .sidebar-nav-item[data-module="marketplace"].active {
            background: #8DD311;
            color: #000;
            font-weight: 600;
            border-radius: 999px;
        }
        /* OmniShelf Kids – specifická pastelová žlutá jako na screenu */
        .sidebar-library-group#sidebarChildrenLibrary .sidebar-nav-item {
            background: var(--kids-bg);
            color: #000;
            font-weight: 600;
            border-radius: 12px;
        }
        .sidebar-library-group#sidebarChildrenLibrary .sidebar-nav-item:hover {
            background: var(--kids-bg-active);
            color: #000;
        }
        .sidebar-library-group#sidebarChildrenLibrary .sidebar-nav-item.active {
            background: var(--kids-bg-active);
            color: #000;
        }
        /* OmniShelf Kids tema – zlatá/žlutá místo zelené */
        body.kids-theme .sidebar-nav-item.active,
        body.kids-theme .sidebar-submenu-item.active { background: var(--kids-yellow); color: #000; }
        body.kids-theme #sidebarMainLibrary.expanded #librarySubmenu { background: #fefce8; }
        body.kids-theme .sidebar-rodina-item.active { background: rgba(234, 179, 8, 0.25); }
        body.kids-theme .btn-kids-full-version { background: var(--kids-yellow); }
        body.kids-theme .btn-activate-membership { background: var(--kids-yellow); border-color: var(--kids-yellow); }
        body.kids-theme .add-book-btn,
        body.kids-theme .btn-show-more:hover,
        body.kids-theme .btn-add-scan:hover,
        body.kids-theme .analyze-button,
        body.kids-theme .btn-recommendation:not(:disabled),
        body.kids-theme .read-today-btn,
        body.kids-theme .mood-custom-search-btn:hover { background: var(--kids-yellow) !important; color: #000 !important; border-color: var(--kids-yellow) !important; }
        body.kids-theme .item-card-clean.highlight-match,
        body.kids-theme .item-card.highlight-match { box-shadow: 0 0 0 2px rgba(255, 217, 102, 0.4); }

        .sidebar-stats {
            padding: 16px 24px;
            font-size: 0.8125rem;
            color: var(--text-muted);
            border-top: 1px solid var(--border);
        }

        .sidebar-rodina-divider {
            margin: 12px 16px 10px;
            border: none;
            border-top: 1px solid rgba(0, 0, 0, 0.06);
        }
        .sidebar-rodina-title {
            font-size: 0.7rem;
            font-weight: 600;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            padding: 0 16px 8px;
        }
        .sidebar-rodina-list {
            display: flex;
            flex-direction: column;
            gap: 2px;
            padding: 0 8px 8px;
        }
        .sidebar-rodina-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 12px;
            border-radius: var(--radius-sm);
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.15s;
            border: none;
            background: none;
            width: 100%;
            text-align: left;
            font-family: inherit;
        }
        .sidebar-rodina-item:hover {
            background: rgba(0, 0, 0, 0.04);
            color: var(--text);
        }
        .sidebar-rodina-item.active {
            background: rgba(141, 211, 17, 0.2);
            color: #1d1d1f;
        }
        .sidebar-rodina-item .kids-icon {
            width: 18px;
            height: 18px;
            font-size: 1rem;
            line-height: 1;
            flex-shrink: 0;
        }
        .sidebar-nav-settings {
            font-weight: 700;
            color: var(--text) !important;
            font-size: 0.9375rem;
        }
        .sidebar-nav-settings:hover {
            color: var(--text) !important;
        }
        .sidebar-export {
            padding: 16px 24px;
            border-top: 1px solid var(--border);
        }

        .sidebar-export-title {
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 12px;
        }

        .sidebar-export-btns {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .btn-export {
            padding: 8px 14px;
            font-size: 0.8125rem;
            font-weight: 500;
            border-radius: var(--radius-sm);
            border: 1px solid var(--border);
            background: var(--surface-elevated);
            color: var(--text);
            cursor: pointer;
            font-family: inherit;
            transition: all 0.15s;
        }

        .btn-export:hover {
            background: var(--accent-soft);
            border-color: var(--text);
            color: var(--text);
        }

        .btn-export--inline {
            width: auto;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        /* Modul Statistiky: skrýt knihovnu a ukázat Statistiky */
        body.module-statistics #statisticsSection { display: block !important; }
        body.module-statistics #readingViewWrap,
        body.module-statistics #libraryModulesWrap,
        body.module-statistics #scanHistorySection,
        body.module-statistics #resultsSectionWrap,
        body.module-statistics #friendsRecommendationsSection {
            display: none !important;
        }

        .heart-btn {
            background: none;
            border: none;
            padding: 4px;
            cursor: pointer;
            color: var(--text-muted);
            transition: color 0.15s;
        }

        .heart-btn:hover {
            color: var(--error);
        }

        .heart-btn.active {
            color: var(--error);
        }

        .heart-btn svg {
            width: 18px;
            height: 18px;
        }

        /* Main content */
        .main-content {
            flex: 1;
            min-width: 0;
            padding: 2rem 3rem 4rem;
            overflow-y: auto;
        }

        .content-for-collection {
            padding: 2rem 0;
        }

        .content-for-collection-main {
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }
        .collection-grid-cols {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            align-items: stretch;
        }
        @media (max-width: 768px) {
            .collection-grid-cols { grid-template-columns: 1fr; }
        }
        .collection-card {
            background: #FFFFFF;
            border-radius: 1.5rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.06);
            padding: 2rem;
            display: flex;
            flex-direction: column;
        }
        .collection-card-instructions {
            background: #FFFFFF;
            border-radius: 1.5rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.06);
            padding: 2rem;
            display: flex;
            flex-direction: column;
        }
        .collection-card-instructions .collection-tips-title {
            font-size: 1.125rem;
            font-weight: 700;
            color: #166534;
            margin: 0 0 1.25rem 0;
        }
        .collection-card-instructions .collection-intro p {
            margin: 0 0 1rem 0;
            line-height: 1.6;
            color: var(--text-secondary);
        }
        .collection-card-instructions .collection-intro .keyword {
            font-weight: 700;
            color: var(--accent-lime);
        }
        .collection-card-instructions .collection-shelf-footer {
            margin-top: auto;
            padding-top: 1.5rem;
            border-top: 1px solid var(--border-soft);
        }
        .collection-intro-video-btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 12px 20px;
            background: #f7fee7;
            color: #166534;
            font-weight: 600;
            font-size: 0.95rem;
            text-decoration: none;
            border-radius: var(--radius);
            border: none;
            cursor: pointer;
            font-family: inherit;
            margin-top: 0.5rem;
            transition: background 0.2s, color 0.2s;
        }
        .collection-intro-video-btn:hover {
            background: rgba(141, 211, 17, 0.3);
            color: #14532d;
        }

        .top-bar {
            display: flex;
            align-items: center;
            gap: 16px;
            margin: -2rem -3rem 1.5rem -3rem;
            padding: 10px 3rem 12px;
            min-height: 48px;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        .main-top-bar {
            justify-content: space-between;
            align-items: center;
        }
        .main-top-bar .trial-banner {
            flex: 1;
            min-width: 0;
        }
        .main-top-bar .header-actions {
            align-items: center;
            flex-shrink: 0;
        }
        /* Hamburger – pouze na mobilu */
        .btn-mobile-menu-toggle {
            display: none;
            align-items: center;
            justify-content: center;
            width: 44px;
            height: 44px;
            padding: 0;
            border: none;
            background: transparent;
            color: var(--text);
            font-size: 1.5rem;
            cursor: pointer;
            border-radius: var(--radius);
            flex-shrink: 0;
        }
        .btn-mobile-menu-toggle:hover { background: rgba(0,0,0,0.06); }
        .btn-sidebar-close-mobile { display: none; }
        .main-top-bar .main-top-bar-title {
            margin: 0;
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text);
        }
        /* Odstup mezi zelenou lištou a dvěma bílými kartami (Tipy + Nahrávání) cca 30–40px */
        .library-upload-two-cards {
            margin-top: 36px;
        }
        /* Zelený trial banner vždy viditelný pro admin (ladění) */
        .trial-banner-admin-visible {
            display: flex !important;
        }
        .top-bar.has-trial {
            background: #f7fee7 !important;
            color: #166534;
            padding: 8px 3rem;
            min-height: 40px;
        }
        .trial-banner {
            display: flex;
            align-items: center;
            flex: 1;
            flex-wrap: nowrap;
            gap: 8px;
            padding: 0;
            margin: 0;
            border: none;
            border-radius: 0;
            background: transparent;
            color: #166534;
            min-width: 0;
        }
        .trial-banner .trial-banner-text {
            flex: 1;
            margin: 0;
            font-size: 0.75rem;
            line-height: 1.3;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .trial-banner .trial-banner-icon {
            flex-shrink: 0;
            font-size: 0.9rem;
            color: #0d4a2d !important;
        }
        .trial-banner .trial-banner-text {
            color: #0d4a2d !important;
        }
        .top-bar.has-trial .trial-banner .trial-banner-icon,
        .top-bar.has-trial .trial-banner .trial-banner-text {
            color: #0d4a2d !important;
        }
        .trial-banner .trial-banner-cta {
            flex-shrink: 0;
            padding: 0;
            margin-left: auto;
            margin-right: 16px;
            font-size: 0.75rem;
            font-weight: 500;
            border: none;
            background: none;
            color: #14532d;
            text-decoration: underline;
            text-underline-offset: 2px;
            text-decoration-thickness: 1px;
            cursor: pointer;
            font-family: inherit;
        }
        .trial-banner .trial-banner-cta:hover {
            color: #0f5132;
        }
        .top-bar.has-trial.urgent {
            background: #fef2f2;
            color: #991b1b;
        }
        .trial-banner.urgent {
            color: #991b1b;
        }
        .trial-banner.urgent .trial-banner-icon { color: #991b1b; }
        .trial-banner.urgent .trial-banner-icon::before { content: '⚠️'; }
        .trial-banner.urgent .trial-banner-cta { color: #991b1b; }
        .trial-banner:not(.urgent) .trial-banner-icon::before { content: '⏱'; }
        .btn-delete-account-settings { margin-top: 10px; padding: 12px 20px; font-size: 0.95rem; font-weight: 600; border: none; background: #dc2626; color: #fff; border-radius: var(--radius-sm); cursor: pointer; display: block; width: 100%; max-width: 320px; box-shadow: 0 2px 8px rgba(220, 38, 38, 0.3); }
        .btn-delete-account-settings:hover { background: #b91c1c; color: #fff; }
        .btn-delete-account-kids { padding: 18px 32px; font-size: 1.15rem; font-weight: 700; border: none; border-radius: var(--radius); cursor: pointer; background: #dc2626; color: #fff; display: block; width: 100%; margin-top: 8px; box-shadow: 0 2px 8px rgba(220, 38, 38, 0.3); }
        .btn-delete-account-kids:hover { background: #b91c1c; }
        .btn-kids-full-version { padding: 18px 32px; font-size: 1.15rem; font-weight: 700; border: none; border-radius: var(--radius); cursor: pointer; background: #8DD311; color: #000; display: block; width: 100%; margin-bottom: 24px; }
        .btn-kids-full-version:hover { background: #7bc00f; color: #000; }
        .settings-kids-content { padding: 8px 0; }
        .btn-delete-member-profile { margin-left: 8px; padding: 6px 12px; font-size: 0.8rem; border: 1px solid #dc2626; background: transparent; color: #dc2626; border-radius: 6px; cursor: pointer; }
        .btn-delete-member-profile:hover { background: #fef2f2; }
        .settings-family-actions { display: inline-flex; align-items: center; gap: 8px; flex-wrap: wrap; }
        .btn-activate-membership { padding: 10px 20px; font-size: 0.9rem; font-weight: 600; border: 1px solid #8DD311; background: #8DD311; color: #000; border-radius: var(--radius-sm); cursor: pointer; }
        .btn-activate-membership:hover { background: #7bc00f; color: #000; border-color: #7bc00f; }

        .main-header {
            margin-top: 1.5rem;
            margin-bottom: 40px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 24px;
            flex-wrap: wrap;
        }
        .collection-two-col-card {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            background: var(--surface-elevated);
            border-radius: var(--radius-card);
            box-shadow: var(--shadow-card);
            padding: 2rem;
            margin-bottom: 2.5rem;
        }
        @media (max-width: 800px) {
            .collection-two-col-card { grid-template-columns: 1fr; }
        }
        .collection-col-instructions {
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
        }
        .collection-intro {
            color: var(--text-secondary);
            font-size: 1rem;
            line-height: 1.75;
            margin: 0;
        }
        .collection-intro p {
            margin: 0 0 1.25rem 0;
        }
        .collection-intro p:last-of-type {
            margin-bottom: 1.25rem;
        }
        .collection-intro-video-link {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 10px 16px;
            background: var(--accent-soft);
            color: var(--accent-lime);
            font-weight: 600;
            font-size: 0.95rem;
            text-decoration: none;
            border-radius: var(--radius-sm);
            transition: background 0.2s, color 0.2s;
        }
        .collection-intro-video-link:hover {
            background: var(--accent-lime);
            color: #000;
        }
        .collection-col-actions {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }
        .collection-col-actions .current-shelf-banner {
            margin-bottom: 0;
        }
        .collection-col-actions .upload-section {
            margin-bottom: 0;
        }

        .main-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--text);
        }
        .main-content.view-collection .main-header {
            justify-content: center;
            width: 100%;
        }
        .main-content.view-collection .main-header .main-title {
            text-align: center;
            margin-top: 4rem;
            width: 100%;
        }

        .global-search-wrap {
            position: relative;
            display: flex;
            align-items: center;
            gap: 0;
        }

        .library-global-sort-wrap {
            display: flex;
            align-items: center;
            margin-left: 10px;
        }
        .library-global-sort-select {
            height: 35px;
            padding: 0 10px;
            border-radius: var(--radius);
            border: 1px solid var(--border);
            background: var(--surface);
            color: var(--text);
            font-size: 0.85rem;
            cursor: pointer;
            transition: background 0.2s, border-color 0.2s;
        }
        .library-global-sort-select:hover {
            background: var(--accent-soft);
            border-color: var(--text);
        }
        .library-filter-summary {
            margin-left: 10px;
            font-size: 0.8125rem;
            color: var(--text-muted);
            white-space: nowrap;
            max-width: 38vw;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .btn-global-search-toggle {
            width: 35px !important;
            height: 35px !important;
            min-width: 35px !important;
            min-height: 35px !important;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: var(--radius);
            border: 1px solid var(--border);
            background: var(--surface);
            color: var(--text);
            cursor: pointer;
            transition: all 0.2s;
        }
        .btn-global-search-toggle:hover {
            background: var(--accent-soft);
            border-color: var(--text);
        }
        .btn-global-search-toggle .search-icon-svg {
            width: 18px !important;
            height: 18px !important;
        }
        .top-bar.has-trial .btn-global-search-toggle {
            border-color: rgba(22, 101, 52, 0.4);
            background: rgba(255,255,255,0.6);
            color: #166534;
        }
        .top-bar.has-trial .btn-global-search-toggle:hover {
            background: rgba(255,255,255,0.9);
        }
        .global-search-bar {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-left: 8px;
            max-width: 0;
            min-width: 0;
            overflow: hidden;
            opacity: 0;
            transition: max-width 0.3s ease, opacity 0.2s ease;
        }

        .upload-subtitle {
            margin-top: 10px;
            margin-bottom: 8px;
            font-size: 0.85rem;
            font-weight: 700;
            color: var(--text);
        }
        .upload-divider {
            height: 1px;
            background: rgba(0, 0, 0, 0.08);
            margin: 14px 0;
        }
        .image-preview-multi {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(56px, 1fr));
            gap: 6px;
            margin-top: 10px;
        }
        .image-preview-multi img {
            width: 100%;
            aspect-ratio: 1/1;
            object-fit: cover;
            border-radius: 10px;
            border: 1px solid rgba(0, 0, 0, 0.12);
            background: #fff;
        }
        .global-search-bar.expanded {
            max-width: 320px;
            min-width: 220px;
            opacity: 1;
        }
        .global-search-bar input {
            padding: 10px 16px;
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            font-size: 0.9rem;
            font-family: inherit;
            color: var(--text);
            background: var(--surface-elevated);
            width: 220px;
            min-width: 0;
        }
        .global-search-bar input:focus {
            outline: none;
            border-color: var(--text);
        }
        .btn-global-search-close {
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: none;
            background: transparent;
            color: var(--text-muted);
            font-size: 1.5rem;
            cursor: pointer;
            border-radius: var(--radius-sm);
        }
        .btn-global-search-close:hover {
            color: var(--text);
            background: var(--accent-soft);
        }
        .global-search-results {
            position: absolute;
            top: 100%;
            left: 0;
            margin-top: 8px;
            min-width: 320px;
            max-width: 420px;
            max-height: 70vh;
            overflow-y: auto;
            background: var(--surface-elevated);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            z-index: 200;
            padding: 8px 0;
        }
        .global-search-results:empty { display: none !important; }
        .global-search-accordion-section {
            border: none;
            padding: 0;
            margin: 0;
            background: none;
        }
        .global-search-accordion-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            width: 100%;
            padding: 10px 14px;
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--accent-lime);
            background: rgba(141, 211, 17, 0.08);
            border: none;
            cursor: pointer;
            text-align: left;
            border-radius: 6px;
            margin: 4px 8px;
        }
        .global-search-accordion-header:hover {
            background: rgba(141, 211, 17, 0.14);
        }
        .global-search-accordion-content {
            padding: 4px 8px 12px 16px;
        }
        .global-search-result-item {
            display: block;
            padding: 8px 12px;
            font-size: 0.9rem;
            color: var(--text);
            text-decoration: none;
            border-radius: 6px;
            transition: background 0.15s;
        }
        .global-search-result-item:hover {
            background: var(--accent-soft);
        }
        .global-search-result-item .result-title { font-weight: 500; }
        .global-search-result-item .result-location { font-size: 0.8rem; color: var(--text-muted); margin-top: 2px; }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 16px;
        }
        .profile-switcher-wrap {
            position: relative;
        }
        .btn-profile-switcher {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            border: 1px solid var(--btn-primary);
            background: var(--accent-soft);
            color: var(--text);
            font-size: 0.7rem;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }
        .btn-profile-switcher:hover {
            background: var(--btn-primary);
            color: white;
        }
        .top-bar.has-trial .btn-profile-switcher {
            border-color: rgba(22, 101, 52, 0.4);
            background: rgba(255,255,255,0.6);
            color: #166534;
        }
        .top-bar.has-trial .btn-profile-switcher:hover {
            background: rgba(255,255,255,0.9);
            color: #166534;
        }
        .profile-dropdown {
            position: absolute;
            top: calc(100% + 8px);
            right: 0;
            min-width: 220px;
            background: var(--surface-elevated);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            z-index: 100;
            padding: 8px 0;
        }
        .profile-dropdown-settings {
            border-bottom: 1px solid var(--border);
            margin-bottom: 4px;
            font-weight: 500;
        }
        .profile-dropdown-list {
            max-height: 240px;
            overflow-y: auto;
        }
        .profile-dropdown-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 14px;
            cursor: pointer;
            border: none;
            background: none;
            width: 100%;
            text-align: left;
            font-size: 0.9rem;
            color: var(--text);
        }
        .profile-dropdown-item:hover {
            background: var(--accent-soft);
        }
        .profile-dropdown-item.active {
            background: var(--accent-soft);
            color: var(--text);
            font-weight: 500;
        }
        .profile-dropdown-row {
            display: flex;
            align-items: center;
            gap: 8px;
            width: 100%;
        }
        .profile-dropdown-row .profile-dropdown-item { flex: 1; }
        .profile-dropdown-remove {
            flex-shrink: 0;
            padding: 4px 10px;
            font-size: 0.75rem;
            border: 1px solid var(--border);
            border-radius: 6px;
            background: var(--surface);
            color: var(--text-secondary);
            cursor: pointer;
            transition: border-color 0.2s, color 0.2s;
        }
        .profile-dropdown-remove:hover {
            border-color: var(--error);
            color: var(--error);
        }
        .profile-add-member {
            width: 100%;
            padding: 10px 14px;
            border: none;
            border-top: 1px solid var(--border);
            background: none;
            color: var(--text);
            font-size: 0.85rem;
            cursor: pointer;
            text-align: left;
        }
        .profile-add-member:hover {
            background: var(--accent-soft);
        }
        .record-loan-family-chips {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 10px;
        }
        .record-loan-family-chip {
            padding: 6px 12px;
            font-size: 0.8rem;
            border-radius: 999px;
            border: 1px solid var(--border);
            background: var(--surface);
            color: var(--text-secondary);
            cursor: pointer;
        }
        .record-loan-family-chip:hover {
            border-color: var(--text);
            color: var(--text);
        }

        .search-bar {
            flex: 1;
            min-width: 200px;
            max-width: 360px;
        }

        .search-bar input {
            width: 100%;
            padding: 10px 16px 10px 40px;
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            font-size: 0.9rem;
            font-family: inherit;
            color: var(--text);
            background: var(--surface-elevated) url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='18' height='18' viewBox='0 0 24 24' fill='none' stroke='%239ca3af' stroke-width='2'%3E%3Ccircle cx='11' cy='11' r='8'/%3E%3Cpath d='m21 21-4.35-4.35'/%3E%3C/svg%3E") no-repeat 12px center;
            background-size: 18px;
        }

        .search-bar input:focus {
            outline: none;
            border-color: var(--text);
        }

        .search-bar input::placeholder {
            color: var(--text-muted);
        }

        .search-bar {
            display: flex;
            align-items: center;
            gap: 8px;
            flex: 1;
        }

        .search-bar > input {
            flex: 1;
            min-width: 0;
        }

        .btn-add-detail-universal {
            width: 40px;
            height: 40px;
            padding: 0;
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            background: var(--surface);
            cursor: pointer;
            font-size: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .btn-add-detail-universal:hover {
            background: var(--accent-soft);
            border-color: var(--text);
        }

        .analyze-row {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .search-result-hint {
            font-size: 0.8rem;
            color: var(--text);
            margin-top: 6px;
        }

        .section-divider {
            height: 1px;
            background: var(--border-soft);
            margin: 2.5rem 0;
            border: none;
        }


        .highlight-match {
            background: rgba(107, 144, 128, 0.25) !important;
            box-shadow: 0 0 0 2px var(--btn-primary);
            animation: highlight-pulse 0.5s ease;
        }

        @keyframes highlight-pulse {
            0% { box-shadow: 0 0 0 4px var(--btn-primary); }
            100% { box-shadow: 0 0 0 2px var(--btn-primary); }
        }

        /* Upload - čistá bílá karta s jemnou přerušovanou čárou */
        .upload-section {
            background: var(--surface-elevated);
            border: none;
            border-radius: var(--radius-card);
            box-shadow: var(--shadow-card);
            padding: 2.5rem;
            margin-bottom: 2.5rem;
        }

        .upload-section-title {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 1.25rem;
        }

        .upload-area {
            border: 2px dashed var(--border);
            border-radius: var(--radius-card);
            padding: 3rem 2rem;
            cursor: pointer;
            transition: all 0.2s;
            background: var(--surface-elevated);
            text-align: center;
        }

        /* Globální zmenšení upload zón v knihovně (jemně, bez vlivu na jiné sekce) */
        .library-module-upload .upload-area {
            padding: 1.8rem 1.5rem;
        }

        .upload-area:hover {
            border-color: var(--accent-lime);
            background: var(--accent-soft);
        }

        .upload-area.dragover {
            border-color: var(--accent-lime);
            background: var(--accent-soft);
        }
        .upload-area.has-file {
            border-color: var(--accent-lime);
            background: var(--accent-soft);
        }
        .upload-area-dashed-green {
            border: 2px dashed #166534;
            border-radius: var(--radius-card);
        }
        .upload-area-dashed-green:hover,
        .upload-area-dashed-green.dragover {
            border-color: var(--accent-lime);
            background: var(--accent-soft);
        }
        .upload-icon-camera {
            width: 48px;
            height: 48px;
            margin: 0 auto 12px;
            color: var(--text);
        }
        .upload-icon-camera svg {
            width: 100%;
            height: 100%;
        }

        /* Moduly knihovny: Texty | Upload souborů */
        .library-modules-wrap {
            margin-top: 24px;
        }
        .library-module-tabs {
            display: flex;
            gap: 4px;
            margin-bottom: 20px;
            border-bottom: 2px solid var(--border-soft);
            padding-bottom: 0;
        }

        /* Globální stavový řádek pro panel přidávání (Texty + Upload) */
        .library-modules-status-bar {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 10px 12px;
            border: 1px dashed rgba(0,0,0,0.18);
            border-radius: 16px;
            background: rgba(255,255,255,0.75);
            margin: 10px 0 16px;
        }
        .library-modules-status-text {
            font-size: 0.95rem;
            color: var(--text-secondary);
            flex: 1;
            min-width: 0;
        }
        .library-modules-open-btn {
            appearance: none;
            border: 1px solid rgba(141, 211, 17, 0.65);
            background: rgba(141, 211, 17, 0.14);
            color: #14532d;
            border-radius: 999px;
            padding: 10px 14px;
            font-weight: 800;
            cursor: pointer;
            flex-shrink: 0;
        }
        .library-modules-open-btn:hover { background: rgba(141, 211, 17, 0.20); }
        .library-modules-close-btn {
            width: 40px;
            height: 40px;
            border-radius: 12px;
            border: 1px solid var(--border);
            background: #fff;
            color: var(--text);
            font-size: 22px;
            line-height: 1;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }
        .library-modules-close-btn:hover { background: rgba(0,0,0,0.03); }

        /* Texty: rychlé ruční přidání */
        .text-quick-add-form {
            background: #fff;
            border: 1px solid rgba(0,0,0,0.08);
            border-radius: 18px;
            padding: 14px;
            margin-bottom: 14px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }
        .text-quick-add-row {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }
        .text-quick-add-row label { flex: 0 0 90px; margin: 0; }
        .text-quick-add-row input[type="text"] { flex: 1; min-width: 0; margin-bottom: 0 !important; }
        .text-quick-add-row--cover input[type="file"] { flex: 1; min-width: 0; }
        .text-quick-cover-preview img {
            width: 54px;
            height: 72px;
            object-fit: cover;
            border-radius: 10px;
            border: 1px solid rgba(0,0,0,0.12);
            margin-left: 8px;
            background: #fff;
        }
        .text-quick-add-submit {
            width: 100%;
            border: none;
            border-radius: 14px;
            padding: 12px 14px;
            font-weight: 800;
            background: #8DD311;
            color: #000;
            cursor: pointer;
        }
        .text-quick-add-submit:hover { background: #7bc00f; }
        @media (max-width: 640px) {
            .text-quick-add-row { flex-direction: column; align-items: stretch; }
            .text-quick-add-row label { flex: none; }
            .text-quick-cover-preview img { margin-left: 0; margin-top: 8px; }
        }
        .library-module-tab {
            padding: 10px 20px;
            font-family: inherit;
            font-size: 0.9375rem;
            font-weight: 500;
            color: var(--text-secondary);
            background: transparent;
            border: none;
            border-bottom: 3px solid transparent;
            margin-bottom: -2px;
            cursor: pointer;
            border-radius: var(--radius-sm) var(--radius-sm) 0 0;
            transition: color 0.2s, background 0.2s;
        }
        .library-module-tab:hover {
            color: var(--text);
            background: var(--border-soft);
        }
        .library-module-tab.active {
            color: var(--text);
            border-bottom-color: var(--accent-lime);
            background: var(--surface-elevated);
        }
        .library-module {
            display: block;
        }
        .library-module[hidden] {
            display: none !important;
        }
        .library-module-upload .library-upload-two-cards {
            margin-top: 0;
        }

        /* Upload souborů: shell (tipy toggle + zavírání panelu) */
        .library-upload-shell {
            margin-top: 0;
        }
        .library-upload-shell-top {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 10px;
            margin-bottom: 12px;
        }
        .library-upload-tips-toggle {
            appearance: none;
            border: 1px solid var(--border);
            background: #fff;
            color: var(--text);
            border-radius: 999px;
            padding: 10px 14px;
            font-weight: 700;
            cursor: pointer;
            transition: background 0.15s, border-color 0.15s;
        }
        .library-upload-tips-toggle:hover {
            border-color: rgba(141, 211, 17, 0.6);
            background: rgba(141, 211, 17, 0.06);
        }
        .library-upload-shell-close {
            width: 40px;
            height: 40px;
            border-radius: 12px;
            border: 1px solid var(--border);
            background: #fff;
            color: var(--text);
            font-size: 22px;
            line-height: 1;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            transition: background 0.15s, border-color 0.15s;
        }
        .library-upload-shell-close:hover {
            border-color: rgba(0,0,0,0.22);
            background: rgba(0,0,0,0.03);
        }
        .upload-panel-closed-bar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 10px;
            padding: 12px 14px;
            border: 1px dashed rgba(0,0,0,0.18);
            border-radius: 16px;
            background: rgba(255,255,255,0.7);
        }
        .upload-panel-closed-text { color: var(--text-secondary); font-size: 0.9375rem; }
        .upload-panel-closed-btn {
            appearance: none;
            border: 1px solid rgba(141, 211, 17, 0.65);
            background: rgba(141, 211, 17, 0.12);
            color: #14532d;
            border-radius: 999px;
            padding: 10px 14px;
            font-weight: 800;
            cursor: pointer;
        }
        .upload-panel-closed-btn:hover { background: rgba(141, 211, 17, 0.18); }

        .upload-batch-fields {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            margin: 6px 0 10px;
        }
        .upload-batch-fields-compact .upload-batch-field {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .upload-batch-fields-compact .upload-batch-field label {
            flex: 0 0 120px;
            margin: 0;
        }
        .upload-batch-fields-compact .upload-batch-field input {
            flex: 1;
            min-width: 0;
        }
        .upload-inline-row {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 8px 0 10px;
        }
        .upload-inline-input { flex: 1; min-width: 0; margin-bottom: 0 !important; }
        @media (max-width: 768px) {
            .upload-inline-row { flex-direction: column; align-items: stretch; }
            .upload-batch-fields-compact .upload-batch-field { flex-direction: column; align-items: stretch; }
            .upload-batch-fields-compact .upload-batch-field label { flex: none; }
        }

        .upload-card-wide { padding: 1.5rem; }

        .upload-tips-accordion {
            margin: 10px 0 14px;
            padding: 12px 14px;
            border: 1px solid rgba(0,0,0,0.10);
            border-radius: 16px;
            background: rgba(247, 254, 231, 0.55);
        }
        .upload-tips-accordion p { margin: 0 0 8px 0; color: var(--text-secondary); line-height: 1.5; }
        .upload-tips-accordion p:last-child { margin-bottom: 0; }

        /* Tipy modal (otevírá se z drop zóny) */
        .upload-tips-modal-overlay[hidden] { display: none !important; }
        .upload-tips-modal-overlay {
            position: fixed;
            inset: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 18px;
            background: rgba(0,0,0,0.35);
            z-index: 2000;
        }
        .upload-tips-modal {
            width: 100%;
            max-width: 560px;
            background: #fff;
            border-radius: 20px;
            border: 1px solid rgba(0,0,0,0.10);
            box-shadow: 0 20px 60px rgba(0,0,0,0.18);
            overflow: hidden;
        }
        .upload-tips-modal-top {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 10px;
            padding: 14px 16px;
            background: rgba(247, 254, 231, 0.8);
            border-bottom: 1px solid rgba(0,0,0,0.06);
        }
        .upload-tips-modal-title { font-weight: 900; color: var(--text); }
        .upload-tips-modal-close {
            width: 38px;
            height: 38px;
            border-radius: 12px;
            border: 1px solid rgba(0,0,0,0.12);
            background: #fff;
            cursor: pointer;
            font-size: 22px;
            line-height: 1;
        }
        .upload-tips-modal-body {
            padding: 14px 16px 16px;
        }
        .upload-tips-modal-body p { margin: 0 0 10px 0; color: var(--text-secondary); line-height: 1.55; }
        .upload-tips-modal-body p:last-of-type { margin-bottom: 12px; }

        .upload-drop-zone { position: relative; }
        .upload-tips-inzone-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            height: 32px;
            border-radius: 999px;
            border: 1px solid rgba(0,0,0,0.12);
            background: rgba(255,255,255,0.75);
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8125rem;
            font-weight: 700;
            padding: 0 10px;
            transition: background 0.15s, border-color 0.15s, transform 0.15s;
            white-space: nowrap;
        }
        .upload-tips-inzone-btn:hover {
            border-color: rgba(141, 211, 17, 0.6);
            background: rgba(141, 211, 17, 0.10);
        }
        .upload-tips-inzone-btn:active { transform: translateY(1px); }
        .upload-card-label-inline {
            margin-bottom: 6px;
        }
        .upload-batch-input {
            margin-bottom: 0 !important;
            padding: 8px 10px !important;
            font-size: 0.875rem;
        }
        @media (max-width: 768px) {
            .upload-batch-fields { grid-template-columns: 1fr; }
        }

        .library-upload-two-cards {
            display: flex;
            gap: 1.5rem;
            flex-wrap: wrap;
            align-items: stretch;
        }
        .library-upload-two-cards .library-card {
            flex: 1;
            min-width: 280px;
            background: #fff;
            border-radius: 1.5rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.06);
            padding: 2rem;
        }
        .tips-card .tips-card-main-title {
            margin: 0 0 1rem 0;
            font-size: 1.375rem;
            font-weight: 700;
            color: var(--text);
        }
        .tips-card .tips-card-title {
            color: #166534;
            font-weight: 700;
            margin: 0 0 1rem 0;
            font-size: 1.125rem;
        }
        .tips-card .tips-card-body p {
            margin: 0 0 0.75rem 0;
            line-height: 1.6;
            color: var(--text-secondary);
        }
        .tips-card .tips-keyword {
            font-weight: 600;
            color: #166534;
        }
        .tips-card-video-btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 12px 20px;
            background: #f7fee7;
            color: #166534;
            font-weight: 600;
            font-size: 0.95rem;
            text-decoration: none;
            border-radius: var(--radius);
            border: none;
            cursor: pointer;
            font-family: inherit;
            margin-top: 1rem;
            transition: background 0.2s, color 0.2s;
        }
        .tips-card-video-btn:hover {
            background: rgba(141, 211, 17, 0.3);
            color: #14532d;
        }
        .tips-video-compact {
            margin-top: 14px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .tips-video-aspect {
            aspect-ratio: 16 / 9;
            width: 100%;
            max-width: 420px;
            border-radius: 16px;
            border: 1px solid rgba(0,0,0,0.10);
            background: linear-gradient(180deg, rgba(141, 211, 17, 0.14), rgba(255,255,255,1));
            overflow: hidden;
            position: relative;
        }
        .tips-video-placeholder {
            position: absolute;
            inset: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            color: rgba(0,0,0,0.55);
            font-weight: 800;
            font-size: 0.95rem;
            letter-spacing: 0.01em;
        }
        .tips-card-video-btn-compact {
            margin-top: 0;
            width: fit-content;
        }
        .upload-target-hint {
            font-size: 0.8125rem;
            color: var(--text-muted);
            margin: 0 0 10px;
        }
        .upload-target-hint strong { color: var(--text); }
        .upload-card .upload-card-label {
            display: block;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 8px;
            color: var(--text);
        }
        .upload-card .shelf-input {
            width: 100%;
            margin-bottom: 1.25rem;
        }
        .upload-card .upload-area {
            margin-bottom: 0;
        }
        .upload-card .upload-text {
            color: #166534;
            font-weight: 600;
        }
        .upload-card .analyze-button {
            width: 100%;
            margin-top: 1.25rem;
            background: var(--text-secondary);
        }
        .upload-card .analyze-button:hover:not(:disabled) {
            background: var(--text);
        }

        /* Primární CTA pro sken police */
        #analyzeButton {
            background: rgba(141, 211, 17, 0.35);
            color: #14532d;
            font-weight: 800;
        }
        #analyzeButton.is-active {
            background: #8DD311;
            color: #000;
        }
        #analyzeButton.is-active:hover:not(:disabled) {
            background: #7bc00f;
        }
        #analyzeButton:disabled {
            background: var(--text-secondary);
            color: #fff;
            font-weight: 700;
        }

        /* Upload: layout skenů – default pod sebou, po rozbalení tipů vedle sebe */
        .upload-scans-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 18px;
        }
        .library-upload-shell.tips-open .upload-scans-grid {
            grid-template-columns: 1fr 1fr;
            align-items: start;
        }
        .upload-scan-col {
            border: 1px solid rgba(0,0,0,0.08);
            border-radius: 18px;
            padding: 16px;
            background: rgba(255,255,255,0.7);
        }
        .upload-scan-col .upload-subtitle { margin-top: 0; }

        /* Zmenšení zón (cca -40% výšky) */
        .upload-area.upload-area-compact {
            padding: 1.8rem 1.5rem;
        }
        .upload-area.upload-area-compact .upload-icon-camera {
            width: 40px;
            height: 40px;
            margin-bottom: 10px;
        }

        .library-upload-row {
            width: 100%;
        }
        @media (max-width: 768px) {
            .library-upload-two-cards { flex-direction: column; }
            .library-upload-shell.tips-open .upload-scans-grid { grid-template-columns: 1fr; }
        }

        .upload-icon {
            font-size: 3rem;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        .upload-text {
            font-size: 1.125rem;
            font-weight: 500;
            color: var(--text);
            margin-bottom: 8px;
        }

        .upload-hint {
            font-size: 0.9rem;
            color: var(--text-muted);
        }

        .upload-browse {
            margin-top: 16px;
            font-size: 0.8125rem;
            color: var(--text);
            font-weight: 500;
        }

        .current-shelf-banner {
            background: var(--surface-elevated);
            border: none;
            border-radius: var(--radius-card);
            box-shadow: var(--shadow-card);
            padding: 1.5rem 2rem;
        }

        .current-shelf-banner label {
            display: block;
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--text);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 8px;
        }

        .current-shelf-banner .shelf-input {
            width: 100%;
            max-width: 400px;
            padding: 12px 16px;
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            font-size: 1rem;
            font-weight: 500;
            font-family: inherit;
            color: var(--text);
            background: var(--surface-elevated);
        }

        .current-shelf-banner .shelf-input:focus {
            outline: none;
            box-shadow: 0 0 0 3px var(--accent-soft);
        }

        .current-shelf-banner .shelf-input::placeholder {
            color: var(--text-muted);
        }

        .shelf-input-row {
            margin-bottom: 20px;
        }

        .shelf-input-row label {
            display: block;
            font-size: 0.8rem;
            font-weight: 500;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }

        .shelf-input {
            width: 100%;
            max-width: 320px;
            padding: 10px 14px;
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            font-size: 0.9375rem;
            font-family: inherit;
            color: var(--text);
            background: var(--bg);
        }

        .shelf-input:focus {
            outline: none;
            border-color: var(--text);
        }

        .shelf-input::placeholder {
            color: var(--text-muted);
        }

        #fileInput {
            display: none;
        }

        .image-preview {
            margin-top: 24px;
            max-width: 100%;
            border-radius: var(--radius-sm);
            max-height: 320px;
            box-shadow: var(--shadow);
        }

        /* Kompaktní náhledy v upload panelu knihovny */
        .library-module-upload .image-preview {
            margin-top: 10px;
            max-height: 140px;
            box-shadow: 0 6px 18px rgba(0,0,0,0.08);
        }
        .image-preview--compact {
            width: 108px;
            height: 78px;
            object-fit: cover;
            border-radius: 12px;
            border: 1px solid rgba(0,0,0,0.12);
            display: block;
            margin-top: 6px !important;
            box-shadow: 0 6px 14px rgba(0,0,0,0.10);
        }
        /* Úsporné miniatury v upload panelu (komprese na 200px) */
        .image-preview-thumb {
            max-width: 200px;
            max-height: 150px;
            width: auto;
            height: auto;
            object-fit: contain;
        }
        #imagePreview {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .file-info {
            margin-top: 16px;
            padding: 12px 18px;
            background: var(--surface-elevated);
            border-radius: var(--radius-sm);
            font-size: 0.875rem;
            color: var(--text-secondary);
            border: 1px solid var(--border-soft);
        }

        .analyze-button {
            position: relative;
            background: var(--btn-primary);
            color: white;
            border: none;
            padding: 14px 32px;
            font-size: 1rem;
            font-weight: 600;
            border-radius: var(--radius-sm);
            cursor: pointer;
            transition: background 0.2s, box-shadow 0.2s;
            margin-top: 24px;
            font-family: inherit;
        }

        .analyze-button:hover:not(:disabled) {
            background: var(--accent-hover);
        }

        /* Aktivní stav detailního skenu */
        #analyzeButtonDetail.is-active {
            background: #8DD311;
            color: #000;
        }
        #analyzeButtonDetail.is-active:hover:not(:disabled) { background: #7bc00f; }

        .analyze-button:active:not(:disabled) {
            transform: translateY(0);
        }

        .analyze-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .analyze-button.loading {
            color: transparent;
            pointer-events: none;
        }

        .analyze-button.loading::after {
            content: "";
            position: absolute;
            width: 20px;
            height: 20px;
            top: 50%;
            left: 50%;
            margin: -10px 0 0 -10px;
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 0.65s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .analyze-loading-bar {
            display: none;
            position: relative;
            margin-top: 10px;
            height: 4px;
            background: rgba(0, 0, 0, 0.08);
            border-radius: 2px;
            overflow: hidden;
            font-size: 0.75rem;
            color: var(--text-muted);
            text-align: center;
            padding-top: 20px;
        }
        .analyze-loading-bar.show {
            display: block;
        }
        .analyze-loading-bar::before {
            content: "";
            display: block;
            position: absolute;
            left: 0;
            top: 0;
            height: 4px;
            width: 40%;
            background: var(--btn-primary);
            border-radius: 2px;
            animation: analyze-loading 1.2s ease-in-out infinite;
        }
        @keyframes analyze-loading {
            0% { transform: translateX(-100%); }
            50% { transform: translateX(250%); }
            100% { transform: translateX(-100%); }
        }

        @keyframes pulse-text {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Loading overlay */
        .loading-overlay {
            position: fixed;
            inset: 0;
            background: rgba(255, 255, 255, 0.92);
            backdrop-filter: blur(10px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .loading-overlay.show {
            display: flex;
        }

        .loading-content {
            text-align: center;
        }

        .loading-spinner {
            width: 44px;
            height: 44px;
            border: 3px solid var(--border);
            border-radius: 50%;
            border-top-color: var(--text);
            animation: spin 0.8s linear infinite;
            margin: 0 auto 20px;
        }

        .loading-text {
            color: var(--text-secondary);
            font-size: 0.9375rem;
            font-weight: 500;
            animation: pulse-text 1.2s ease-in-out infinite;
        }

        /* Messages */
        .message {
            margin-top: 20px;
            padding: 14px 18px;
            border-radius: var(--radius-sm);
            font-size: 0.9rem;
            display: none;
        }

        .message.show {
            display: block;
        }

        .message.error {
            background: var(--error-soft);
            border: 1px solid rgba(194, 74, 74, 0.25);
            color: var(--error);
        }

        .message.success {
            background: var(--success-soft);
            border: 1px solid rgba(45, 138, 94, 0.25);
            color: var(--success);
        }
        .message.success.upload-success-flash {
            animation: uploadSuccessPulse 0.6s ease-out;
        }
        @keyframes uploadSuccessPulse {
            0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(45, 138, 94, 0.4); }
            50% { transform: scale(1.02); box-shadow: 0 0 0 8px rgba(45, 138, 94, 0); }
            100% { transform: scale(1); box-shadow: 0 0 0 0 transparent; }
        }

        /* Results section - card grid */
        .results-section {
            margin-bottom: 48px;
            display: none;
        }

        .results-section.show {
            display: block;
        }

        .this-scan-accordion {
            border: 1px solid var(--border-soft);
            border-radius: var(--radius);
            overflow: hidden;
            background: var(--surface);
        }

        .this-scan-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 12px;
            padding: 14px 18px;
            background: var(--surface-elevated);
            cursor: pointer;
            user-select: none;
        }

        .this-scan-header:hover {
            background: var(--accent-soft);
        }

        .this-scan-title {
            margin: 0;
        }

        .this-scan-header-actions {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-clear-workspace {
            padding: 6px 12px;
            font-size: 0.8rem;
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            background: var(--surface);
            cursor: pointer;
        }

        .btn-clear-workspace:hover {
            border-color: var(--text);
            background: var(--accent-soft);
        }
        .btn-approve-workspace {
            padding: 6px 12px;
            font-size: 0.85rem;
            font-weight: 700;
            border-radius: 8px;
            border: 1px solid var(--accent);
            background: var(--accent-soft);
            color: var(--accent);
            cursor: pointer;
        }
        .btn-approve-workspace:hover {
            background: var(--accent);
            color: #fff;
        }
        .this-scan-cards .item-card--duplicate {
            border: 2px solid #dc2626;
            background: rgba(220, 38, 38, 0.06);
        }
        .item-card-duplicate-label {
            display: block;
            font-size: 0.7rem;
            font-weight: 800;
            color: #b91c1c;
            text-transform: uppercase;
            letter-spacing: 0.04em;
            margin-bottom: 4px;
        }
        .this-scan-hint {
            font-size: 0.8125rem;
            color: var(--text-muted);
            margin: 0 0 12px;
            padding: 8px 12px;
            background: rgba(0, 0, 0, 0.03);
            border-radius: 8px;
            border-left: 3px solid var(--accent);
        }
        .this-scan-cards .item-card--duplicate-in-scan {
            border: 2px solid #d97706;
            background: rgba(217, 119, 6, 0.08);
        }
        .item-card-duplicate-in-scan-label {
            display: block;
            font-size: 0.7rem;
            font-weight: 800;
            color: #b45309;
            text-transform: uppercase;
            letter-spacing: 0.04em;
            margin-bottom: 4px;
        }

        .this-scan-toggle {
            padding: 6px;
            border: none;
            background: none;
            cursor: pointer;
            color: var(--text-muted);
        }

        .this-scan-toggle:hover {
            color: var(--text);
        }

        .this-scan-toggle .chevron {
            width: 18px;
            height: 18px;
            transition: transform 0.2s;
        }

        .this-scan-accordion.collapsed .this-scan-toggle .chevron {
            transform: rotate(-90deg);
        }

        .this-scan-content {
            padding: 20px;
            border-top: 1px solid var(--border-soft);
        }

        .this-scan-accordion.collapsed .this-scan-content {
            display: none;
        }

        .this-scan-cards .item-card {
            padding: 14px;
            font-size: 0.8em;
        }

        .this-scan-cards .item-card .item-card-title {
            font-size: 0.95em;
        }

        .this-scan-cards .item-card .item-card-meta {
            font-size: 0.95em;
        }

        .this-scan-cards {
            grid-template-columns: repeat(auto-fill, minmax(144px, 1fr));
            gap: 12px;
        }

        .results-title {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 20px;
        }

        /* Card grid - scan results & library */
        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 16px;
        }

        .library-accordion {
            display: flex;
            flex-direction: column;
            gap: 0;
        }

        .library-body-grid {
            grid-template-columns: repeat(5, minmax(0, 1fr));
            gap: 20px;
        }

        .item-card-clean {
            cursor: pointer;
            background: var(--surface-elevated);
            border: none;
            border-radius: var(--radius-card);
            overflow: hidden;
            box-shadow: var(--shadow-card);
            transition: box-shadow 0.2s, transform 0.2s;
        }

        .item-card-clean:hover {
            box-shadow: var(--shadow-hover);
            transform: scale(1.02);
        }

        .item-card-clean .item-card-front {
            padding: 0;
            position: relative;
        }

        .item-card-clean .item-card-cover-wrap {
            position: relative;
            width: 100%;
        }

        .item-card-icons {
            position: absolute;
            top: 8px;
            right: 8px;
            display: flex;
            gap: 6px;
            z-index: 2;
        }

        .item-card-icons .card-icon-btn {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            border: none;
            background: rgba(255,255,255,0.95);
            color: var(--text-muted);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.12);
            transition: all 0.2s;
        }

        .item-card-icons .card-icon-btn:hover {
            background: white;
            color: var(--text);
            transform: scale(1.08);
        }

        .item-card-icons .card-icon-btn.heart-btn.active,
        .item-card-icons .heart-btn.active {
            color: #e11d48;
            background: rgba(225,29,72,0.12);
        }

        .item-card-icons .card-icon-btn svg {
            width: 16px;
            height: 16px;
        }

        .item-card-clean .item-card-cover {
            width: 100%;
            aspect-ratio: 2/3;
            border-radius: 0;
            margin-bottom: 12px;
            overflow: hidden;
        }

        .item-card-clean .item-card-cover img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .item-card-clean .item-card-cover .item-card-placeholder,
        .item-card-clean .item-card-cover .wishlist-card-placeholder {
            width: 100%;
            height: 100%;
            min-height: 120px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            padding: 12px;
            text-align: center;
            background: linear-gradient(145deg, #e5e7eb 0%, #d1d5db 100%);
            color: #6b7280;
            cursor: pointer;
            transition: background 0.2s, color 0.2s;
        }

        .item-card-clean .item-card-cover .item-card-placeholder:hover,
        .item-card-clean .item-card-cover .wishlist-card-placeholder.cover-add-hint:hover {
            background: linear-gradient(145deg, #d1d5db 0%, #9ca3af 100%);
            color: #374151;
        }

        .item-card-placeholder .placeholder-book-icon {
            font-size: 2rem;
            margin-bottom: 8px;
            opacity: 0.8;
        }

        .item-card-clean .item-card-title {
            font-size: 0.9375rem;
            font-weight: 700;
            padding: 0 12px;
            margin-bottom: 4px;
            line-height: 1.3;
        }

        .item-card-clean .item-card-meta {
            font-size: 0.8125rem;
            color: var(--text-muted);
            padding: 0 12px 12px;
            margin: 0;
        }

        .item-card-clean .item-card-detail {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .item-card-clean.expanded .item-card-detail {
            max-height: 600px;
            overflow-y: auto;
        }

        .item-card-clean .item-card-detail-inner {
            padding: 16px;
            border-top: 1px solid var(--border-soft);
            background: var(--surface);
            font-size: 0.8125rem;
        }

        /* Interaktivní nápověda karty – pulzující šipka v pravém dolním rohu */
        @keyframes chevron-pulse {
            0%, 100% { opacity: 0.4; }
            50% { opacity: 0.65; }
        }
        .item-card-clean .item-card-chevron {
            position: absolute;
            bottom: 10px;
            right: 10px;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-muted);
            opacity: 0.45;
            animation: chevron-pulse 2.5s ease-in-out infinite;
            transition: color 0.25s ease, opacity 0.25s ease, transform 0.25s ease;
            pointer-events: none;
        }
        .item-card-clean:hover .item-card-chevron {
            color: var(--text);
            opacity: 1;
            transform: translate(4px, 0);
            animation: chevron-hover-pulse 1s ease-in-out infinite;
        }
        .item-card-clean .item-card-chevron svg {
            width: 18px;
            height: 18px;
        }
        .item-card-clean .card-chevron-tooltip {
            position: absolute;
            bottom: 100%;
            right: 0;
            margin-bottom: 8px;
            padding: 6px 10px;
            background: var(--text);
            color: var(--surface-elevated);
            font-size: 0.75rem;
            border-radius: var(--radius);
            white-space: nowrap;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.2s ease, visibility 0s linear 0.2s;
            pointer-events: none;
        }
        .item-card-clean .item-card-chevron.show-tooltip .card-chevron-tooltip {
            opacity: 1;
            visibility: visible;
            transition-delay: 0s;
        }

        .pagination-controls {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin-top: 24px;
            flex-wrap: wrap;
        }

        .pagination-btn {
            min-width: 36px;
            height: 36px;
            padding: 0 10px;
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            background: var(--surface);
            color: var(--text-secondary);
            font-size: 0.875rem;
            cursor: pointer;
            font-family: inherit;
            transition: all 0.2s;
        }

        .pagination-btn:hover {
            border-color: var(--text);
            color: var(--text);
        }

        .pagination-btn.active {
            background: var(--accent-soft);
            border-color: var(--text);
            color: var(--text);
            font-weight: 600;
        }

        .pagination-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .library-body-grid .item-card {
            padding: 14px;
            min-width: 0;
        }

        .library-body-grid .item-card-title { font-size: 0.875rem; }
        .library-body-grid .item-card-meta { font-size: 0.75rem; }
        .library-body-grid .item-card-extra { font-size: 0.7rem; }

        .library-accordion .shelf-group-books .cards-grid {
            grid-template-columns: repeat(5, minmax(0, 1fr));
            gap: 12px;
        }

        .btn-show-more {
            margin-top: 20px;
            padding: 12px 24px;
            font-size: 0.9rem;
            font-weight: 500;
            border-radius: var(--radius-sm);
            border: 1px solid var(--btn-primary);
            background: var(--accent-soft);
            color: var(--text);
            cursor: pointer;
            font-family: inherit;
            transition: all 0.2s;
            width: 100%;
            max-width: 280px;
            margin-left: auto;
            margin-right: auto;
            display: block;
        }

        .btn-show-more:hover {
            background: var(--btn-primary);
            color: white;
        }

        .item-card {
            background: var(--surface-elevated);
            border: none;
            border-radius: var(--radius-card);
            padding: 20px;
            box-shadow: var(--shadow-card);
            transition: box-shadow 0.2s, transform 0.2s;
            position: relative;
        }

        .item-card .item-card-cover-wrap {
            position: relative;
        }

        .item-card:hover {
            box-shadow: var(--shadow-hover);
            border-color: var(--border-soft);
            transform: scale(1.02);
        }

        .item-card.highlight-match,
        .item-card-clean.highlight-match {
            border-color: var(--text);
        }

        .item-card-title {
            font-size: 0.9375rem;
            font-weight: 600;
            color: var(--text);
            margin-bottom: 6px;
            line-height: 1.4;
            word-break: break-word;
        }

        .item-card-meta {
            font-size: 0.8125rem;
            color: var(--text-secondary);
            margin-bottom: 12px;
        }

        .item-card-extra {
            font-size: 0.75rem;
            color: var(--text-muted);
            margin-top: 4px;
        }

        .item-card-actions {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 8px;
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px solid var(--border-soft);
        }

        .editable-cell {
            cursor: text;
            padding: 4px 0;
            border-radius: 4px;
            transition: background 0.15s;
            word-break: break-word;
        }

        .editable-cell:hover {
            background: var(--accent-soft);
        }

        .editable-cell:focus {
            outline: 2px solid var(--btn-primary);
            outline-offset: 2px;
            background: var(--surface-elevated);
        }

        .delete-btn, .item-card-delete {
            background: none;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            padding: 6px;
            border-radius: var(--radius-sm);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            transition: all 0.15s;
            width: 32px;
            height: 32px;
        }

        .delete-btn:hover, .item-card-delete:hover {
            background: var(--error-soft);
            color: var(--error);
        }

        .add-book-btn {
            margin-top: 20px;
            background: var(--surface);
            border: 1px dashed var(--border);
            color: var(--text-secondary);
            padding: 12px 20px;
            border-radius: var(--radius-sm);
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            font-family: inherit;
            width: 100%;
        }

        .add-book-btn:hover {
            background: var(--accent-soft);
            border-color: var(--text);
            color: var(--text);
        }

        .duplicate-badge {
            display: inline-block;
            margin-top: 8px;
            padding: 4px 8px;
            background: var(--error-soft);
            color: var(--error);
            font-size: 0.75rem;
            font-weight: 600;
            border-radius: 4px;
        }

        /* Scan History */
        .scan-history {
            margin-top: 48px;
        }

        .section-label {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 20px;
        }

        .library-section-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 16px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .btn-add-scan {
            padding: 8px 16px;
            font-size: 0.875rem;
            font-weight: 500;
            border-radius: var(--radius-sm);
            border: 1px solid var(--btn-primary);
            background: var(--accent-soft);
            color: var(--text);
            cursor: pointer;
            font-family: inherit;
            transition: all 0.15s;
        }

        .btn-add-scan:hover {
            background: var(--btn-primary);
            color: white;
        }

        .library-stats {
            font-size: 0.875rem;
            color: var(--text-muted);
        }

        .scan-history-header {
            margin-bottom: 20px;
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            gap: 16px;
        }
        .scan-history-subtitle {
            flex: 1 1 100%;
            margin: -10px 0 0 0;
            font-size: 0.9rem;
            color: var(--text-muted);
            font-weight: 600;
        }

        .btn-delete-library {
            background: var(--error);
            color: white;
            border: none;
            padding: 10px 18px;
            border-radius: var(--radius-sm);
            font-size: 0.875rem;
            font-weight: 600;
            cursor: pointer;
            font-family: inherit;
            transition: background 0.2s;
        }

        .btn-delete-library:hover {
            background: #a63d3d;
        }

        .shelf-group-actions {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-delete-shelf {
            background: transparent;
            color: var(--error);
            border: 1px solid var(--error);
            padding: 6px 12px;
            border-radius: var(--radius-sm);
            font-size: 0.75rem;
            font-weight: 500;
            cursor: pointer;
            font-family: inherit;
            transition: all 0.15s;
        }

        .btn-delete-shelf:hover {
            background: var(--error-soft);
        }

        /* Sekce Rozečteno – rozvržení podle nákresu, extrémně jemná limetka */
        .reading-view-container {
            margin-top: 24px;
        }
        .reading-view-wrap.reading-panel {
            padding: 2rem;
            background: rgba(209, 255, 82, 0.06);
            border-radius: 1.5rem;
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.06), 0 1px 3px rgba(0, 0, 0, 0.04);
        }
        .reading-top-row {
            display: flex;
            flex-wrap: wrap;
            gap: 2rem;
            align-items: flex-start;
            margin-bottom: 1.5rem;
        }
        .reading-top-left {
            flex: 1;
            min-width: 260px;
        }
        .reading-top-left .reading-bubbles {
            margin-top: 12px;
        }
        .reading-top-right {
            flex: 0 0 auto;
            min-width: 260px;
            max-width: 320px;
        }
        .reading-ai-input-hint {
            display: block;
            margin-top: 6px;
            font-size: 0.75rem;
            color: var(--text-muted);
        }
        .reading-today-title {
            margin: 0 0 6px 0;
            font-size: 1.375rem;
            font-weight: 700;
            color: #000;
        }
        .reading-bubbles {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }
        /* Ikonky nálad: menší, tenké černé ohraničení 1px solid #000, jemný limetkový podklad */
        .reading-bubble {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            border: 1px solid #000;
            background: rgba(209, 255, 82, 0.1);
            font-size: 0.95rem;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            transition: background 0.2s, transform 0.2s;
        }
        .reading-bubble:hover {
            background: rgba(209, 255, 82, 0.15);
            border-color: #000;
            transform: scale(1.04);
        }
        .reading-mood-bar-wrap {
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 0;
        }
        .reading-mood-label {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--text-muted);
        }
        .reading-mood-bar {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        .reading-mood-btn {
            padding: 8px 14px;
            border-radius: 10px;
            border: 1px solid rgba(0,0,0,0.12);
            background: rgba(255, 255, 255, 0.85);
            color: var(--text);
            font-size: 0.85rem;
            font-family: inherit;
            cursor: pointer;
            transition: background 0.2s, border-color 0.2s;
        }
        .reading-mood-btn:hover {
            background: rgba(141, 211, 17, 0.14);
            border-color: rgba(141, 211, 17, 0.55);
            color: #14532d;
        }
        .reading-search-row {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            align-items: center;
        }
        .reading-search-input {
            flex: 1;
            min-width: 200px;
            padding: 12px 16px;
            border: 1px solid #333;
            border-radius: 10px;
            font-size: 0.9375rem;
            font-family: inherit;
            color: #000;
            background: var(--surface);
            transition: border-color 0.2s, box-shadow 0.2s;
        }
        .reading-search-input::placeholder {
            color: var(--text-muted);
        }
        .reading-search-input:focus {
            outline: none;
            border-color: #000;
            box-shadow: 0 0 0 2px rgba(209, 255, 82, 0.2);
        }
        .reading-search-btn {
            padding: 12px 20px;
            border-radius: 10px;
            border: 1px solid #000;
            background: rgba(209, 255, 82, 0.18);
            color: #000;
            font-size: 0.9375rem;
            font-weight: 600;
            font-family: inherit;
            cursor: pointer;
            transition: background 0.2s;
        }
        .reading-search-btn:hover {
            background: rgba(209, 255, 82, 0.25);
            border-color: #000;
            color: #000;
        }
        .reading-fallback {
            margin: 0;
            padding: 16px;
            color: var(--text-muted);
            font-size: 0.9rem;
        }
        .reading-today-desc {
            margin: 0 0 14px 0;
            font-size: 0.9375rem;
            color: #000;
            line-height: 1.45;
        }
        .reading-middle-intro {
            margin: 0 0 12px 0;
            font-size: 0.9375rem;
            color: #000;
        }
        #readingViewSection .reading-bubble,
        #readingViewSection .reading-mood-btn,
        #readingViewSection .reading-genre-btn {
            border: 1px solid rgba(0,0,0,0.12);
            color: var(--text);
        }
        #readingViewSection .reading-bubble {
            background: rgba(255,255,255,0.85);
        }
        #readingViewSection .reading-bubble:hover {
            background: rgba(141, 211, 17, 0.14);
            border-color: rgba(141, 211, 17, 0.55);
            color: #14532d;
        }
        #readingViewSection .reading-mood-btn:hover,
        #readingViewSection .reading-genre-btn:hover {
            background: rgba(141, 211, 17, 0.14);
            border-color: rgba(141, 211, 17, 0.55);
            color: #14532d;
        }
        #readingViewSection .reading-search-input {
            border: 1px solid #333;
            color: #000;
        }
        #readingViewSection .reading-search-input:focus {
            border-color: #000;
            box-shadow: 0 0 0 2px rgba(209, 255, 82, 0.18);
        }
        #readingViewSection .reading-search-btn {
            background: rgba(209, 255, 82, 0.18);
            border: 1px solid #000;
            color: #000;
        }
        #readingViewSection .reading-search-btn:hover {
            background: rgba(209, 255, 82, 0.25);
            border-color: #000;
            color: #000;
        }
        .reading-ai-label {
            display: block;
            font-size: 0.875rem;
            font-weight: 600;
            color: #000;
            margin-bottom: 6px;
        }
        .reading-ai-input {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid rgba(0, 0, 0, 0.25);
            border-radius: 10px;
            font-size: 0.9375rem;
            font-family: inherit;
            color: #000;
            background: #fff;
            transition: border-color 0.2s, box-shadow 0.2s;
        }
        .reading-ai-input::placeholder {
            color: var(--text-muted);
        }
        .reading-ai-input:focus {
            outline: none;
            border-color: #000;
            box-shadow: 0 0 0 2px rgba(209, 255, 82, 0.15);
        }
        /* Velké bílé okno pro odpověď AI – jemný stín, černé ohraničení */
        .reading-ai-response {
            margin: 1.1rem 0;
            padding: 1.1rem 1.25rem;
            min-height: 110px;
            background: #fff;
            border: 1px solid rgba(0,0,0,0.10);
            border-radius: 18px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
        }
        .reading-ai-response.has-text .reading-ai-response-text {
            color: #000;
        }
        .reading-ai-response-text {
            margin: 0;
            font-size: 0.9375rem;
            color: var(--text-muted);
            line-height: 1.55;
        }
        /* Spodní lišta: text + Zeptej se AI */
        .reading-bottom-bar {
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            margin-top: 1rem;
        }
        .reading-find-book-btn {
            padding: 14px 24px;
            border-radius: 12px;
            border: 1px solid rgba(45, 90, 39, 0.5);
            background: rgba(209, 255, 82, 0.35);
            color: #1a4d0e;
            font-size: 0.9375rem;
            font-weight: 600;
            font-family: inherit;
            cursor: pointer;
            transition: background 0.2s, box-shadow 0.2s;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.06);
        }
        .reading-find-book-btn:hover {
            background: rgba(209, 255, 82, 0.5);
            border-color: #1a4d0e;
            color: #1a4d0e;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        }
        /* Karta doporučené knihy pod AI oknem – stejný styl jako Tvoje sbírka */
        .reading-recommended-card-wrap {
            margin-top: 0.9rem;
            max-width: 300px;
        }
        .reading-recommended-card-wrap:empty {
            display: none;
        }
        .reading-recommended-card-wrap .book-card {
            border: none;
            border-radius: 20px;
            overflow: hidden;
            background: #fff;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
        }
        .reading-recommended-card .book-card-dynamic-row.reading-recommended-location {
            margin-top: 4px;
            font-size: 0.875rem;
            color: var(--text-muted);
        }
        .reading-add-to-reading-btn {
            margin-top: 12px;
            padding: 10px 18px;
            border-radius: 10px;
            border: 1px solid rgba(141, 211, 17, 0.60);
            background: rgba(141, 211, 17, 0.14);
            color: #14532d;
            font-size: 0.9rem;
            font-weight: 900;
            font-family: inherit;
            cursor: pointer;
            transition: background 0.2s, box-shadow 0.2s;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.06);
        }
        .reading-add-to-reading-btn:hover {
            background: rgba(141, 211, 17, 0.20);
            border-color: rgba(141, 211, 17, 0.75);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        }
        .reading-nav-highlight {
            margin-top: 10px;
            padding: 12px 14px;
            background: rgba(209, 255, 82, 0.12);
            border: 1px solid #000;
            border-radius: 10px;
            font-size: 0.9rem;
            color: #000;
        }
        .reading-nav-label {
            font-weight: 600;
        }
        .reading-nav-path {
            font-weight: 500;
        }
        .reading-genre-wrap {
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 16px;
            margin-top: 1.25rem;
            margin-bottom: 0;
        }
        .reading-genre-label {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--text-muted);
        }
        .reading-genre-bar {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        .reading-genre-btn {
            padding: 8px 14px;
            border-radius: 10px;
            border: 1px solid rgba(0,0,0,0.12);
            background: rgba(255, 255, 255, 0.85);
            color: var(--text);
            font-size: 0.85rem;
            font-family: inherit;
            cursor: pointer;
            transition: background 0.2s, border-color 0.2s;
        }
        .reading-genre-btn:hover {
            background: rgba(141, 211, 17, 0.14);
            border-color: rgba(141, 211, 17, 0.55);
            color: #14532d;
        }
        /* Karta knihy v sekci Rozečteno – identická se sbírkou + pouze stránka a foťák */
        .book-card-reading-minimal {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid rgba(0, 0, 0, 0.06);
        }
        .book-card-reading-minimal .book-card-page-input {
            width: 56px;
            padding: 5px 8px;
            border: 1px solid rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            font-size: 0.8125rem;
            color: #000;
        }
        .book-card-reading-minimal .book-card-page-input:focus {
            outline: none;
            border-color: rgba(0, 0, 0, 0.4);
            box-shadow: 0 0 0 1px rgba(209, 255, 82, 0.15);
        }
        .book-card-reading-minimal .book-card-cam-btn {
            width: 32px;
            height: 32px;
            padding: 0;
            border: 1px solid rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            background: rgba(209, 255, 82, 0.1);
            font-size: 1rem;
            cursor: pointer;
            transition: background 0.2s;
        }
        .book-card-reading-minimal .book-card-cam-btn:hover {
            background: rgba(209, 255, 82, 0.18);
            border-color: rgba(0, 0, 0, 0.3);
        }
        /* Obálka foťáku + vyskakovací tooltip */
        .book-card-cam-wrap {
            position: relative;
            display: inline-flex;
        }
        .book-card-tooltip-bubble {
            position: absolute;
            left: 50%;
            transform: translateX(-50%) translateY(-100%);
            bottom: calc(100% + 8px);
            width: 260px;
            max-width: 90vw;
            padding: 10px 12px;
            font-size: 0.8125rem;
            line-height: 1.4;
            color: #000;
            background: #fff;
            border: 1px solid #000;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.2s, visibility 0.2s;
            z-index: 20;
            pointer-events: none;
        }
        .book-card-cam-wrap:hover .book-card-tooltip-bubble {
            opacity: 1;
            visibility: visible;
        }
        /* Výtah z děje – tlačítko a výsledek (Rozečteno), Apple styl, 1px černé ohraničení */
        .reading-summary-wrap {
            margin-top: 12px;
            padding-top: 10px;
            border-top: 1px solid rgba(0, 0, 0, 0.06);
        }
        .reading-summary-btn {
            display: inline-block;
            padding: 8px 14px;
            border-radius: 10px;
            border: 1px solid #000;
            background: rgba(209, 255, 82, 0.1);
            color: #000;
            font-size: 0.85rem;
            font-weight: 500;
            font-family: inherit;
            cursor: pointer;
            transition: background 0.2s, box-shadow 0.2s;
        }
        .reading-summary-btn:hover {
            background: rgba(209, 255, 82, 0.18);
            border-color: #000;
        }
        .reading-summary-btn:disabled {
            opacity: 0.7;
            cursor: not-allowed;
        }
        .reading-summary-result {
            display: none;
            margin-top: 10px;
            padding: 12px 14px;
            font-size: 0.875rem;
            line-height: 1.5;
            color: #000;
            background: #fff;
            border: 1px solid #000;
            border-radius: 10px;
            box-shadow: 0 1px 4px rgba(0, 0, 0, 0.06);
        }
        .reading-summary-result.has-text {
            display: block;
        }
        .reading-summary-result.is-message {
            background: rgba(209, 255, 82, 0.08);
        }
        #scanHistorySection.view-currently-reading .book-card-btn-edit,
        #scanHistorySection.view-currently-reading .book-card-btn-pracovna {
            background: rgba(209, 255, 82, 0.18);
            border: 1px solid #000;
            color: #000;
        }
        #scanHistorySection.view-currently-reading .book-card-btn-edit:hover,
        #scanHistorySection.view-currently-reading .book-card-btn-pracovna:hover {
            background: rgba(209, 255, 82, 0.25);
            border-color: #000;
            color: #000;
        }

        .scan-history-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text);
        }
        .scan-history-header {
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 12px;
        }
        .scan-history-sort-wrap {
            display: flex;
            align-items: center;
        }
        .library-view-toggle {
            display: flex;
            align-items: center;
            gap: 4px;
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 4px;
        }
        .library-view-btn {
            padding: 8px 14px;
            font-size: 0.8125rem;
            font-weight: 500;
            border: none;
            border-radius: 8px;
            background: transparent;
            color: var(--text-muted);
            cursor: pointer;
            transition: background 0.2s, color 0.2s;
        }
        .library-view-btn:hover { color: var(--text); background: rgba(0,0,0,0.04); }
        .library-view-btn.active { background: var(--accent); color: #1d1d1f; }
        .scan-history-search-wrap {
            position: relative;
            display: flex;
            align-items: center;
            gap: 10px;
            margin-left: auto;
        }
        .search-toggle-btn {
            width: 40px;
            height: 40px;
            padding: 0;
            border: none;
            border-radius: 10px;
            background: transparent;
            font-size: 1.25rem;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            transition: background 0.2s, transform 0.2s;
        }
        .search-toggle-btn:hover {
            background: var(--accent-soft);
            transform: scale(1.05);
        }
        .search-field-slide {
            width: 0;
            max-width: 280px;
            overflow: hidden;
            opacity: 0;
            transition: width 0.35s ease, opacity 0.25s ease;
        }
        .scan-history-header.search-open .search-field-slide {
            width: 260px;
            opacity: 1;
        }
        .library-search-input {
            width: 100%;
            min-width: 220px;
            padding: 10px 14px;
            font-size: 0.9375rem;
            font-family: inherit;
            color: var(--text);
            background: var(--surface);
            border: 1px solid rgba(141, 211, 17, 0.4);
            border-radius: 10px;
            outline: none;
            transition: border-color 0.2s, box-shadow 0.2s;
        }
        .library-search-input::placeholder {
            color: var(--text-muted);
        }
        .library-search-input:focus {
            border-color: var(--accent-lime);
            box-shadow: 0 0 0 3px rgba(141, 211, 17, 0.15);
        }

        .books-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
            gap: 16px;
        }

        /* Kontejner pro seznam polic (ne mřížka karet) */
        .books-grid.shelf-list-container {
            display: block;
        }
        .shelf-group-books .books-grid {
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 20px;
        }

        .book-card-wrap {
            display: flex;
            align-items: stretch;
        }

        /* Bílý kontejner karty – jemný stín, bez tlustého rámečku */
        .book-card {
            position: relative;
            flex: 1;
            min-width: 0;
            background: #fff;
            border-radius: 20px;
            border: none;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
            padding: 0;
            transition: transform 0.4s ease, opacity 0.25s ease, filter 0.25s ease;
            overflow: hidden;
            cursor: pointer;
            display: flex;
            flex-direction: column;
        }
        /* Režim soustředění: neodpovídající knihy jsou rozmazané a ztlumené */
        .book-card.ghosted {
            opacity: 0.2;
            filter: blur(3px);
            pointer-events: none;
        }
        .book-card.focus-match {
            z-index: 1;
        }
        .book-card.search-no-match {
            opacity: 0.25;
            filter: blur(4px);
            pointer-events: none;
        }

        .book-card:hover {
            transform: scale(1.02);
        }

        .book-card--overdue {
            box-shadow: 0 2px 12px rgba(255, 59, 48, 0.15);
        }

        /* Obálka – pouze obrázek nebo placeholder */
        .book-card-cover-wrap {
            position: relative;
            background: #fff;
            padding: 12px 12px 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }
        /* Karty bez obálky: čistě bílý podklad pro zelenou ikonku */
        .book-card.no-cover .book-card-cover-wrap { background: #fff; }

        /* Rámeček obálky – zmenšená obálka, centrovaná */
        .book-card-cover-frame {
            width: 78%;
            aspect-ratio: 2/3;
            background: #fff;
            border-radius: 14px;
            border: 1px solid rgba(0, 0, 0, 0.14);
            box-shadow:
                inset 0 1px 0 rgba(255, 255, 255, 0.6),
                0 8px 18px rgba(0, 0, 0, 0.08);
            overflow: hidden;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .book-card-cover-frame.no-cover { background: #fff; }
        .book-card-cover-placeholder {
            font-size: 0.75rem;
            color: #8e8e93;
            text-align: center;
            padding: 12px;
        }
        .book-card-cover-wrap img,
        .book-card-cover-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }
        .book-card-cover-img--placeholder {
            /* placeholder je "celá obálka" jako na nákresu */
            filter: saturate(1.05) contrast(1.03);
            transform: scale(1.02);
        }
        .book-card-cover-placeholder-label {
            position: absolute;
            left: 0;
            right: 0;
            top: 58%;
            text-align: center;
            font-weight: 900;
            font-size: 0.78rem;
            color: rgba(20, 83, 45, 0.55);
            text-shadow: 0 1px 0 rgba(255,255,255,0.55);
            pointer-events: none;
            transform: translateY(-50%);
        }
        .book-card-cover-placeholder {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 100%;
            height: 100%;
            text-align: center;
            padding: 20px;
        }
        .book-card-placeholder-icon {
            width: 62%;
            max-width: 120px;
            height: auto;
            display: block;
        }
        .book-card-placeholder-text {
            display: block;
            margin-top: 10px;
            font-size: 0.75rem;
            color: #8e8e93;
        }
        .book-card-date-badge {
            position: absolute;
            bottom: 8px;
            left: 8px;
            z-index: 3;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 10px;
            background: rgba(255, 87, 34, 0.95);
            color: #fff;
            border-radius: 8px;
            font-size: 0.75rem;
            font-weight: 600;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
        }
        .book-card-date-badge.is-overdue {
            background: rgba(255, 59, 48, 0.95);
            animation: book-badge-blink 1s ease-in-out infinite;
        }
        .book-card-date-badge-icon {
            font-size: 0.9em;
            line-height: 1;
        }
        .book-card-date-badge-text {
            white-space: nowrap;
        }
        .book-card-cover-actions {
            position: absolute;
            top: 10px;
            right: 10px;
            align-self: auto;
            z-index: 2;
            display: flex;
            gap: 6px;
        }
        .book-card-cover-btn {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            border: 1px solid rgba(0, 0, 0, 0.2);
            background: rgba(255, 255, 255, 0.9);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            color: #000;
            padding: 0;
            transition: background 0.2s;
        }
        .book-card-cover-btn:hover {
            background: rgba(255, 255, 255, 1);
        }
        .book-card-cover-favorite {
            font-size: 1.1rem;
        }
        .book-card-cover-favorite.is-active {
            color: #c62828;
        }
        .book-card-cover-sale { font-size: 1rem; }
        .book-card-cover-sale.is-active { background: rgba(255, 152, 0, 0.25); color: #e65100; }
        .book-card-dynamic-row--favorite {
            color: #c62828;
        }
        .book-card-dynamic-row--friends-reco {
            margin-top: 6px;
            padding: 8px 10px;
            border-radius: 12px;
            background: rgba(247, 254, 231, 0.85);
            border: 1px solid rgba(141, 211, 17, 0.22);
            box-shadow: 0 6px 16px rgba(0,0,0,0.06);
            color: var(--text-secondary);
        }

        /* Spodní informační panel – border-radius 20px kopíruje kartu, žádný stín/okraj navíc */
        .book-card-info-panel {
            display: flex;
            flex-direction: column;
            padding: 12px 14px 14px;
            background: #fff;
            border-top: 1px solid rgba(0, 0, 0, 0.06);
            overflow: visible;
        }

        /* Štítky – vizuálně vyrůstají z horní hrany bílého panelu (flush s horní hranou) */
        .book-card-badges {
            position: static;
            margin: 0 0 10px;
            z-index: 1;
            display: flex;
            flex-wrap: wrap;
            flex-direction: row;
            gap: 4px;
        }
        .book-card-badge {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 4px 8px;
            font-size: 11px;
            font-weight: 600;
            line-height: 1.2;
            border-radius: 6px;
            font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "Segoe UI", Roboto, sans-serif;
            background: rgba(255, 255, 255, 0.9);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }
        .book-card-badge-icon {
            font-size: 0.8em;
            line-height: 1;
        }
        .book-card-badge--borrowed {
            color: #ff3b30;
            border: 0.5px solid rgba(255, 59, 48, 0.5);
        }
        .book-card-badge--borrowed-by-me {
            color: #ff3b30;
            border: 0.5px solid rgba(255, 59, 48, 0.5);
        }
        .book-card-badge--returned {
            color: #6e6e73;
            border: 0.5px solid rgba(142, 142, 147, 0.3);
            background: rgba(142, 142, 147, 0.1);
        }
        .book-card-badge--forsale {
            color: #ff9f0a;
            border: 0.5px solid rgba(255, 159, 10, 0.5);
        }
        .book-card-badge--reading {
            color: #007aff;
            border: 0.5px solid rgba(0, 122, 255, 0.5);
        }
        .book-card-badge--read {
            color: #14532d;
            border: 0.5px solid rgba(141, 211, 17, 0.55);
            background: rgba(141, 211, 17, 0.12);
        }
        .book-card-badge--wishlist {
            color: #af52de;
            border: 0.5px solid rgba(175, 82, 222, 0.5);
        }
        .book-card-badge--duplicate {
            color: #c93400;
            border: 0.5px solid rgba(255, 149, 0, 0.5);
            background: rgba(255, 149, 0, 0.1);
        }
        .book-card--possible-duplicate {
            border-color: rgba(255, 149, 0, 0.4);
        }
        .book-card-badge--due-soon {
            animation: book-badge-blink 1s ease-in-out infinite;
        }
        @keyframes book-badge-blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.85; }
        }

        /* Záhlaví panelu: název + srdce Wishlist */
        .book-card-panel-header {
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            gap: 8px;
            margin-bottom: 2px;
        }
        .book-card-title {
            flex: 1;
            min-width: 0;
            font-size: 0.9375rem;
            font-weight: 600;
            color: #1a1a1a;
            line-height: 1.35;
        }
        .book-card-wishlist-btn {
            flex-shrink: 0;
            width: 28px;
            height: 28px;
            padding: 0;
            border: none;
            border-radius: 8px;
            background: transparent;
            color: #8e8e93;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            transition: color 0.2s, transform 0.2s;
        }
        .book-card-wishlist-btn:hover {
            color: #ff3b30;
        }
        .book-card-wishlist-btn.active {
            color: #ff3b30;
        }
        .book-card-wishlist-btn svg {
            width: 18px;
            height: 18px;
        }

        .book-card-author {
            font-size: 0.8125rem;
            color: #6e6e73;
            margin-bottom: 6px;
        }

        /* Název + ikona soukromí */
        .book-card-title-with-privacy {
            display: flex;
            align-items: center;
            gap: 6px;
            flex: 1;
            min-width: 0;
        }
        .book-card-privacy-icon {
            flex-shrink: 0;
            font-size: 0.75rem;
            opacity: 0.7;
        }

        /* Dynamické řádky pod autorem */
        .book-card-dynamic-rows {
            margin-bottom: 10px;
            padding-top: 6px;
            border-top: 1px solid rgba(0, 0, 0, 0.06);
        }
        .book-card-dynamic-row {
            font-size: 0.75rem;
            color: #6e6e73;
            margin-bottom: 2px;
        }
        .book-card-dynamic-row:last-child {
            margin-bottom: 0;
        }
        .book-card-dynamic-row--urgent {
            color: #ff3b30;
            font-weight: 600;
        }

        .book-card-borrowed-primary {
            margin-top: 8px;
            padding: 10px 12px;
            background: rgba(209, 255, 82, 0.1);
            border: 1px solid rgba(0, 0, 0, 0.12);
            border-radius: 10px;
            font-size: 0.875rem;
            color: #000;
        }
        .book-card-borrowed-primary-line {
            margin-bottom: 4px;
        }
        .book-card-borrowed-primary-line:last-child {
            margin-bottom: 0;
        }
        .book-card-borrowed-primary.is-overdue,
        #scanHistorySection.view-borrowed .book-card--overdue .book-card-borrowed-primary {
            background: rgba(255, 59, 48, 0.08);
            border-color: rgba(255, 59, 48, 0.35);
            color: #c62828;
        }
        .book-card-borrowed-primary-line.is-overdue-text {
            color: #ff3b30;
            font-weight: 600;
        }
        .book-card-borrowed-by-me-primary {
            background: rgba(248, 248, 248, 0.95);
            border: 1px solid rgba(0, 0, 0, 0.08);
            border-radius: 12px;
            padding: 12px 14px;
            margin-top: 8px;
        }
        .book-card-borrowed-by-me-primary.is-overdue {
            background: rgba(255, 245, 245, 0.95);
            border-color: rgba(255, 59, 48, 0.2);
        }
        .book-card--borrowed-by-me .book-card-info-panel {
            background: #fff;
            border-radius: 0 0 20px 20px;
        }
        /* Karty v Půjčená literatura / Půjčil/a jsem – stejná velikost a styl jako Moje knihovna */
        #scanHistorySection.view-borrowed .book-card:not(.book-card--overdue),
        #scanHistorySection.view-borrowed-by-me .book-card {
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.06);
            border: 1px solid var(--border);
        }
        /* Oranžový pruh pro vrácení */
        .book-card-return-bar {
            width: 100%;
            margin-top: 12px;
            padding: 12px 16px;
            background: #ff9500;
            color: #fff;
            border: none;
            border-radius: 0 0 20px 20px;
            font-size: 0.9375rem;
            font-weight: 600;
            text-align: center;
            cursor: pointer;
            transition: background 0.2s, transform 0.1s;
            font-family: inherit;
        }
        .book-card-return-bar:hover {
            background: #ff8800;
            transform: translateY(-1px);
        }
        .book-card-return-bar:active {
            transform: translateY(0);
        }
        .book-card-return-bar.is-overdue {
            background: #ff3b30;
        }
        .book-card-return-bar.is-overdue:hover {
            background: #ff2d20;
        }
        /* Štítek pro vrácené knihy v archivu */
        .book-card-returned-label {
            margin-top: 12px;
            padding: 8px 12px;
            background: rgba(142, 142, 147, 0.1);
            border: 1px solid rgba(142, 142, 147, 0.2);
            border-radius: 8px;
            font-size: 0.8125rem;
            color: #6e6e73;
            text-align: center;
            font-weight: 500;
        }
        /* Opozdilec: jemný červený odstín (limo), 1px linka */
        #scanHistorySection.view-borrowed .book-card--overdue {
            box-shadow: 0 2px 12px rgba(255, 59, 48, 0.2);
            border: 1px solid rgba(200, 60, 60, 0.5);
            background: #ffcccc;
        }
        #scanHistorySection.view-borrowed .book-card--overdue .book-card-info-panel {
            background: #ffdddd;
            border-radius: 0 0 20px 20px;
        }

        /* Tvoje sbírka – sbalitelná karta: maximální obal, jemná šipka těsně u předělu */
        .book-card--collapsible {
            min-height: 320px;
        }
        .book-card--collapsible .book-card-info-panel {
            padding-top: 4px;
        }
        /* Tvoje sbírka: karta končí pod autorem, bez tlačítek a přesunu */
        .book-card--collection-minimal .book-card-info-panel,
        .book-card--reading-minimal .book-card-info-panel,
        .book-card--borrowed-view .book-card-info-panel {
            padding: 6px 12px 10px;
            padding-top: 4px;
        }
        /* Půjčil/a jsem: nižší panel, název a autor vždy vidět, rohy lícují s kartou (20px) */
        .book-card--borrowed-view .book-card-info-panel {
            min-height: auto;
            max-height: none;
            border-radius: 0 0 20px 20px;
            padding: 8px 12px 10px;
            padding-top: 6px;
        }
        .book-card--borrowed-view .book-card-title,
        .book-card--borrowed-view .book-card-author {
            font-size: 0.9375rem;
            line-height: 1.35;
            color: #1a1a1a;
        }
        .book-card--borrowed-view .book-card-panel-actions--borrowed-only {
            margin-top: 6px;
            padding-top: 0;
        }
        .book-card--borrowed-view .book-card-out-of-home {
            margin-top: 4px;
            font-size: 0.8125rem;
        }
        .book-card-cover-overlay {
            position: absolute;
            inset: 0;
            background: rgba(255, 255, 255, 0.94);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            padding: 14px;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
            border-radius: 14px;
            overflow: auto;
        }
        .book-card--collapsible.expanded .book-card-cover-overlay,
        .book-card--reading-expandable.expanded .book-card-cover-overlay {
            opacity: 1;
            visibility: visible;
        }
        .book-card-overlay-line {
            font-size: 0.8125rem;
            line-height: 1.5;
            color: #1a1a1a;
            margin-bottom: 4px;
        }
        .book-card-overlay-line:last-child {
            margin-bottom: 0;
        }
        .book-card--collapsible .book-card-toggle-wrap {
            display: block;
            width: 100%;
            padding: 2px 0 4px;
            margin: 0;
            border: none;
            background: none;
            cursor: pointer;
            font-size: 0.5rem;
            font-weight: 300;
            color: rgba(0, 0, 0, 0.5);
            text-align: center;
            position: relative;
            line-height: 1;
        }
        .book-card--collapsible .book-card-toggle-wrap:hover {
            color: rgba(0, 0, 0, 0.75);
        }
        .book-card-toggle-chevron {
            display: inline-block;
            transition: transform 0.2s;
            font-size: 0.6rem;
            font-weight: 400;
        }
        .book-card--collapsible .book-card-toggle-wrap.has-overdue::before {
            content: '';
            display: inline-block;
            width: 4px;
            height: 4px;
            border-radius: 50%;
            background: #ff3b30;
            margin-right: 4px;
            vertical-align: middle;
        }
        .book-card--collapsible .book-card-detail-wrap {
            max-height: 0;
            overflow: hidden;
            opacity: 0;
            transition: max-height 0.4s ease-out, opacity 0.25s ease-out;
        }
        .book-card--collapsible.expanded .book-card-detail-wrap {
            max-height: 420px;
            opacity: 1;
            transition: max-height 0.45s ease-in, opacity 0.25s ease-in;
        }
        .book-card-accordion-actions {
            display: none;
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid var(--border);
            flex-direction: column;
            gap: 8px;
        }
        .book-card--collapsible .book-card-accordion-actions {
            display: none;
        }
        .book-card--collapsible.expanded .book-card-accordion-actions {
            display: flex;
        }
        .book-card-accordion-btn--delete {
            align-self: flex-start;
            padding: 6px 12px;
            font-size: 0.8125rem;
            border: 1px solid rgba(255, 59, 48, 0.4);
            background: rgba(255, 59, 48, 0.08);
            color: #c93400;
            border-radius: 8px;
            cursor: pointer;
        }
        .book-card-accordion-btn--delete:hover {
            background: rgba(255, 59, 48, 0.15);
        }
        .book-card-accordion-move { display: flex; align-items: center; gap: 8px; flex-wrap: wrap; }
        .book-card-accordion-move-label { font-size: 0.8125rem; color: var(--text-muted); }
        .book-card-accordion-move-label select { margin-left: 4px; }
        .book-card-accordion-select {
            padding: 6px 10px;
            font-size: 0.8125rem;
            border-radius: 6px;
            border: 1px solid var(--border);
            background: var(--surface);
            color: var(--text);
            min-width: 160px;
        }

        /* Rozečteno: šipka rozbalí AI tipy a výtah (karta bez červeného pozadí při opozdění) */
        .book-card--reading-expandable .book-card-reading-toggle-wrap {
            display: block;
            width: 100%;
            padding: 8px 0;
            margin: 0;
            border: none;
            background: none;
            cursor: pointer;
            font-size: 0.75rem;
            color: #000;
            text-align: center;
            position: relative;
        }
        .book-card--reading-expandable .book-card-reading-toggle-wrap:hover {
            color: #333;
        }
        .book-card--reading-expandable .book-card-reading-toggle-wrap.has-overdue::before {
            content: '';
            display: inline-block;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: #ff3b30;
            margin-right: 6px;
            vertical-align: middle;
        }
        .book-card--reading-expandable .reading-ai-expand-wrap {
            max-height: 0;
            overflow: hidden;
            opacity: 0;
            transition: max-height 0.4s ease-out, opacity 0.25s ease-out;
        }
        .book-card--reading-expandable.expanded .reading-ai-expand-wrap {
            max-height: 420px;
            opacity: 1;
            transition: max-height 0.45s ease-in, opacity 0.25s ease-in;
        }
        .book-card-out-of-home {
            font-size: 0.8125rem;
            color: var(--text-muted);
            margin-top: 8px;
        }

        .shelf-pagination {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-top: 16px;
            padding: 8px 0;
        }
        .shelf-pagination-btn {
            padding: 8px 14px;
            font-size: 0.875rem;
            border: 1px solid #000;
            background: #fff;
            color: #000;
            border-radius: 8px;
            cursor: pointer;
        }
        .shelf-pagination-btn:hover:not(:disabled) {
            background: rgba(0, 0, 0, 0.06);
        }
        .shelf-pagination-btn:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }
        .shelf-pagination-pages {
            display: flex;
            gap: 6px;
        }
        .shelf-pagination-num {
            width: 36px;
            height: 36px;
            padding: 0;
            font-size: 0.875rem;
            border: 1px solid #000;
            background: #fff;
            color: #000;
            border-radius: 8px;
            cursor: pointer;
        }
        .shelf-pagination-num:hover {
            background: rgba(0, 0, 0, 0.06);
        }
        .shelf-pagination-num.is-current {
            background: rgba(141, 211, 17, 0.25);
            border-color: #000;
        }

        /* Globální varovný pruh pod horním menu (červený) */
        .overdue-banner {
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 12px;
            padding: 18px 28px;
            margin: 0 0 1rem 0;
            background-color: #ffcccc;
            border: 1px solid rgba(200, 80, 80, 0.5);
            border-radius: 0;
            font-size: 0.9375rem;
        }
        .overdue-banner-text {
            flex: 1;
            min-width: 200px;
            color: #1a1a1a;
        }
        .overdue-banner-btn {
            padding: 8px 16px;
            border-radius: 10px;
            border: 1px solid #000;
            background: #fff;
            color: #000;
            font-size: 0.875rem;
            font-weight: 600;
            font-family: inherit;
            cursor: pointer;
            flex-shrink: 0;
            transition: background 0.2s;
        }
        .overdue-banner-btn:hover {
            background: #ffe0e0;
        }

        /* Horní varovná lišta – opozdilci (jemně červená, styl limo) */
        .borrowed-alarm-bar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 12px;
            padding: 18px 28px;
            margin-bottom: 1rem;
            background: rgba(255, 59, 48, 0.08);
            border: 1px solid rgba(255, 59, 48, 0.25);
            border-radius: 10px;
        }

        /* Wishlist: výsledky vyhledávání napříč knihovnou (Přidat/Odebrat) */
        .wishlist-search-results {
            position: absolute;
            top: 48px;
            right: 0;
            width: min(520px, calc(100vw - 40px));
            background: #fff;
            border: 1px solid rgba(0,0,0,0.08);
            border-radius: 14px;
            box-shadow: 0 10px 22px rgba(0,0,0,0.10);
            padding: 10px;
            z-index: 50;
            display: none;
        }
        .wishlist-search-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 12px;
            padding: 10px 10px;
            border-radius: 12px;
        }
        .wishlist-search-item:hover { background: rgba(141, 211, 17, 0.10); }
        .wishlist-search-meta { min-width: 0; display: flex; flex-direction: column; gap: 2px; }
        .wishlist-search-title { font-weight: 700; font-size: 0.95rem; color: var(--text); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .wishlist-search-author { font-size: 0.85rem; color: var(--text-muted); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .wishlist-search-btn {
            flex: 0 0 auto;
            border: 1px solid rgba(141, 211, 17, 0.55);
            background: rgba(141, 211, 17, 0.12);
            color: #1d1d1f;
            border-radius: 999px;
            padding: 8px 12px;
            font-weight: 700;
            font-size: 0.85rem;
            cursor: pointer;
            transition: background 0.15s ease, transform 0.15s ease;
        }
        .wishlist-search-btn:hover { background: rgba(141, 211, 17, 0.22); transform: translateY(-1px); }
        .wishlist-search-btn.is-active {
            background: rgba(40, 167, 69, 0.14);
            border-color: rgba(40, 167, 69, 0.55);
        }
        .wishlist-search-empty {
            padding: 10px 12px;
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        /* Na prodej – akce na kartě */
        .book-card-sale-tools {
            margin-top: 10px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .book-card-sale-btn {
            width: 100%;
            border: 1px solid var(--border);
            background: var(--surface);
            color: var(--text);
            padding: 10px 12px;
            border-radius: 12px;
            font-weight: 800;
            font-size: 0.9rem;
            cursor: pointer;
            font-family: inherit;
            transition: background 0.15s ease, transform 0.15s ease;
        }
        .book-card-sale-btn:hover { background: var(--accent-soft); transform: translateY(-1px); }
        .book-card-sale-btn--market {
            border-color: rgba(141, 211, 17, 0.55);
            background: rgba(141, 211, 17, 0.16);
        }
        .book-card-sale-btn--market:hover { background: rgba(141, 211, 17, 0.24); }
        .book-card-sale-btn--cancel {
            border-color: rgba(220, 38, 38, 0.35);
            background: rgba(220, 38, 38, 0.06);
        }
        .book-card-sale-btn--cancel:hover { background: rgba(220, 38, 38, 0.10); }
        .book-card-sale-acc {
            border: 1px solid var(--border-soft);
            border-radius: 14px;
            overflow: hidden;
            background: rgba(255,255,255,0.55);
        }
        .book-card-sale-acc-toggle {
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 10px;
            padding: 10px 12px;
            border: none;
            background: transparent;
            cursor: pointer;
            font-family: inherit;
            font-weight: 800;
            color: var(--text);
        }
        .book-card-sale-acc-toggle:hover { background: rgba(0,0,0,0.03); }
        .book-card-sale-acc-body {
            padding: 10px 12px 12px;
            display: flex;
            flex-direction: column;
            gap: 8px;
            border-top: 1px solid var(--border-soft);
        }
        .borrowed-alarm-text {
            font-size: 0.875rem;
            color: #000;
            flex: 1;
            min-width: 200px;
        }
        .borrowed-alarm-btn {
            padding: 8px 14px;
            border-radius: 8px;
            border: 1px solid #000;
            background: #fff;
            color: #000;
            font-size: 0.8125rem;
            font-family: inherit;
            cursor: pointer;
            flex-shrink: 0;
            transition: background 0.2s;
        }
        .borrowed-alarm-btn:hover {
            background: rgba(255, 59, 48, 0.1);
        }

        /* Layout: mřížka + panel vzkazů vedle sebe (Půjčil/a jsem) */
        .scan-history-content-wrap.has-borrowed-messages {
            display: flex;
            flex-wrap: wrap;
            gap: 1.5rem;
            align-items: flex-start;
        }
        .scan-history-content-wrap.has-borrowed-messages .books-grid {
            flex: 1;
            min-width: 280px;
        }
        .borrowed-messages-panel {
            width: 100%;
            max-width: 360px;
            padding: 1.25rem;
            background: #fff;
            border: 1px solid #000;
            border-radius: 1rem;
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.06);
        }
        .borrowed-messages-title {
            margin: 0 0 12px 0;
            font-size: 1rem;
            font-weight: 600;
            color: #000;
        }
        .borrowed-messages-body {
            font-size: 0.9375rem;
            color: #000;
            line-height: 1.5;
            margin-bottom: 1rem;
        }
        .borrowed-messages-placeholder {
            margin: 0;
        }
        .borrowed-message-item {
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 1px solid rgba(0, 0, 0, 0.08);
        }
        .borrowed-message-item:last-child {
            margin-bottom: 0;
            padding-bottom: 0;
            border-bottom: none;
        }
        .borrowed-message-text {
            margin: 0 0 10px 0;
            font-size: 0.9375rem;
            line-height: 1.5;
            color: #1a1a1a;
        }
        .borrowed-messages-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        .borrowed-msg-btn {
            padding: 8px 14px;
            border-radius: 8px;
            border: 1px solid #000;
            background: rgba(209, 255, 82, 0.12);
            color: #000;
            font-size: 0.8125rem;
            font-family: inherit;
            cursor: pointer;
            transition: background 0.2s;
        }
        .borrowed-msg-btn:hover {
            background: rgba(209, 255, 82, 0.25);
        }

        /* Karta + knižní chat pod kartou (Půjčil/a jsem); připraveno i pro Fórum, Tržiště, Půjčovna */
        .borrowed-card-with-chat {
            display: flex;
            flex-direction: column;
            gap: 0;
            min-width: 0;
        }
        .borrowed-card-with-chat .book-card {
            flex-shrink: 0;
        }
        .item-chat {
            flex: 0 0 auto;
            margin-top: 10px;
            padding: 12px 14px;
            background: #fff;
            border: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: 12px;
            font-size: 0.9375rem;
            line-height: 1.5;
        }
        .item-chat-placeholder {
            margin: 0;
            color: var(--text-muted, #6b7280);
            font-size: 0.875rem;
        }
        .item-chat-message {
            margin-bottom: 14px;
            padding-bottom: 12px;
            border-bottom: 1px solid rgba(0, 0, 0, 0.06);
        }
        .item-chat-message:last-child {
            margin-bottom: 0;
            padding-bottom: 0;
            border-bottom: none;
        }
        .item-chat-message-text {
            margin: 0 0 8px 0;
            color: #1a1a1a;
        }
        .item-chat-message-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 8px;
        }
        .item-chat-reply-btn {
            padding: 8px 14px;
            border-radius: 10px;
            border: 1px solid #000;
            background: rgba(209, 255, 82, 0.15);
            color: #000;
            font-size: 0.8125rem;
            font-weight: 500;
            font-family: inherit;
            cursor: pointer;
            transition: background 0.2s;
        }
        .item-chat-reply-btn:hover {
            background: rgba(209, 255, 82, 0.3);
        }
        /* Modál Odpovědět / Poslat poděkování (itemChat) */
        .item-chat-reply-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.4);
            z-index: 10001;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 24px;
        }
        .item-chat-reply-modal {
            background: #fff;
            border-radius: 20px;
            border: 1px solid rgba(0, 0, 0, 0.1);
            max-width: 440px;
            width: 100%;
            overflow: hidden;
        }
        .item-chat-reply-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 18px 20px;
            border-bottom: 1px solid rgba(0, 0, 0, 0.08);
        }
        .item-chat-reply-title {
            margin: 0;
            font-size: 1.125rem;
            font-weight: 600;
            color: #1a1a1a;
        }
        .item-chat-reply-close {
            width: 32px;
            height: 32px;
            border: none;
            background: none;
            font-size: 1.5rem;
            color: #666;
            cursor: pointer;
            line-height: 1;
            padding: 0;
        }
        .item-chat-reply-close:hover {
            color: #000;
        }
        .item-chat-reply-body {
            padding: 18px 20px;
        }
        .item-chat-reply-label {
            display: block;
            font-size: 0.875rem;
            font-weight: 600;
            color: #1a1a1a;
            margin-bottom: 8px;
        }
        .item-chat-reply-textarea {
            width: 100%;
            padding: 12px 14px;
            border: 1px solid rgba(0, 0, 0, 0.15);
            border-radius: 12px;
            font-size: 1rem;
            font-family: inherit;
            resize: vertical;
            min-height: 100px;
        }
        .item-chat-reply-textarea:focus {
            outline: none;
            border-color: #000;
            box-shadow: 0 0 0 2px rgba(0, 0, 0, 0.08);
        }
        .item-chat-reply-footer {
            padding: 14px 20px 20px;
        }
        .item-chat-reply-send {
            width: 100%;
            padding: 12px 20px;
            border: none;
            border-radius: 12px;
            background: #000;
            color: #fff;
            font-size: 1rem;
            font-weight: 600;
            font-family: inherit;
            cursor: pointer;
            transition: background 0.2s;
        }
        .item-chat-reply-send:hover {
            background: #333;
        }

        .book-card-borrowed-name-clickable {
            cursor: pointer;
            text-decoration: underline;
            text-underline-offset: 2px;
        }
        .book-card-borrowed-name-clickable:hover {
            color: #1a4d0e;
        }
        .book-card-borrowed-hist-btn {
            margin-top: 10px;
            padding: 8px 14px;
            border-radius: 8px;
            border: 1px solid #000;
            background: rgba(209, 255, 82, 0.12);
            color: #000;
            font-size: 0.8125rem;
            font-family: inherit;
            cursor: pointer;
            transition: background 0.2s;
        }
        .book-card-borrowed-hist-btn:hover {
            background: rgba(209, 255, 82, 0.25);
        }

        /* Modál Historie vypůjčitelů */
        .borrowed-history-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.4);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
        }
        .borrowed-history-modal {
            background: #fff;
            border: 1px solid #000;
            border-radius: 1rem;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.12);
            max-width: 360px;
            width: 90%;
        }
        .borrowed-history-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1rem 1.25rem;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }
        .borrowed-history-title { margin: 0; font-size: 1.125rem; font-weight: 600; color: #000; }
        .borrowed-history-close { background: none; border: none; font-size: 1.5rem; cursor: pointer; color: #000; padding: 0 4px; }
        .borrowed-history-body { padding: 1.25rem; color: #000; font-size: 0.9375rem; }
        .borrowed-history-list { margin: 0; padding-left: 1.25rem; }

        /* Modál AI upomínka */
        .borrowed-reminder-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.4);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
        }
        .borrowed-reminder-modal {
            background: #fff;
            border: 1px solid #000;
            border-radius: 1rem;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.12);
            max-width: 420px;
            width: 90%;
            padding: 1.25rem;
        }
        .borrowed-reminder-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 1rem; }
        .borrowed-reminder-title { margin: 0; font-size: 1.125rem; font-weight: 600; color: #000; }
        .borrowed-reminder-close { background: none; border: none; font-size: 1.5rem; cursor: pointer; color: #000; padding: 0 4px; }
        .borrowed-reminder-choices { display: flex; gap: 10px; margin-bottom: 1rem; }
        .borrowed-reminder-btn {
            padding: 10px 18px;
            border-radius: 10px;
            border: 1px solid #000;
            background: rgba(209, 255, 82, 0.15);
            color: #000;
            font-size: 0.9rem;
            font-family: inherit;
            cursor: pointer;
            transition: background 0.2s;
        }
        .borrowed-reminder-btn:hover { background: rgba(209, 255, 82, 0.3); }
        .borrowed-reminder-result {
            padding: 12px;
            background: rgba(209, 255, 82, 0.08);
            border: 1px solid rgba(0, 0, 0, 0.12);
            border-radius: 10px;
            font-size: 0.9375rem;
            color: #000;
            line-height: 1.5;
            white-space: pre-wrap;
        }

        /* Tlačítka – jedna linka na spodní okraj panelu, jemné podbarvení (Apple style); zaoblení spodních rohů */
        .book-card-panel-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: auto;
            padding: 10px 14px 14px;
            margin-left: -14px;
            margin-right: -14px;
            margin-bottom: -14px;
            padding-top: 12px;
            border-top: 1px solid rgba(0, 0, 0, 0.06);
            background: rgba(0, 0, 0, 0.03);
            border-radius: 0 0 20px 20px;
            overflow: hidden;
        }
        .book-card-btn {
            flex: 1;
            padding: 9px 14px;
            font-size: 0.8125rem;
            font-weight: 600;
            font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "Segoe UI", Roboto, sans-serif;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: background 0.2s ease, color 0.2s ease;
            -webkit-appearance: none;
            appearance: none;
            color: #1a1a1a !important;
            background: var(--accent-soft);
        }
        .book-card-btn:hover {
            background: rgba(141, 211, 17, 0.22);
            color: #1a1a1a !important;
        }
        .book-card-btn-edit {
            background: var(--accent-soft);
        }
        .book-card-btn-edit:hover {
            background: rgba(141, 211, 17, 0.22);
        }
        .book-card-btn-pracovna {
            background: var(--accent-soft);
        }
        .book-card-btn-pracovna:hover {
            background: rgba(141, 211, 17, 0.22);
        }

        /* Srdcovky – poznámky na kartě */
        .book-card-fav-tools {
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid rgba(0,0,0,0.06);
        }
        .book-card-fav-note-input {
            width: 100%;
            min-height: 70px;
            padding: 10px 12px;
            border: 1px solid rgba(141, 211, 17, 0.26);
            background: rgba(247, 254, 231, 0.55);
            border-radius: 14px;
            font-size: 0.9rem;
            font-family: inherit;
            resize: vertical;
            color: var(--text);
        }
        .book-card-fav-actions {
            display: flex;
            gap: 10px;
            margin-top: 10px;
            flex-wrap: wrap;
        }
        .book-card-fav-btn {
            flex: 1;
            border: 1px solid rgba(0,0,0,0.10);
            background: #fff;
            border-radius: 12px;
            padding: 10px 12px;
            font-weight: 900;
            cursor: pointer;
        }
        .book-card-fav-btn--recommend {
            border-color: rgba(141, 211, 17, 0.55);
            background: rgba(141, 211, 17, 0.14);
            color: #14532d;
        }
        .book-card-fav-btn:hover { background: rgba(0,0,0,0.03); }
        .book-card-fav-btn--recommend:hover { background: rgba(141, 211, 17, 0.20); }
        .book-card-fav-notes {
            margin-top: 10px;
            display: flex;
            flex-direction: column;
            gap: 8px;
            max-height: 160px;
            overflow: auto;
            padding-right: 2px;
        }
        .book-card-fav-note-item {
            padding: 9px 10px;
            border-radius: 14px;
            background: rgba(255,255,255,0.95);
            border: 1px solid rgba(0,0,0,0.08);
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
            color: var(--text-secondary);
            font-size: 0.875rem;
            line-height: 1.35;
        }
        .book-card-fav-note-more {
            font-size: 0.8125rem;
            color: var(--text-muted);
            font-weight: 700;
            padding: 2px 4px;
        }
        /* Sekce Rozečteno – tlačítka Upravit a Pracovna v limetkovém podbarvení */
        .book-card-delete {
            flex-shrink: 0;
            background: none;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            padding: 6px;
            border-radius: 6px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            transition: all 0.15s;
            width: 32px;
            height: 32px;
            margin-top: -2px;
        }

        .book-card-delete:hover {
            background: var(--error-soft);
            color: var(--error);
        }

        .book-card-delete svg {
            width: 14px;
            height: 14px;
        }

        .manual-add-form {
            margin-top: 32px;
            padding: 28px;
            background: var(--surface-elevated);
            border: 1px solid var(--border);
            border-radius: var(--radius);
        }

        /* Čistý dashboard: ruční přidání sbalené za tlačítkem */
        .manual-add-toggle-row {
            display: flex;
            justify-content: flex-start;
            margin: 8px 0 12px;
        }
        .btn-manual-add-toggle {
            appearance: none;
            border: 1px solid var(--border);
            background: #fff;
            color: var(--text);
            border-radius: 999px;
            padding: 10px 14px;
            font-weight: 700;
            cursor: pointer;
            transition: border-color 0.15s, background 0.15s, transform 0.15s;
        }
        .btn-manual-add-toggle:hover {
            border-color: rgba(141, 211, 17, 0.6);
            background: rgba(141, 211, 17, 0.06);
        }
        .btn-manual-add-toggle:active { transform: translateY(1px); }
        .manual-add-panel { margin-top: 8px; }
        .manual-add-panel[hidden] { display: none; }

        .manual-add-form-title {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--text);
            margin-bottom: 16px;
        }

        .manual-add-form .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 14px;
        }

        .manual-add-form .form-row-three {
            grid-template-columns: 1fr 1fr 1fr;
        }

        .manual-add-form .form-row-four {
            grid-template-columns: 1fr 1fr 1fr 1fr;
        }

        .manual-add-form .form-row-five {
            grid-template-columns: 1fr 1fr 1fr 1fr 1fr;
        }

        .manual-add-form label {
            display: block;
            font-size: 0.75rem;
            font-weight: 500;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.04em;
            margin-bottom: 6px;
        }

        .manual-add-form input {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            font-size: 0.9375rem;
            font-family: inherit;
            color: var(--text);
            background: var(--bg);
        }

        .manual-add-form input:focus {
            outline: none;
            border-color: var(--text);
        }

        .manual-add-form input::placeholder {
            color: var(--text-muted);
        }

        .manual-add-form .btn-add-manually {
            background: var(--btn-primary);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: var(--radius-sm);
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            font-family: inherit;
            transition: background 0.2s;
        }

        .manual-add-form .btn-add-manually:hover {
            background: var(--accent-hover);
        }

        .btn-add-wishlist {
            padding: 10px 20px;
            background: var(--surface);
            border: 1px solid var(--border);
            color: var(--text-secondary);
            border-radius: var(--radius-sm);
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            font-family: inherit;
            transition: all 0.2s;
        }

        .btn-add-wishlist:hover {
            background: var(--accent-soft);
            border-color: var(--text);
            color: var(--text);
        }

        .book-card-location {
            font-size: 0.75rem;
            color: var(--text-muted);
            margin-top: 4px;
        }

        .book-card-position {
            font-size: 0.7rem;
            color: var(--text-muted);
            margin-top: 2px;
            opacity: 0.9;
        }

        .book-card-value {
            font-size: 0.7rem;
            color: var(--text-muted);
            margin-top: 2px;
            opacity: 0.9;
        }

        .book-card-borrowed {
            font-size: 0.75rem;
            color: var(--error);
            margin-top: 6px;
            font-style: italic;
        }

        .duplicate-warning {
            font-size: 0.75rem;
            color: var(--error);
            margin-top: 6px;
            font-weight: 600;
        }

        .btn-lend, .btn-return {
            padding: 6px 12px;
            border-radius: var(--radius-sm);
            font-size: 0.8125rem;
            font-weight: 500;
            cursor: pointer;
            font-family: inherit;
            border: none;
            transition: background 0.2s, color 0.2s;
        }

        .btn-lend {
            background: var(--btn-primary);
            color: white;
        }

        .btn-lend:hover {
            background: var(--accent-hover);
        }

        .availability-dropdown-unified {
            width: 100%;
            padding: 8px 12px;
            font-size: 0.8rem;
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            background: var(--surface);
            color: var(--text);
            font-family: inherit;
            cursor: pointer;
            transition: border-color 0.2s;
        }
        .availability-dropdown-unified:focus {
            outline: none;
            border-color: var(--text);
        }
        .availability-dropdown-unified option {
            color: var(--text);
        }
        .availability-badge-forsale, .availability-badge-giveaway {
            display: inline-block;
            font-size: 0.65rem;
            font-weight: 600;
            padding: 3px 8px;
            border-radius: 6px;
            margin-top: 6px;
        }
        .availability-badge-forsale {
            background: var(--accent-soft);
            color: var(--text);
        }
        .availability-badge-giveaway {
            background: rgba(5, 150, 105, 0.15);
            color: var(--success);
        }

        .btn-return {
            background: var(--error-soft);
            color: var(--error);
        }

        .btn-return:hover {
            background: var(--error);
            color: white;
        }

        .item-card.return-due-soon {
            border: 2px solid var(--error);
            box-shadow: 0 0 0 1px var(--error);
        }

        .return-due-badge {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--error);
            margin-top: 6px;
        }

        .return-due-badge svg {
            flex-shrink: 0;
        }

        .borrowed-reminder-badge {
            display: inline-flex;
            align-items: center;
            padding: 6px 12px;
            border-radius: var(--radius-sm);
            font-size: 0.8rem;
            font-weight: 500;
            margin-top: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }

        .borrowed-reminder-week {
            background: #fef3c7;
            color: #92400e;
            border: 1px solid #fcd34d;
        }

        .borrowed-reminder-month {
            background: #fee2e2;
            color: #991b1b;
            border: 1px solid #fca5a5;
        }

        .currently-reading-welcome {
            margin: 12px 0 20px;
            padding: 18px 24px;
            background: linear-gradient(135deg, var(--accent-soft) 0%, rgba(107, 144, 128, 0.08) 100%);
            border: 1px solid rgba(107, 144, 128, 0.25);
            border-radius: var(--radius);
        }
        .currently-reading-welcome-msg {
            margin: 0;
            font-size: 0.95rem;
            color: var(--text-secondary);
            line-height: 1.5;
        }
        .currently-reading-form-actions {
            display: flex;
            align-items: center;
            gap: 12px;
            flex-wrap: wrap;
            margin-top: 12px;
        }
        .btn-nothing-to-read {
            padding: 6px 12px;
            font-size: 0.8rem;
            font-weight: 500;
            border-radius: var(--radius-sm);
            background: transparent;
            color: var(--text-secondary);
            border: 1px dashed var(--border);
            cursor: pointer;
            transition: all 0.15s;
        }
        .btn-nothing-to-read:hover {
            color: var(--text);
            border-color: var(--text);
            background: var(--accent-soft);
        }
        .currently-reading-reminder {
            margin: 12px 0;
            padding: 14px 18px;
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border: 1px solid #bae6fd;
            border-radius: var(--radius);
            display: flex;
            align-items: center;
            gap: 16px;
            flex-wrap: wrap;
        }
        .currently-reading-reminder-text {
            flex: 1;
            min-width: 0;
            margin: 0;
            font-size: 0.95rem;
            color: var(--text);
        }
        .btn-reminder-go {
            flex-shrink: 0;
            padding: 8px 16px;
            font-size: 0.85rem;
            font-weight: 500;
            border-radius: var(--radius-sm);
            background: var(--btn-primary);
            color: white;
            border: none;
        }
        .btn-reminder-go:hover {
            background: var(--accent-hover);
        }

        .borrowed-by-me-form {
            background: var(--bg-soft);
            border-radius: var(--radius);
            padding: 16px;
            margin-bottom: 20px;
            border: 1px solid var(--border);
        }

        .borrowed-by-me-form-title {
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 12px;
            color: var(--text);
        }

        .btn-scan-borrowed {
            padding: 10px 18px;
            font-size: 0.875rem;
            font-weight: 500;
            border-radius: var(--radius-sm);
            border: 1px solid var(--btn-primary);
            background: var(--accent-soft);
            color: var(--text);
            cursor: pointer;
            font-family: inherit;
            white-space: nowrap;
            transition: all 0.2s;
        }
        .btn-scan-borrowed:hover {
            background: var(--btn-primary);
            color: white;
        }

        .record-loan-form {
            background: var(--bg-soft);
            border-radius: var(--radius);
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid var(--border);
        }
        .record-loan-form-title {
            font-size: 0.95rem;
            font-weight: 600;
            margin-bottom: 16px;
            color: var(--text);
        }
        .record-loan-search-wrap, .record-loan-to-wrap {
            margin-bottom: 14px;
        }
        .record-loan-search-wrap { position: relative; }
        .record-loan-form label {
            display: block;
            font-size: 0.8rem;
            font-weight: 500;
            color: var(--text-secondary);
            margin-bottom: 6px;
        }
        .record-loan-form input {
            width: 100%;
            padding: 10px 14px;
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            font-size: 0.9rem;
            font-family: inherit;
        }
        .record-loan-form input:focus {
            outline: none;
            border-color: var(--text);
        }
        .record-loan-suggestions {
            position: absolute;
            left: 0;
            right: 0;
            top: 100%;
            margin-top: 4px;
            background: var(--surface-elevated);
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            max-height: 220px;
            overflow-y: auto;
            box-shadow: var(--shadow-hover);
            z-index: 50;
        }
        .record-loan-suggestion-item {
            padding: 10px 14px;
            cursor: pointer;
            font-size: 0.875rem;
            border-bottom: 1px solid var(--border-soft);
            transition: background 0.15s;
        }
        .record-loan-suggestion-item:last-child { border-bottom: none; }
        .record-loan-suggestion-item:hover,
        .record-loan-suggestion-item.selected { background: var(--accent-soft); }
        .record-loan-suggestion-item .suggestion-title { font-weight: 600; color: var(--text); }
        .record-loan-suggestion-item .suggestion-location { font-size: 0.75rem; color: var(--text-muted); margin-top: 4px; }
        .btn-confirm-loan {
            padding: 12px 24px;
            font-size: 0.9rem;
            font-weight: 600;
            border-radius: var(--radius-sm);
            border: none;
            background: var(--btn-primary);
            color: white;
            cursor: pointer;
            font-family: inherit;
            transition: all 0.2s;
        }
        .btn-confirm-loan:hover { background: var(--accent-hover); }
        .btn-confirm-loan:disabled { opacity: 0.6; cursor: not-allowed; }
        @keyframes loanFly {
            0% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
            40% { opacity: 1; transform: translate(-50%, -60%) scale(1.2); }
            100% { opacity: 0; transform: translate(20%, -120%) scale(0.6); }
        }
        .item-card-clean.book-lent { opacity: 0.72; }
        .item-card-clean.book-lent .item-card-cover img { filter: grayscale(0.4); }
        .book-lent-badge {
            font-size: 0.7rem;
            color: var(--text-muted);
            font-style: italic;
            padding: 0 12px 8px;
            display: flex;
            align-items: center;
            gap: 4px;
        }
        .book-reading-now-badge {
            font-size: 0.7rem;
            color: var(--success);
            padding: 0 12px 4px;
        }

        .btn-buy-shop {
            font-size: 0.7rem;
            padding: 4px 10px;
            border-radius: 4px;
            border: 1px solid var(--border);
            background: var(--surface);
            color: var(--text-muted);
            cursor: not-allowed;
            opacity: 0.7;
        }

        .friends-reviews-section {
            margin-top: 10px;
            padding-top: 8px;
            border-top: 1px solid var(--border);
            font-size: 0.8rem;
        }

        .friends-reviews-title {
            font-weight: 600;
            color: var(--text-muted);
            margin-bottom: 6px;
            font-size: 0.75rem;
        }

        .friend-review-item {
            display: flex;
            align-items: flex-start;
            gap: 6px;
            margin-bottom: 6px;
            font-size: 0.78rem;
        }

        .friend-review-name {
            font-weight: 500;
            color: var(--text);
            flex-shrink: 0;
        }

        .friend-review-msg-btn {
            background: none;
            border: none;
            cursor: pointer;
            padding: 0 2px;
            color: var(--text-muted);
        }

        .friend-review-msg-btn:hover {
            color: var(--text);
        }

        .my-review-input {
            width: 100%;
            font-size: 0.78rem;
            padding: 6px 8px;
            border: 1px solid var(--border);
            border-radius: 4px;
            margin-top: 4px;
        }

        .availability-dropdown {
            font-size: 0.75rem;
            padding: 4px 8px;
            border: 1px solid var(--border);
            border-radius: 4px;
            background: var(--surface);
            cursor: pointer;
            min-width: 140px;
        }

        .availability-badge {
            font-size: 0.7rem;
            padding: 2px 8px;
            border-radius: 4px;
            font-weight: 600;
        }

        .availability-badge-shared {
            background: #d4edda;
            color: #155724;
        }

        .availability-badge-request {
            background: #fff3cd;
            color: #856404;
        }

        .lend-reference-section {
            margin-top: 10px;
            padding-top: 8px;
            border-top: 1px solid var(--border);
            font-size: 0.8rem;
        }

        .btn-ask-opinion {
            font-size: 0.72rem;
            padding: 4px 10px;
            border-radius: 4px;
            border: 1px solid var(--btn-primary);
            color: var(--text);
            background: transparent;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }

        .btn-ask-opinion:hover {
            background: var(--accent-soft);
        }

        .tip-section {
            margin-top: 48px;
            padding: 32px;
            background: var(--surface-elevated);
            border: 1px solid var(--border);
            border-radius: var(--radius);
        }

        .tip-section h2 {
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: 16px;
            color: var(--text);
        }

        .tip-content {
            min-height: 60px;
            padding: 16px;
            background: var(--surface-elevated);
            border: 1px solid var(--border-soft);
            border-radius: var(--radius-sm);
            font-size: 0.9375rem;
            color: var(--text-secondary);
            line-height: 1.5;
        }

        .tip-content.loading {
            color: var(--text-muted);
            font-style: italic;
        }

        .btn-recommendation {
            margin-top: 16px;
            padding: 10px 20px;
            background: var(--btn-primary);
            color: white;
            border: none;
            border-radius: var(--radius-sm);
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            font-family: inherit;
            transition: background 0.2s;
        }

        .btn-recommendation:hover {
            background: var(--accent-hover);
        }

        .tip-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            margin-top: 16px;
        }

        .btn-add-tip-wishlist {
            padding: 10px 20px;
            background: var(--surface);
            border: 1px solid var(--btn-primary);
            color: var(--text);
            border-radius: var(--radius-sm);
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            font-family: inherit;
        }

        .btn-add-tip-wishlist:hover {
            background: var(--accent-soft);
        }

        .wishlist-quick-add {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 20px;
            padding: 12px;
            background: var(--surface-elevated);
            border-radius: var(--radius);
            border: 1px solid var(--border);
        }

        .wishlist-quick-add input {
            flex: 1;
            padding: 10px 14px;
            font-size: 0.95rem;
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
        }

        .btn-wishlist-quick-add {
            width: 40px;
            height: 40px;
            font-size: 1.25rem;
            font-weight: 600;
            background: var(--btn-primary);
            color: white;
            border: none;
            border-radius: var(--radius-sm);
            cursor: pointer;
        }

        .btn-wishlist-quick-add:hover {
            background: var(--accent-hover);
        }

        .btn-wishlist-detailed {
            padding: 8px 14px;
            font-size: 0.85rem;
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            cursor: pointer;
        }

        .btn-wishlist-detailed:hover {
            background: var(--accent-soft);
            border-color: var(--text);
        }

        .gift-notifications-wrap {
            position: relative;
            display: inline-flex;
        }
        .btn-gift-notifications {
            position: relative;
            width: 40px;
            height: 40px;
            padding: 0;
            font-size: 1.2rem;
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            cursor: pointer;
        }
        .btn-gift-notifications:hover {
            background: var(--accent-soft);
            border-color: var(--text);
        }
        .btn-gift-notifications-badge {
            position: absolute;
            top: -4px;
            right: -4px;
            min-width: 18px;
            height: 18px;
            padding: 0 5px;
            font-size: 0.7rem;
            font-weight: 600;
            line-height: 18px;
            text-align: center;
            color: #fff;
            background: var(--btn-primary);
            border-radius: 9px;
        }
        .gift-notifications-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            margin-top: 6px;
            min-width: 280px;
            max-height: 300px;
            overflow-y: auto;
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            z-index: 200;
        }
        .gift-notification-item {
            padding: 10px 12px;
            font-size: 0.85rem;
            border-bottom: 1px solid var(--border);
        }
        .gift-notification-item:last-child { border-bottom: none; }

        .wishlist-modal {
            position: fixed;
            inset: 0;
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .wishlist-modal-backdrop {
            position: absolute;
            inset: 0;
            background: rgba(0,0,0,0.4);
        }

        .wishlist-modal-content {
            position: relative;
            background: var(--surface);
            border-radius: var(--radius);
            padding: 24px;
            max-width: 400px;
            width: 90%;
            max-height: 85vh;
            overflow-y: auto;
            box-shadow: var(--shadow);
        }

        .wishlist-modal-content h3 {
            margin: 0 0 16px;
            font-size: 1.1rem;
        }

        .wishlist-modal-cover {
            width: 120px;
            height: 160px;
            border: 2px dashed var(--border);
            border-radius: var(--radius-sm);
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            overflow: hidden;
            transition: border-color 0.2s, background 0.2s;
        }

        .children-library-upload-wrap { margin-bottom: 24px; padding: 8px 0; }
        .btn-upload-new-book { width: 100%; max-width: 360px; padding: 18px 28px; font-size: 1.05rem; font-weight: 600; border: 1px solid var(--btn-primary); background: transparent; color: var(--text); border-radius: var(--radius); cursor: pointer; transition: background 0.2s, color 0.2s; display: block; margin: 0 auto; }
        .btn-upload-new-book:hover { background: var(--btn-primary); color: #fff; }
        .viewing-as-child .btn-upload-new-book:hover,
        .viewing-as-child .children-library .btn-upload-new-book:hover { color: #FFFFFF !important; }
        .add-item-modal-cover.dragover {
            border-color: var(--text);
            background: rgba(0,0,0,0.04);
        }

        .add-item-modal-cover .cover-drop-hint {
            font-size: 0.75rem;
            color: var(--text-muted);
            text-align: center;
            padding: 8px;
        }

        .add-item-modal-select {
            width: 100%;
            padding: 8px 12px;
            margin-top: 4px;
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            font-size: 0.9rem;
        }

        .wishlist-modal-cover img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .wishlist-modal-cover-placeholder {
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        .wishlist-modal-fields label {
            display: block;
            font-size: 0.8rem;
            margin-top: 12px;
        }

        .wishlist-modal-fields input {
            width: 100%;
            padding: 8px 12px;
            margin-top: 4px;
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
        }

        .wishlist-modal-actions {
            display: flex;
            gap: 12px;
            margin-top: 20px;
        }

        .btn-modal-cancel, .btn-modal-submit {
            padding: 10px 20px;
            border-radius: var(--radius-sm);
            font-size: 0.9rem;
            cursor: pointer;
        }

        .btn-modal-cancel {
            background: var(--surface);
            border: 1px solid var(--border);
        }

        .btn-modal-submit {
            background: var(--btn-primary);
            color: white;
            border: none;
        }
        .btn-modal-submit:hover { background: #000; }

        .wishlist-card-cover {
            width: 100%;
            aspect-ratio: 2/3;
            background: var(--surface-elevated);
            border-radius: var(--radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            margin-bottom: 8px;
        }

        .wishlist-card-cover img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .wishlist-card-placeholder, .item-card-placeholder {
            font-size: 0.75rem;
            text-align: center;
            padding: 8px;
            color: var(--text-muted);
        }

        .item-card-placeholder {
            background: linear-gradient(135deg, var(--accent-soft) 0%, rgba(0,0,0,0.03) 100%);
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            height: 100%;
            min-height: 80px;
            border-radius: var(--radius-sm);
        }

        .friends-interests-section {
            margin-top: 48px;
            padding: 32px;
            background: var(--surface-elevated);
            border: 1px solid var(--border);
            border-radius: var(--radius);
        }

        .library-accordion-content .friends-interests-section {
            margin-top: 0;
            margin-bottom: 24px;
        }

        .friends-interests-section h2 {
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: 16px;
            color: var(--text);
        }

        .friend-demands-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 16px;
        }

        .friend-demand-card {
            padding: 16px;
            padding-bottom: 44px;
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            box-shadow: 0 2px 12px rgba(0,0,0,0.06);
            position: relative;
        }
        .friend-demand-card .item-card-chevron {
            position: absolute;
            bottom: 10px;
            right: 10px;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-muted);
            opacity: 0.45;
            animation: chevron-pulse 2.5s ease-in-out infinite;
            transition: color 0.25s ease, opacity 0.25s ease, transform 0.25s ease;
        }
        .friend-demand-card:hover .item-card-chevron {
            color: var(--text);
            opacity: 1;
            animation: chevron-hover-pulse 1s ease-in-out infinite;
        }
        .friend-demand-card .item-card-chevron svg { width: 18px; height: 18px; }
        .friend-demand-card .card-chevron-tooltip {
            position: absolute;
            bottom: 100%;
            right: 0;
            margin-bottom: 8px;
            padding: 6px 10px;
            background: var(--text);
            color: var(--surface-elevated);
            font-size: 0.75rem;
            border-radius: var(--radius-sm);
            white-space: nowrap;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.2s ease, visibility 0s linear 0.2s;
            pointer-events: none;
        }
        .friend-demand-card .item-card-chevron.show-tooltip .card-chevron-tooltip {
            opacity: 1;
            visibility: visible;
            transition-delay: 0s;
        }
        @keyframes chevron-hover-pulse {
            0%, 100% { opacity: 0.9; }
            50% { opacity: 1; }
        }

        .friend-demand-card .demand-text {
            font-size: 0.9rem;
            color: var(--text);
            margin-bottom: 12px;
        }

        .friend-demand-card .demand-name {
            font-weight: 600;
            color: var(--text);
        }

        .btn-have-and-sell {
            padding: 8px 16px;
            font-size: 0.8rem;
            background: var(--btn-primary);
            color: white;
            border: none;
            border-radius: var(--radius-sm);
            cursor: pointer;
            font-family: inherit;
            box-shadow: 0 2px 8px rgba(99, 102, 241, 0.25);
        }

        .btn-have-and-sell:hover {
            background: var(--accent-hover);
        }

        .btn-want-to-borrow {
            padding: 10px 18px;
            font-size: 0.85rem;
            font-weight: 600;
            background: var(--btn-primary);
            color: white;
            border: none;
            border-radius: var(--radius-sm);
            cursor: pointer;
            font-family: inherit;
            box-shadow: 0 2px 8px rgba(99, 102, 241, 0.25);
            transition: all 0.2s;
        }

        .btn-want-to-borrow:hover {
            background: var(--accent-hover);
            transform: scale(1.02);
        }

        .btn-want-to-borrow.sent {
            background: #9ca3af;
            color: white;
            cursor: default;
            box-shadow: 0 2px 6px rgba(0,0,0,0.1);
        }

        .btn-sell-exchange {
            padding: 10px 18px;
            font-size: 0.85rem;
            font-weight: 500;
            border: 1px solid var(--border);
            background: var(--surface);
            color: var(--text-secondary);
            border-radius: var(--radius-sm);
            cursor: pointer;
            font-family: inherit;
            transition: all 0.2s;
        }
        .btn-sell-exchange:hover {
            border-color: var(--text);
            color: var(--text);
        }

        .friend-demand-card .demand-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 12px;
        }

        /* Přátelé doporučují — demo karty (shadow mode) */
        .friends-recommend-feed {
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
        }
        .friend-recommend-card {
            padding: 18px;
            background: var(--surface-elevated);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            box-shadow: var(--shadow-card);
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        .friend-recommend-card.friend-recommend-demo {
            opacity: 0.85;
            box-shadow: 0 4px 20px rgba(0,0,0,0.06), 0 0 0 1px rgba(79, 70, 229, 0.08);
        }
        .friend-recommend-header {
            display: flex;
            align-items: flex-start;
            gap: 12px;
        }
        .friend-recommend-avatar {
            width: 40px;
            height: 40px;
            min-width: 40px;
            border-radius: 50%;
            background: var(--btn-primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: 600;
        }
        .friend-recommend-meta { flex: 1; min-width: 0; }
        .friend-recommend-name {
            font-weight: 600;
            font-size: 0.95rem;
            color: var(--text);
            margin-bottom: 6px;
        }
        .friend-recommend-quote {
            font-size: 0.875rem;
            color: var(--text-secondary);
            line-height: 1.5;
            padding: 10px 14px;
            background: var(--surface);
            border-radius: var(--radius-sm);
            border-left: 3px solid var(--btn-primary);
        }
        .friend-recommend-book {
            font-size: 0.9rem;
            color: var(--text-secondary);
            padding-top: 4px;
        }
        .friend-recommend-book strong { color: var(--text); }
        .friend-recommend-badge {
            display: inline-block;
            padding: 6px 12px;
            font-size: 0.75rem;
            font-weight: 600;
            background: var(--success-soft);
            color: var(--success);
            border-radius: var(--radius-sm);
        }

        .mood-bar-top {
            margin-bottom: 24px;
            padding: 14px 20px;
            background: linear-gradient(135deg, var(--surface-elevated) 0%, var(--surface) 100%);
            border: 1px solid var(--border-soft);
            border-radius: var(--radius);
            display: flex;
            align-items: center;
            gap: 20px;
            flex-wrap: wrap;
        }

        .mood-bar-top .mood-question {
            margin-bottom: 0;
            font-size: 0.9rem;
        }

        .mood-bar-top .mood-buttons {
            gap: 8px;
        }

        .tag-suggester {
                display: flex;
                flex-wrap: wrap;
                gap: 8px;
                margin-top: 10px;
                margin-bottom: 4px;
            }
        .tag-suggester-btn {
                padding: 6px 12px;
                font-size: 0.8rem;
                font-weight: 500;
                border-radius: 999px;
                border: 1px solid var(--border);
                background: var(--surface);
                color: var(--text-secondary);
                cursor: pointer;
                transition: all 0.15s;
            }
        .tag-suggester-btn:hover {
                background: var(--accent-soft);
                border-color: var(--text);
                color: var(--text);
            }
        .tag-suggester-btn.active {
                background: var(--accent-soft);
                border-color: var(--text);
                color: var(--text);
            }
        .read-today-widget {
                background: linear-gradient(135deg, var(--accent-soft) 0%, rgba(107, 144, 128, 0.06) 100%);
                border: 1px solid rgba(79, 70, 229, 0.2);
                border-radius: var(--radius);
                padding: 20px 24px;
                margin-bottom: 20px;
            }
            .read-today-title {
                font-size: 1.1rem;
                font-weight: 600;
                margin: 0 0 14px;
                color: var(--text);
            }
            .read-today-buttons {
                display: flex;
                gap: 10px;
                flex-wrap: wrap;
            }
            .read-today-btn {
                padding: 10px 18px;
                font-size: 0.875rem;
                font-weight: 500;
                border-radius: var(--radius-sm);
                border: 1px solid var(--border);
                background: var(--surface);
                color: var(--text);
                cursor: pointer;
                transition: all 0.15s;
            }
            .read-today-btn:hover {
                background: var(--accent-soft);
                border-color: var(--text);
                color: var(--text);
            }
            .read-today-result {
                margin-top: 18px;
                padding-top: 18px;
                border-top: 1px solid var(--border-soft);
            }
            .read-today-message {
                font-size: 0.95rem;
                color: var(--text-secondary);
                margin: 0 0 14px;
                line-height: 1.5;
            }
            .read-today-card-wrap {
                max-width: 200px;
            }
            .read-today-card-wrap .item-card-clean { box-shadow: var(--shadow); }

            .statistics-section {
                padding: 24px 0;
                max-width: 720px;
            }
            .children-library-section {
                padding: 24px 0;
                max-width: 720px;
            }
            .children-library-title { font-size: 1.5rem; margin-bottom: 20px; color: var(--text-primary); }
            .children-library-admin-panel { display: flex; flex-direction: column; gap: 20px; margin-bottom: 28px; }
            .children-library-admin-card {
                background: var(--surface-elevated);
                border: 1px solid var(--border);
                border-radius: var(--radius);
                padding: 20px;
            }
            .children-library-admin-card h3 { font-size: 1rem; margin: 0 0 12px; color: var(--text-primary); }
            .children-library-admin-card label { display: block; font-size: 0.875rem; font-weight: 500; margin-bottom: 8px; color: var(--text-secondary); }
            .children-library-admin-card textarea {
                width: 100%;
                padding: 10px 12px;
                border: 1px solid var(--border);
                border-radius: var(--radius-sm);
                font-family: inherit;
                font-size: 0.9rem;
                resize: vertical;
                min-height: 80px;
            }
            .children-library-hint { font-size: 0.75rem; color: var(--text-muted); margin: 8px 0 0; }
            .children-library-recommendation-text { margin: 0 0 12px; font-size: 0.95rem; color: var(--text-secondary); }
            .btn-add-recommendation-wishlist { padding: 8px 16px; font-size: 0.875rem; border-radius: var(--radius-sm); background: var(--accent-soft); color: var(--text); border: none; cursor: pointer; }
            .children-library-placeholder { font-size: 1rem; color: var(--text-secondary); padding: 24px; text-align: center; }
            .children-library-intro { font-size: 0.95rem; color: var(--text-secondary); margin: 0 0 20px; line-height: 1.5; }
            .children-library-cards-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); gap: 16px; }
            .children-future-games { display: grid; gap: 16px; margin-top: 24px; }
            .children-future-game-card {
                background: var(--surface-elevated);
                border: 1px solid var(--border);
                border-radius: var(--radius);
                padding: 20px;
                position: relative;
            }
            .children-future-game-icon { font-size: 2rem; display: block; margin-bottom: 8px; }
            .children-future-game-card h4 { font-size: 1rem; margin: 0 0 8px; }
            .children-future-game-card p { font-size: 0.9rem; color: var(--text-secondary); margin: 0; line-height: 1.4; }
            .children-future-game-soon { font-size: 0.75rem; color: var(--text); font-weight: 600; margin-top: 8px; display: inline-block; }
            .book-challenge-badge { font-size: 1.25rem; font-weight: 700; padding: 16px 24px; background: linear-gradient(135deg, #fef3c7, #fde68a); border: 2px solid #d97706; border-radius: 12px; text-align: center; margin-bottom: 16px; }
            .statistics-title {
                font-size: 1.25rem;
                font-weight: 600;
                margin: 0 0 20px;
                color: var(--text);
            }
            .statistics-casostroj {
                margin-bottom: 24px;
                padding: 16px 20px;
                background: var(--surface-elevated);
                border: 1px solid var(--border);
                border-radius: var(--radius);
            }
            .statistics-casostroj-label { display: block; font-size: 0.9rem; font-weight: 600; margin-bottom: 12px; color: var(--text); }
            .statistics-casostroj-row { display: flex; align-items: center; gap: 12px; flex-wrap: wrap; }
            .statistics-date-input { padding: 8px 12px; border: 1px solid var(--border); border-radius: var(--radius-sm); font-size: 0.9rem; }
            .statistics-date-sep { color: var(--text-muted); }
            .btn-casostroj-reset { padding: 8px 14px; font-size: 0.85rem; border: 1px solid var(--border); background: var(--surface); border-radius: var(--radius-sm); cursor: pointer; }
            .btn-casostroj-reset:hover { background: var(--accent-soft); color: var(--text); }
            .statistics-export-table-wrap { margin-top: 24px; padding-top: 24px; border-top: 1px solid var(--border); }
            .statistics-subtitle { font-size: 1rem; font-weight: 600; margin: 0 0 12px; color: var(--text); }
            .statistics-export-table { overflow-x: auto; max-height: 320px; overflow-y: auto; }
            .statistics-export-table-inner { width: 100%; border-collapse: collapse; font-size: 0.875rem; }
            .statistics-export-table-inner th, .statistics-export-table-inner td { padding: 8px 12px; text-align: left; border-bottom: 1px solid var(--border); }
            .statistics-export-table-inner th { background: var(--accent-soft); color: var(--text); font-weight: 600; }
            .statistics-export-more { font-size: 0.8rem; color: var(--text-muted); margin-top: 8px; }
            .pracovna-section { padding: 24px 0; max-width: 720px; }
            .pracovna-title { font-size: 1.25rem; font-weight: 600; margin: 0 0 12px; color: var(--text); }
            .pracovna-intro { font-size: 1rem; color: var(--text-secondary); line-height: 1.5; margin: 0 0 24px; }
            .pracovna-cards { display: flex; flex-direction: column; gap: 20px; }
            .pracovna-card { padding: 20px; background: var(--surface-elevated); border: 1px solid var(--border); border-radius: var(--radius); }
            .pracovna-card h3 { font-size: 1.05rem; margin: 0 0 10px; color: var(--text); }
            .pracovna-card p { font-size: 0.9rem; color: var(--text-secondary); margin: 0 0 14px; line-height: 1.45; }
            .pracovna-card .btn-ai-presentation,
            .pracovna-card .btn-voice-briefing { padding: 10px 18px; font-size: 0.9rem; background: var(--btn-primary); color: #FFFFFF !important; border: none; border-radius: var(--radius-sm); cursor: pointer; font-weight: 500; }
            .pracovna-card .btn-ai-presentation:hover,
            .pracovna-card .btn-voice-briefing:hover { filter: brightness(1.08); }
            .pracovna-label { display: block; font-size: 0.9rem; font-weight: 600; margin-bottom: 6px; color: var(--text); }
            .pracovna-select { width: 100%; max-width: 360px; padding: 10px 12px; border: 1px solid var(--border); border-radius: var(--radius-sm); font-size: 0.9rem; background: var(--surface); }
            .pracovna-output .ai-presentation-heading { font-size: 0.95rem; margin: 12px 0 6px; color: var(--text); }
            .pracovna-output .ai-presentation-heading:first-child { margin-top: 0; }
            .children-library-lock-badge {
                display: none;
                align-items: center;
                gap: 8px;
                padding: 10px 16px;
                margin-bottom: 20px;
                background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
                border: 1px solid #d97706;
                border-radius: var(--radius);
                font-size: 0.9rem;
                font-weight: 600;
                color: #92400e;
            }
            .record-loan-qr-row { margin-top: 16px; padding-top: 12px; border-top: 1px solid var(--border); }
            .btn-qr-shelf { padding: 10px 18px; font-size: 0.9rem; border: 1px solid var(--btn-primary); background: transparent; color: var(--text); border-radius: var(--radius-sm); font-weight: 600; cursor: pointer; }
            .btn-qr-shelf:hover { background: var(--btn-primary); color: #fff; }
            .statistics-cards {
                display: grid;
                grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
                gap: 12px;
                margin-bottom: 24px;
            }
            .statistics-card {
                background: var(--surface-elevated);
                border: 1px solid var(--border);
                border-radius: var(--radius);
                padding: 16px;
                text-align: center;
            }
            .statistics-card-value {
                font-size: 1.5rem;
                font-weight: 700;
                color: var(--text);
            }
            .statistics-card-label {
                font-size: 0.8rem;
                color: var(--text-muted);
                margin-top: 4px;
            }
            .statistics-loans {
                margin-bottom: 24px;
                padding: 16px 20px;
                /* limetkový vzhled (podle screenu) */
                background: linear-gradient(135deg, rgba(141, 211, 17, 0.14) 0%, rgba(141, 211, 17, 0.06) 100%);
                border: 1px solid rgba(141, 211, 17, 0.35);
                border-radius: var(--radius);
            }
            .statistics-loans-title {
                font-size: 0.9rem;
                font-weight: 600;
                margin: 0 0 12px;
                color: var(--text);
            }
            .statistics-loans-bar-wrap {
                height: 12px;
                background: rgba(255,255,255,0.6);
                border-radius: 6px;
                overflow: hidden;
                margin-bottom: 8px;
            }
            .statistics-loans-bar {
                height: 100%;
                background: var(--btn-primary);
                border-radius: 6px;
                transition: width 0.3s;
            }
            .statistics-loans-text {
                font-size: 0.85rem;
                color: var(--text-secondary);
            }
            .statistics-rooms-title {
                font-size: 0.95rem;
                font-weight: 600;
                margin: 0 0 12px;
                color: var(--text);
            }

            /* Statistiky – akordeon filtrů */
            .statistics-filter-accordion {
                margin: 0 0 18px;
                background: var(--surface-elevated);
                border: 1px solid var(--border);
                border-radius: var(--radius);
                overflow: hidden;
            }
            .statistics-filter-toggle {
                width: 100%;
                display: flex;
                align-items: center;
                justify-content: space-between;
                gap: 12px;
                padding: 14px 18px;
                border: none;
                background: transparent;
                font: inherit;
                font-weight: 700;
                cursor: pointer;
                color: var(--text);
            }
            .statistics-filter-toggle:hover { background: rgba(0,0,0,0.03); }
            .statistics-filter-chevron { color: var(--text-muted); font-size: 0.9rem; }
            .statistics-filter-body {
                padding: 14px 18px 16px;
                border-top: 1px solid var(--border-soft);
                background: rgba(255,255,255,0.6);
            }
            .statistics-filter-row {
                display: flex;
                gap: 10px;
                flex-wrap: wrap;
                align-items: center;
            }
            .statistics-filter-label {
                font-size: 0.9rem;
                font-weight: 600;
                color: var(--text);
                margin-right: 6px;
            }
            .statistics-filter-select {
                padding: 10px 12px;
                border: 1px solid var(--border);
                border-radius: var(--radius-sm);
                background: var(--surface);
                color: var(--text);
                font-size: 0.9rem;
                min-width: 180px;
                font-family: inherit;
            }
            .statistics-filter-select:disabled { opacity: 0.6; cursor: not-allowed; }
            .statistics-filter-hint {
                margin-top: 10px;
                font-size: 0.82rem;
                color: var(--text-muted);
            }

            .statistics-filter-actions {
                display: inline-flex;
                align-items: center;
                gap: 8px;
                margin-left: auto;
            }
            .btn-stat-filter {
                padding: 10px 14px;
                font-size: 0.85rem;
                font-weight: 700;
                border-radius: 12px;
                border: 1px solid var(--border);
                background: var(--surface);
                color: var(--text);
                cursor: pointer;
                transition: background 0.15s ease, transform 0.15s ease, opacity 0.15s ease;
                font-family: inherit;
                white-space: nowrap;
            }
            .btn-stat-filter:hover { background: var(--accent-soft); transform: translateY(-1px); }
            .btn-stat-filter:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }
            .btn-stat-filter--apply {
                border-color: rgba(141, 211, 17, 0.55);
                background: rgba(141, 211, 17, 0.16);
            }
            .btn-stat-filter--apply:hover { background: rgba(141, 211, 17, 0.24); }

            .statistics-export-actions {
                display: flex;
                gap: 10px;
                margin-top: 14px;
                flex-wrap: wrap;
            }
            .statistics-rooms-list {
                display: flex;
                flex-direction: column;
                gap: 10px;
            }
            .statistics-room-row {
                display: flex;
                align-items: center;
            }
            .statistics-room-clickable {
                cursor: pointer;
            }
            .statistics-room-clickable:hover {
                background: var(--accent-soft);
                border-radius: 6px;
            }
            .statistics-room-name {
                font-size: 0.9rem;
                min-width: 100px;
                color: var(--text);
            }
            .statistics-room-bar-wrap {
                flex: 1;
                height: 10px;
                background: var(--surface);
                border-radius: 5px;
                overflow: hidden;
                border: 1px solid var(--border);
            }
            .statistics-room-bar {
                height: 100%;
                background: var(--btn-primary);
                border-radius: 4px;
                transition: width 0.3s;
            }
            .statistics-room-count {
                font-size: 0.85rem;
                font-weight: 600;
                color: var(--text);
                min-width: 70px;
                text-align: right;
            }

            .mood-bar-top .mood-btn {
            padding: 8px 14px;
            font-size: 0.8125rem;
        }

        .mood-bar-top .mood-custom-search-row {
            flex: 1 1 100%;
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 8px;
            padding-top: 12px;
            border-top: 1px solid var(--border-soft);
        }

        .mood-bar-top .mood-custom-search-input {
            flex: 1;
            min-width: 0;
            padding: 8px 12px;
            font-size: 0.875rem;
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            background: var(--surface);
            color: var(--text);
            font-family: inherit;
        }

        .mood-bar-top .mood-custom-search-input::placeholder {
            color: var(--text-muted);
        }

        .mood-bar-top .mood-custom-search-input:focus {
            outline: none;
            border-color: var(--text);
        }

        .mood-bar-top .mood-custom-search-btn {
            padding: 8px 16px;
            font-size: 0.8125rem;
            border-radius: var(--radius-sm);
            border: 1px solid var(--btn-primary);
            background: var(--accent-soft);
            color: var(--text);
            cursor: pointer;
            font-family: inherit;
            white-space: nowrap;
        }

        .mood-bar-top .mood-custom-search-btn:hover {
            background: var(--btn-primary);
            color: white;
        }

        .mood-bar-top .mood-tip-box {
            flex: 1 1 100%;
            margin-top: 0;
            margin-left: 0;
        }

        .mood-tip-box .mood-tip-card-wrap {
            margin-top: 16px;
            max-width: 200px;
        }

        .mood-tip-box .mood-tip-card-wrap .item-card {
            padding: 12px;
        }

        .mood-tip-box .mood-tip-card-wrap .item-card-title {
            font-size: 0.875rem;
        }

        .mood-tip-box .mood-tip-card-wrap .item-card-meta {
            font-size: 0.75rem;
        }

        .library-accordion-wrap {
            border: 1px solid var(--border-soft);
            border-radius: var(--radius);
            overflow: hidden;
            background: var(--surface);
            margin-bottom: 32px;
        }

        .library-accordion-header {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 14px 18px;
            background: var(--surface-elevated);
            cursor: pointer;
            user-select: none;
            flex-wrap: wrap;
        }

        .library-accordion-header:hover {
            background: var(--accent-soft);
        }

        .library-accordion-header .results-title {
            margin: 0;
            flex: 1;
        }

        .library-accordion-actions {
            display: flex;
            align-items: center;
            gap: 12px;
            flex-wrap: wrap;
        }

        .library-accordion-content {
            padding: 20px;
            border-top: 1px solid var(--border-soft);
        }

        .library-accordion-wrap.collapsed .library-accordion-content {
            display: none;
        }

        .library-accordion-wrap .library-toggle .chevron {
            width: 18px;
            height: 18px;
            transition: transform 0.2s;
        }

        .library-accordion-wrap.collapsed .library-toggle .chevron {
            transform: rotate(-90deg);
        }

        .mood-selector-wrap {
            margin-bottom: 24px;
            padding: 20px;
            background: var(--surface-elevated);
            border: 1px solid var(--border);
            border-radius: var(--radius);
        }

        .mood-question {
            font-size: 0.95rem;
            font-weight: 600;
            color: var(--text);
            margin-bottom: 12px;
        }

        .mood-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .mood-btn {
            padding: 10px 18px;
            font-size: 0.875rem;
            border-radius: var(--radius-sm);
            border: 1px solid var(--border);
            background: var(--surface);
            cursor: pointer;
            font-family: inherit;
            transition: all 0.2s;
        }

        .mood-btn:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow);
        }

        .mood-btn.mood-adventure { border-color: #0ea5e9; color: #0369a1; }
        .mood-btn.mood-adventure:hover { background: #e0f2fe; }
        .mood-btn.mood-melancholy { border-color: #64748b; color: #475569; }
        .mood-btn.mood-melancholy:hover { background: #f1f5f9; }
        .mood-btn.mood-encouragement { border-color: #f59e0b; color: #b45309; }
        .mood-btn.mood-encouragement:hover { background: #fffbeb; }
        .mood-btn.mood-mystery { border-color: #64748b; color: #334155; }
        .mood-btn.mood-mystery:hover { background: #f1f5f9; }

        .mood-tip-box {
            margin-top: 16px;
            padding: 20px;
            border-radius: var(--radius);
            font-size: 0.95rem;
            line-height: 1.6;
        }

        .mood-tip-box.mood-adventure {
            background: linear-gradient(135deg, #e0f2fe 0%, #bae6fd 100%);
            border: 1px solid #7dd3fc;
        }

        .mood-tip-box.mood-melancholy {
            background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
            border: 1px solid #cbd5e1;
        }

        .mood-tip-box.mood-encouragement {
            background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);
            border: 1px solid #fcd34d;
        }

        .mood-tip-box.mood-mystery {
            background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
            border: 1px solid #94a3b8;
        }

        .mood-tip-box .mood-tip-title {
            font-weight: 700;
            margin-bottom: 8px;
        }

        .shelf-group {
            margin-bottom: 24px;
            border: 1px solid var(--border-soft);
            border-radius: 12px;
            overflow: hidden;
            background: var(--surface);
            box-shadow: var(--shadow);
        }
        .shelf-group--virtual-borrowed-by-me .shelf-group-header.shelf-bar {
            background: rgba(59, 130, 246, 0.08);
            border-color: rgba(59, 130, 246, 0.35);
        }
        .shelf-group--virtual-borrowed-by-me .shelf-group-header.shelf-bar:hover {
            background: rgba(59, 130, 246, 0.14);
        }
        .shelf-group--virtual-lent .shelf-group-header.shelf-bar {
            background: rgba(245, 158, 11, 0.08);
            border-color: rgba(245, 158, 11, 0.35);
        }
        .shelf-group--virtual-lent .shelf-group-header.shelf-bar:hover {
            background: rgba(245, 158, 11, 0.14);
        }

        /* Šedá horní lišta police se zaoblenými rohy (vzor 20.25.41) */
        .shelf-group-header.shelf-bar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 10px 16px;
            padding: 12px 18px;
            background: #e5e7eb;
            border-bottom: 1px solid rgba(0,0,0,0.08);
            cursor: pointer;
            transition: background 0.15s;
            user-select: none;
            border-radius: 12px 12px 0 0;
            position: relative;
        }
        .shelf-group-header.shelf-bar:hover {
            background: #d1d5db;
        }
        .shelf-bar-left {
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        .shelf-bar-left .shelf-group-icon {
            color: var(--text);
        }
        .shelf-bar-actions {
            display: flex;
            align-items: center;
            gap: 8px;
            flex-wrap: wrap;
            margin-left: auto;
        }
                .shelf-bar-actions .btn-shelf-qr,
        .shelf-bar-actions .btn-shelf-privacy,
        .shelf-bar-actions .btn-shelf-visibility,
        .shelf-bar-actions .btn-shelf-favorites,
        .shelf-bar-actions .btn-shelf-public,
        .shelf-bar-actions .btn-shelf-delete {
            padding: 6px 12px;
            font-size: 0.8125rem;
            font-weight: 500;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            font-family: inherit;
            transition: background 0.15s, color 0.15s;
        }
        .shelf-bar-actions .btn-shelf-qr {
            background: var(--surface);
            color: var(--text);
            border: 1px solid var(--border);
        }
        .shelf-bar-actions .btn-shelf-qr:hover {
            background: var(--surface-elevated);
        }
        .shelf-bar-actions .btn-shelf-privacy {
            background: transparent;
            color: var(--text-muted);
            border: 1px solid var(--border);
        }
        .shelf-bar-actions .btn-shelf-privacy:hover {
            background: var(--surface);
            color: var(--text);
        }
        .shelf-bar-actions .btn-shelf-privacy.is-public {
            color: #007aff;
            border-color: rgba(0, 122, 255, 0.4);
        }
        .shelf-bar-actions .btn-shelf-privacy.is-public:hover {
            background: rgba(0, 122, 255, 0.08);
            color: #007aff;
        }
        .shelf-bar-actions .btn-shelf-privacy .btn-shelf-privacy-icon {
            margin-right: 4px;
        }
        .shelf-bar-actions .btn-shelf-visibility {
            padding: 6px 12px;
            font-size: 0.8125rem;
            font-weight: 500;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            background: transparent;
            color: var(--text-muted);
            border: 1px solid var(--border);
        }
        .shelf-bar-actions .btn-shelf-visibility:hover {
            background: var(--surface);
            color: var(--text);
        }
        .shelf-bar-actions .btn-shelf-visibility .btn-shelf-visibility-icon {
            margin-right: 4px;
        }
        .shelf-bar-actions .btn-shelf-visibility--family {
            color: var(--accent-lime);
            border-color: rgba(141, 211, 17, 0.5);
        }
        .shelf-bar-actions .btn-shelf-visibility--family:hover {
            background: var(--accent-soft);
            color: var(--accent-lime);
        }
        .shelf-bar-actions .btn-shelf-visibility--public {
            color: var(--accent-lime);
            border-color: rgba(141, 211, 17, 0.5);
        }
        .shelf-bar-actions .btn-shelf-visibility--public:hover {
            background: var(--accent-soft);
            color: var(--accent-lime);
        }
        .shelf-bar-actions .btn-shelf-visibility--all {
            color: var(--text);
            border-color: var(--border);
        }
        .shelf-bar-actions .btn-shelf-visibility--all:hover {
            background: var(--surface);
            color: var(--text);
        }
        .shelf-bar-actions .btn-shelf-favorites {
            background: transparent;
            color: var(--text);
            border: 1px solid var(--border);
        }
        .shelf-bar-actions .btn-shelf-favorites:hover {
            background: var(--surface);
            color: var(--text);
        }
        .shelf-bar-actions .btn-shelf-favorites.is-active {
            color: #c62828;
            border-color: rgba(198, 40, 40, 0.4);
        }
        .shelf-bar-actions .btn-shelf-favorites.is-active:hover {
            background: rgba(198, 40, 40, 0.08);
        }
        .shelf-bar-actions .btn-shelf-favorites .btn-shelf-favorites-icon {
            margin-right: 4px;
        }
        .shelf-sort-select {
            padding: 6px 10px;
            font-size: 0.8125rem;
            border-radius: 8px;
            border: 1px solid var(--border);
            background: var(--surface);
            color: var(--text);
            cursor: pointer;
            font-family: inherit;
        }
        .shelf-sort-select:hover {
            border-color: var(--text-muted);
        }
        .shelf-bar-actions .btn-shelf-public {
            background: transparent;
            color: #2563eb;
            border: 1px solid rgba(37, 99, 235, 0.4);
        }
        .shelf-bar-actions .btn-shelf-public:hover {
            background: rgba(37, 99, 235, 0.1);
        }
        .shelf-bar-actions .btn-shelf-public svg {
            width: 14px;
            height: 14px;
            vertical-align: middle;
            margin-right: 4px;
        }
        .shelf-bar-actions .btn-shelf-delete {
            background: #fef2f2;
            color: #dc2626;
            border: 1px solid #fecaca;
        }
        .shelf-bar-actions .btn-shelf-delete:hover {
            background: #fee2e2;
            color: #b91c1c;
        }
        .shelf-bar-toggle {
            padding: 6px 12px;
            font-size: 0.8125rem;
            font-weight: 500;
            color: var(--text);
            background: transparent;
            border: 1px solid var(--border);
            border-radius: 8px;
            cursor: pointer;
            font-family: inherit;
        }
        .shelf-group.collapsed .shelf-bar-toggle {
            background: rgba(141, 211, 17, 0.10);
            border-color: rgba(141, 211, 17, 0.35);
        }
        .shelf-bar-toggle:hover {
            background: rgba(255,255,255,0.6);
        }

        .shelf-group-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 12px;
            padding: 14px 18px;
            background: var(--surface-elevated);
            border-bottom: 1px solid var(--border-soft);
            cursor: pointer;
            transition: background 0.15s;
            user-select: none;
        }

        .shelf-group-header:hover {
            background: var(--accent-soft);
        }

        .shelf-group-header.collapsed {
            border-bottom: none;
        }

        .shelf-group-name {
            font-size: 1rem;
            font-weight: 600;
            color: var(--text);
            cursor: pointer;
        }

        .shelf-group-count {
            font-size: 0.8rem;
            color: var(--text-muted);
            margin-left: 8px;
        }
        .shelf-group-icon {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 22px;
            height: 22px;
            flex-shrink: 0;
            color: var(--text);
        }
        .shelf-group-icon svg {
            width: 18px;
            height: 18px;
        }
        .shelf-icon-picker-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 24px;
            height: 24px;
            padding: 0;
            border: 1px solid var(--border);
            border-radius: 4px;
            background: var(--surface);
            color: var(--text);
            cursor: pointer;
            flex-shrink: 0;
        }
        .shelf-icon-picker-btn:hover {
            background: var(--accent-soft);
            border-color: var(--text);
        }
        .shelf-icon-picker-btn svg {
            width: 16px;
            height: 16px;
        }
        .shelf-icon-picker-popover {
            position: fixed !important;
        }
        .shelf-icon-picker-option {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 32px;
            height: 32px;
            padding: 0;
            border: none;
            border-radius: 6px;
            background: transparent;
            color: var(--text-muted);
            cursor: pointer;
        }
        .shelf-icon-picker-option:hover,
        .shelf-icon-picker-option.active {
            background: var(--accent-soft);
            color: var(--text);
        }
        .shelf-icon-picker-option svg {
            width: 18px;
            height: 18px;
        }

        .shelf-group-name-wrap {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 4px 8px;
            margin: -4px -8px;
            border-radius: var(--radius-sm);
            cursor: pointer;
            transition: background 0.15s;
        }
        .shelf-group-name-wrap:hover {
            background: rgba(79, 70, 229, 0.08);
        }
        .shelf-group-name-wrap.editing {
            background: var(--accent-soft);
            padding: 2px 6px;
        }
        .shelf-group-name-wrap input.shelf-name-edit {
            font-size: 1rem;
            font-weight: 600;
            color: var(--text);
            border: 1px solid var(--btn-primary);
            border-radius: 4px;
            padding: 4px 8px;
            min-width: 120px;
            background: var(--surface);
        }
        .shelf-group-name-wrap input.shelf-name-edit:focus {
            outline: none;
            box-shadow: 0 0 0 2px var(--accent-soft);
        }
        .shelf-name-edit-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 20px;
            height: 20px;
            padding: 0;
            border: none;
            background: transparent;
            color: var(--text-muted);
            cursor: pointer;
            border-radius: 4px;
            flex-shrink: 0;
        }
        .shelf-name-edit-btn:hover {
            color: var(--text);
            background: var(--accent-soft);
        }
        .shelf-name-edit-btn svg {
            width: 14px;
            height: 14px;
        }
        .settings-modal .wishlist-modal-content {
            max-height: calc(100vh - 32px);
            display: flex;
            flex-direction: column;
            width: 100%;
            max-width: none;
            padding: 0;
            overflow: hidden;
        }
        .add-item-modal .wishlist-modal-content {
            max-height: 85vh;
            display: flex;
            flex-direction: column;
            width: 90%;
            max-width: 440px;
            padding: 0;
            overflow: hidden;
        }
        .add-item-modal .wishlist-modal-content h3 {
            flex-shrink: 0;
            padding: 20px 24px 12px;
            margin: 0;
            border-bottom: 1px solid var(--border);
        }
        .add-item-modal-body {
            flex: 1;
            min-height: 0;
            overflow-y: auto;
            padding: 16px 24px;
        }
        .add-item-modal .wishlist-modal-actions {
            flex-shrink: 0;
            margin-top: 0;
            padding: 16px 24px 20px;
            border-top: 1px solid var(--border);
            background: var(--surface);
        }
        .settings-modal .wishlist-modal-content h3 {
            flex-shrink: 0;
            padding: 20px 24px 12px;
            margin: 0;
            border-bottom: 1px solid var(--border);
        }
        .settings-current-tier {
            flex-shrink: 0;
            margin: 0 24px 12px;
            padding: 0;
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--text-muted);
        }
        .settings-family-lock-hint {
            font-size: 0.8rem;
            color: var(--text-muted);
            margin: 0 0 10px;
            padding: 8px 0 0;
        }
        .settings-family-lock-hint span { margin-right: 4px; }
        .settings-modal-body {
            flex: 1;
            min-height: 0;
            overflow-y: auto;
            padding: 0 24px 16px;
        }
        .settings-modal-footer {
            flex-shrink: 0;
            margin-top: 0;
            padding: 16px 24px 20px;
            border-top: 1px solid var(--border);
            background: var(--surface);
        }
        .settings-section {
            margin: 0;
            padding: 16px 0;
            border-bottom: 1px solid var(--border);
            background: var(--surface);
        }
        .settings-section:nth-child(even) {
            background: var(--surface-elevated, rgba(0,0,0,0.02));
        }
        .settings-section:last-child {
            border-bottom: none;
        }
        .settings-section-title { font-size: 0.85rem; font-weight: 600; color: var(--text-muted); margin: 0 0 12px; }
        .settings-label { display: block; font-size: 0.8rem; color: var(--text-muted); margin-bottom: 4px; }
        .btn-delete-library-settings {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 10px 16px;
            font-size: 0.9rem;
            font-weight: 500;
            border-radius: var(--radius-sm);
            border: 1px solid var(--error);
            background: var(--error-soft, #fee2e2);
            color: var(--error, #991b1b);
            cursor: pointer;
        }
        .btn-delete-library-settings:hover {
            background: var(--error, #dc2626);
            color: white;
            border-color: var(--error, #dc2626);
        }

        .shelf-toggle {
            background: none;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            padding: 6px 10px;
            border-radius: var(--radius-sm);
            font-size: 0.8rem;
            font-weight: 500;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            transition: color 0.15s;
        }

        .shelf-toggle:hover {
            color: var(--text);
        }

        .shelf-toggle svg {
            width: 16px;
            height: 16px;
            transition: transform 0.2s;
        }

        .shelf-group-header.collapsed .shelf-toggle svg {
            transform: rotate(-90deg);
        }

        .shelf-visibility-toggle {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 4px 10px;
            border-radius: var(--radius-sm);
            border: 1px solid var(--border);
            background: var(--surface-elevated);
            font-size: 0.75rem;
            font-weight: 500;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.15s;
        }

        .shelf-visibility-toggle:hover {
            border-color: var(--text);
            color: var(--text);
        }

        .shelf-visibility-toggle.public {
            background: var(--accent-soft);
            border-color: var(--text);
            color: var(--text);
        }

        .shelf-qr-btn {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 4px 10px;
            border-radius: var(--radius-sm);
            border: 1px solid var(--border);
            background: var(--surface-elevated);
            font-size: 0.75rem;
            font-weight: 500;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.15s;
        }
        .shelf-qr-btn:hover {
            border-color: var(--text);
            color: var(--text);
        }

        .shelf-group-books {
            padding: 20px;
        }
        .shelf-group.collapsed .shelf-group-books {
            display: none;
        }

        /* Zbalené police: skrýt akce, ale ponechat toggle (aby šla rozbalit) */
        .shelf-group.collapsed .shelf-bar-actions {
            display: none;
        }

        /* Tooltip/indikátor na hover u sbalené police */
        .shelf-group-hover-tip {
            position: absolute;
            right: 16px;
            top: calc(100% + 8px);
            padding: 8px 10px;
            background: #fff;
            border: 1px solid rgba(0, 0, 0, 0.18);
            border-radius: 10px;
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.12);
            font-size: 0.8125rem;
            color: #111;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-4px);
            transition: opacity 0.15s, transform 0.15s, visibility 0.15s;
            z-index: 50;
            pointer-events: none;
            max-width: 320px;
            white-space: nowrap;
        }
        .shelf-group.collapsed:hover .shelf-group-hover-tip {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        @media (max-width: 640px) {
            .manual-add-form .form-row,
            .manual-add-form .form-row-three,
            .manual-add-form .form-row-four,
            .manual-add-form .form-row-five {
                grid-template-columns: 1fr;
            }
        }

        .scan-group {
            margin-bottom: 40px;
        }

        .scan-group:last-child {
            margin-bottom: 0;
        }

        .scan-group-label {
            font-size: 0.75rem;
            font-weight: 500;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.06em;
            margin-bottom: 16px;
        }

        .empty-state {
            text-align: center;
            padding: 56px 36px;
            color: var(--text-muted);
            font-size: 0.9375rem;
            background: var(--surface);
            border: 1px solid var(--border-soft);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
        }

        .empty-state-icon {
            font-size: 2.25rem;
            margin-bottom: 14px;
            opacity: 0.5;
        }

        /* Půjčil/a jsem – obsah vždy viditelný */
        #scanHistorySection.view-borrowed .scan-history-content-wrap {
            display: block !important;
            min-height: 200px;
        }
        .pujceno-container { padding: 24px 0; }
        .pujceno-container .borrowed-card { margin-bottom: 24px; padding: 20px; background: #fff; border-radius: 12px; border: 1px solid var(--border); }
        .pujceno-container .card-content { display: flex; gap: 20px; flex-wrap: wrap; }
        .pujceno-container .book-cover { width: 80px; height: 120px; object-fit: cover; border-radius: 8px; }
        .pujceno-container .book-cover-placeholder { width: 80px; height: 120px; background: var(--border-soft); border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 0.75rem; color: var(--text-muted); text-align: center; padding: 8px; }
        .pujceno-container .book-info { flex: 1; min-width: 200px; }
        .pujceno-container .book-info h4 { margin: 0 0 8px 0; font-size: 1rem; }
        .pujceno-container .loan-details { margin-top: 12px; font-size: 0.9rem; color: var(--text-secondary); }
        .pujceno-container .book-chat-section { margin-top: 16px; padding-top: 16px; border-top: 1px solid var(--border-soft); font-size: 0.85rem; color: var(--text-muted); }

        .borrowed-by-me-panel { margin-bottom: 18px; padding: 14px 16px; background: var(--surface-elevated); border: 1px solid var(--border); border-radius: var(--radius); }
        .borrowed-by-me-form-title { margin: 0 0 14px 0; font-size: 0.95rem; font-weight: 800; color: var(--text); }
        .borrowed-by-me-form-row { margin-bottom: 16px; }
        .borrowed-by-me-form-row label { display: block; font-size: 0.75rem; font-weight: 500; color: var(--text-muted); margin-bottom: 6px; }
        .borrowed-by-me-form-row input { width: 100%; padding: 10px 12px; border: 1px solid var(--border); border-radius: var(--radius-sm); font-size: 0.9375rem; }
        .borrowed-by-me-toggle-label { display: flex; align-items: center; gap: 8px; cursor: pointer; font-size: 0.875rem; }
        .borrowed-by-me-toggle-label input[type="checkbox"] { width: auto; }
        .borrowed-by-me-form-actions { display: flex; gap: 12px; flex-wrap: wrap; margin-top: 20px; }
        .btn-scan-borrowed { padding: 12px 20px; background: var(--accent); color: #000; border: 1px solid #000; border-radius: var(--radius-sm); font-weight: 700; cursor: pointer; font-family: inherit; }
        .btn-add-borrowed { padding: 12px 20px; background: transparent; color: var(--text); border: 1px solid var(--border); border-radius: var(--radius-sm); cursor: pointer; font-family: inherit; }
        .borrowed-by-me-container { padding: 24px 0; }

        /* Mám vypůjčeno: kompaktní rozbalovací panel */
        .borrowed-by-me-status-bar{
            display:flex;
            align-items:center;
            gap:10px;
        }
        .borrowed-by-me-status-text{
            font-size:0.9rem;
            font-weight:700;
            color:var(--text);
            flex:1;
            min-width:0;
        }
        .borrowed-by-me-open-btn{
            padding:8px 14px;
            font-size:0.85rem;
            font-weight:800;
            border-radius:999px;
            border:1px solid rgba(141, 211, 17, 0.55);
            background:rgba(141, 211, 17, 0.14);
            cursor:pointer;
            font-family:inherit;
            white-space:nowrap;
        }
        .borrowed-by-me-open-btn:hover{ background:rgba(141, 211, 17, 0.22); }
        .borrowed-by-me-close-btn{
            width:34px;
            height:34px;
            border-radius:10px;
            border:1px solid var(--border);
            background:transparent;
            cursor:pointer;
            font-size:1.15rem;
            line-height:1;
        }
        .borrowed-by-me-close-btn:hover{ background:rgba(0,0,0,0.04); }
        .borrowed-by-me-body{
            margin-top:12px;
            padding-top:12px;
            border-top:1px solid var(--border-soft);
        }
        /* Polička vedle – vizuální odlišení „knih na návštěvě“ (Mám vypůjčeno) */
        .borrowed-shelf {
            background: linear-gradient(135deg, rgba(139, 90, 43, 0.06) 0%, rgba(210, 180, 140, 0.08) 50%, rgba(139, 90, 43, 0.05) 100%);
            border: 1px solid rgba(139, 90, 43, 0.2);
            border-radius: 12px;
            padding: 20px 24px 24px;
            box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.4), 0 2px 8px rgba(0, 0, 0, 0.06);
        }
        .borrowed-by-me-container .borrowed-by-me-card { margin-bottom: 24px; padding: 20px; background: #fff; border-radius: 12px; border: 1px solid var(--border); }
        .borrowed-by-me-container .card-content { display: flex; gap: 20px; flex-wrap: wrap; }
        .borrowed-by-me-container .book-cover { width: 80px; height: 120px; object-fit: cover; border-radius: 8px; }
        .borrowed-by-me-container .book-cover-placeholder { width: 80px; height: 120px; background: var(--border-soft); border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 0.75rem; color: var(--text-muted); }
        .borrowed-by-me-container .book-info { flex: 1; min-width: 200px; }
        .borrowed-by-me-container .book-info h4 { margin: 0 0 8px 0; font-size: 1rem; }
        .borrowed-by-me-container .loan-details { margin-top: 12px; font-size: 0.9rem; color: var(--text-secondary); }
        .borrowed-by-me-container .btn-return-borrowed,
        .book-card-return-btn {
            margin-top: 12px;
            padding: 8px 16px;
            background: #34c759;
            color: #fff;
            border: 1px solid #30b04f;
            border-radius: var(--radius-sm);
            font-weight: 600;
            cursor: pointer;
            font-family: inherit;
            font-size: 0.875rem;
            transition: background 0.2s, transform 0.1s;
        }
        .book-card-return-btn:hover {
            background: #30b04f;
            transform: translateY(-1px);
        }
        .book-card-return-btn:active {
            transform: translateY(0);
        }

        /* Polička vedle – vizuální kontejner v sekci Mám vypůjčeno (synchronizovaná s hlavní knihovnou) */
        .scan-history-content-wrap.policka-vedle-active {
            background: linear-gradient(180deg, rgba(0, 0, 0, 0.02) 0%, transparent 12px);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 20px 24px 24px;
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.04);
        }
        .policka-vedle-title {
            margin: 0 0 16px 0;
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--text);
            padding-bottom: 12px;
            border-bottom: 2px solid var(--border);
            display: block;
        }
        #scanHistorySection.view-borrowed-by-me .policka-vedle-title {
            margin-top: 0;
        }
        /* Mřížka v sekci Mám vypůjčeno – jiný odstín, aby vypadala jako „polička na návštěvě“ */
        .scan-history-content-wrap.borrowed-shelf-view {
            background: linear-gradient(180deg, rgba(139, 90, 43, 0.04) 0%, rgba(210, 180, 140, 0.06) 30%, rgba(255, 255, 255, 0.5) 100%);
            border-radius: 12px;
            padding: 16px;
        }

        /* Půjčila jsem – prázdný stav uprostřed, elegantní písmo, ikonka domečku */
        #scanHistorySection.view-borrowed .empty-state {
            min-height: 50vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 64px 48px;
            color: var(--text-muted);
            font-size: 1.0625rem;
            font-family: Georgia, 'Times New Roman', serif;
            line-height: 1.7;
        }
        #scanHistorySection.view-borrowed .empty-state p {
            margin: 0;
            font-weight: 400;
            opacity: 0.9;
            max-width: 420px;
        }
        #scanHistorySection.view-borrowed .empty-state .empty-state-icon {
            font-size: 2.5rem;
            margin-bottom: 18px;
            opacity: 0.75;
        }

        /* Horní panel Půjčil/a jsem – vyhledávač + formulář (limetka, bílá, černá) */
        .borrowed-top-panel {
            margin-bottom: 1.5rem;
            padding: 1.25rem 1.5rem;
            background: rgba(209, 255, 82, 0.08);
            border: 1px solid rgba(0, 0, 0, 0.12);
            border-radius: 1rem;
        }
        .borrowed-panel-inner {
            max-width: 480px;
        }
        .borrowed-panel-label {
            display: block;
            font-size: 0.875rem;
            font-weight: 600;
            color: #000;
            margin-bottom: 8px;
        }
        .borrowed-search-input {
            width: 100%;
            padding: 12px 14px;
            border: 1px solid #000;
            border-radius: 10px;
            font-size: 0.9375rem;
            font-family: inherit;
            color: #000;
            background: #fff;
        }
        .borrowed-search-input::placeholder {
            color: var(--text-muted);
        }
        .borrowed-search-input:focus {
            outline: none;
            box-shadow: 0 0 0 2px rgba(209, 255, 82, 0.2);
        }
        .borrowed-search-results {
            margin-top: 8px;
            border: 1px solid rgba(0, 0, 0, 0.12);
            border-radius: 10px;
            background: #fff;
            overflow: hidden;
            max-height: 240px;
            overflow-y: auto;
        }
        .borrowed-search-result-item {
            display: block;
            width: 100%;
            padding: 10px 14px;
            border: none;
            border-bottom: 1px solid rgba(0, 0, 0, 0.06);
            background: none;
            font-size: 0.875rem;
            text-align: left;
            color: #000;
            font-family: inherit;
            cursor: pointer;
            transition: background 0.15s;
        }
        .borrowed-search-result-item:last-child {
            border-bottom: none;
        }
        .borrowed-search-result-item:hover {
            background: rgba(209, 255, 82, 0.15);
        }
        .borrowed-lend-form {
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid rgba(0, 0, 0, 0.1);
        }
        .borrowed-form-row {
            margin-bottom: 12px;
        }
        .borrowed-form-row label {
            display: block;
            font-size: 0.875rem;
            font-weight: 600;
            color: #000;
            margin-bottom: 4px;
        }
        .borrowed-form-input {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #000;
            border-radius: 8px;
            font-size: 0.9375rem;
            font-family: inherit;
            color: #000;
            background: #fff;
        }
        .borrowed-form-input:focus {
            outline: none;
            box-shadow: 0 0 0 2px rgba(209, 255, 82, 0.18);
        }
        .borrowed-submit-btn {
            margin-top: 12px;
            padding: 10px 18px;
            border-radius: 10px;
            border: 1px solid #000;
            background: rgba(209, 255, 82, 0.2);
            color: #000;
            font-size: 0.9rem;
            font-weight: 600;
            font-family: inherit;
            cursor: pointer;
            transition: background 0.2s;
        }
        .borrowed-submit-btn:hover {
            background: rgba(209, 255, 82, 0.35);
        }

        .content-for-collection-placeholder {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 60vh;
            padding: 48px 24px;
        }
        .coming-soon-card {
            max-width: 480px;
            width: 100%;
            margin: 0 auto;
            padding: 48px 40px;
            text-align: center;
            background: #fff;
            border-radius: var(--radius);
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.06);
        }

        .coming-soon-card .coming-soon-text {
            font-size: 1.2rem;
            color: var(--text-primary);
            margin-bottom: 28px;
            line-height: 1.65;
        }

        .coming-soon-card .coming-soon-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            justify-content: center;
            align-items: center;
        }

        .btn-coming-soon-vote {
            padding: 12px 24px;
            font-size: 0.9rem;
            font-weight: 500;
            border-radius: var(--radius-sm);
            border: 1px solid var(--btn-primary);
            background: var(--accent-soft);
            color: var(--text);
            cursor: pointer;
            font-family: inherit;
            transition: all 0.2s;
        }

        .btn-coming-soon-vote:hover {
            background: var(--btn-primary);
            color: white;
            transform: scale(1.02);
        }

        .btn-coming-soon-ai {
            padding: 10px 20px;
            font-size: 0.85rem;
            font-weight: 500;
            border-radius: var(--radius-sm);
            border: 1px solid var(--border);
            background: var(--surface);
            color: var(--text-secondary);
            cursor: pointer;
            font-family: inherit;
            transition: all 0.2s;
        }

        .btn-coming-soon-ai:hover {
            border-color: var(--text);
            color: var(--text);
            transform: scale(1.02);
        }

        .visual-map-upload-wrap {
            max-width: 560px;
            margin: 0 auto;
            padding: 24px 16px;
        }
        .visual-map-intro {
            font-size: 1rem;
            color: var(--text-secondary);
            margin-bottom: 20px;
            line-height: 1.5;
        }
        .visual-map-upload-area {
            position: relative;
            border: 2px dashed var(--border);
            border-radius: var(--radius);
            padding: 48px 24px;
            text-align: center;
            background: var(--surface);
            transition: border-color 0.2s, background 0.2s;
        }
        .visual-map-upload-area:hover,
        .visual-map-upload-area.dragover {
            border-color: var(--text);
            background: var(--accent-soft);
        }
        .visual-map-upload-area input[type="file"] {
            position: absolute;
            inset: 0;
            opacity: 0;
            cursor: pointer;
            width: 100%;
            height: 100%;
        }
        .visual-map-upload-inner {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            pointer-events: none;
        }
        .visual-map-upload-icon { font-size: 2rem; }
        .visual-map-upload-text { font-weight: 500; color: var(--text-primary); }
        .visual-map-upload-hint { font-size: 0.85rem; color: var(--text-secondary); }
        .visual-map-status {
            margin-top: 20px;
            font-size: 0.95rem;
            color: var(--text);
            font-weight: 500;
            text-align: center;
        }
        .visual-map-previews {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 16px;
            justify-content: center;
        }
        .visual-map-previews img {
            width: 64px;
            height: 64px;
            object-fit: cover;
            border-radius: var(--radius-sm);
        }

        .ai-presentation-block {
            margin-top: 20px;
            padding-top: 16px;
            border-top: 1px solid var(--border);
        }
        .btn-ai-presentation,
        .btn-open-pracovna {
            width: 100%;
            padding: 10px 16px;
            font-size: 0.9rem;
            font-weight: 500;
            border-radius: var(--radius-sm);
            border: 1px solid var(--btn-primary);
            background: var(--accent-soft);
            color: #1a1a1a;
            cursor: pointer;
            font-family: inherit;
            transition: all 0.2s;
        }
        .btn-ai-presentation:hover,
        .btn-open-pracovna:hover {
            background: var(--btn-primary);
            color: white;
        }
        /* Tlačítko Přejít do Pracovny – vždy černý text na světle zeleném v Safari */
        .btn-edit-book-pracovna,
        .btn-open-pracovna {
            -webkit-appearance: none;
            appearance: none;
            color: #1a1a1a !important;
        }
        .btn-edit-book-pracovna:hover,
        .btn-open-pracovna:hover {
            color: white !important;
        }

        /* Modál Upravit knihu */
        .edit-book-modal-overlay {
            position: fixed;
            inset: 0;
            z-index: 9999;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            box-sizing: border-box;
        }
        .edit-book-modal-overlay.show {
            display: flex;
        }
        .edit-book-modal {
            background: var(--surface-elevated);
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            max-width: 480px;
            width: 100%;
            max-height: 90vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        .edit-book-modal-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px 20px;
            border-bottom: 1px solid var(--border);
        }
        .edit-book-modal-title {
            margin: 0;
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--text);
        }
        .edit-book-modal-close {
            width: 40px;
            height: 40px;
            padding: 0;
            border: none;
            background: transparent;
            font-size: 1.75rem;
            line-height: 1;
            color: #1a1a1a;
            cursor: pointer;
            border-radius: 8px;
        }
        .edit-book-modal-close:hover {
            background: rgba(0, 0, 0, 0.06);
            color: #000;
        }

        /* Modál: Co dělá chytré řazení? */
        .smart-sort-help-overlay {
            position: fixed;
            inset: 0;
            z-index: 9998;
            background: rgba(0, 0, 0, 0.45);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            box-sizing: border-box;
        }
        .smart-sort-help-modal {
            background: var(--surface-elevated);
            border-radius: 12px;
            box-shadow: 0 16px 48px rgba(0, 0, 0, 0.25);
            max-width: 420px;
            width: 100%;
            padding: 24px;
        }
        .smart-sort-help-modal h2 { margin: 0 0 12px 0; font-size: 1.125rem; color: var(--text); }
        .smart-sort-help-modal p { margin: 0 0 20px 0; font-size: 0.9375rem; line-height: 1.5; color: var(--text-secondary); }
        .smart-sort-help-close {
            padding: 10px 20px;
            background: var(--accent);
            color: #000;
            border: 1px solid #000;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            font-family: inherit;
        }
        .library-view-btn-help {
            min-width: 28px;
            padding: 6px 8px;
            font-size: 0.875rem;
            font-weight: 700;
        }

        /* Banner: Wishlist otevřen pro dárky (narozeniny) */
        .wishlist-birthday-banner {
            margin-bottom: 16px;
            padding: 14px 18px;
            background: linear-gradient(135deg, rgba(255, 182, 193, 0.25), rgba(255, 218, 185, 0.3));
            border: 1px solid rgba(255, 105, 180, 0.3);
            border-radius: 12px;
            font-size: 0.9375rem;
            color: var(--text);
        }
        .wishlist-birthday-text { font-weight: 500; }
        .wishlist-birthyear-row {
            margin-bottom: 16px;
            padding: 12px 16px;
            background: rgba(0, 0, 0, 0.02);
            border-radius: 10px;
            border: 1px solid var(--border);
        }
        .wishlist-birthyear-label { display: block; font-size: 0.8125rem; color: var(--text-muted); margin-bottom: 6px; }
        .wishlist-birthyear-input { width: 100%; max-width: 120px; padding: 8px 12px; border: 1px solid var(--border); border-radius: 8px; font-size: 0.9375rem; }

        /* AI asistent – vyskakovací bublina OmniSupport AI v pravém dolním rohu */
        .ai-assistant-bubble-wrap {
            position: fixed;
            right: 20px;
            bottom: 20px;
            z-index: 9000;
            max-width: 320px;
            display: block;
            transition: transform 0.25s ease, opacity 0.25s ease;
        }
        .ai-assistant-bubble-wrap.ai-assistant-visible .ai-assistant-bubble { display: flex; }
        .ai-assistant-bubble {
            display: flex;
            align-items: flex-end;
            gap: 10px;
            flex-direction: row-reverse;
        }
        .ai-assistant-bubble-panel {
            display: none;
            flex-direction: column;
            background: var(--surface-elevated);
            border: 1px solid var(--border);
            border-radius: 16px 16px 16px 4px;
            box-shadow: 0 4px 24px rgba(0, 0, 0, 0.12);
            padding: 16px;
            max-width: 280px;
        }
        .ai-assistant-bubble-wrap.ai-assistant-expanded .ai-assistant-bubble-panel { display: flex; }
        .ai-assistant-bubble-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 10px;
        }
        .ai-assistant-bubble-icon { font-size: 1.25rem; }
        .ai-assistant-bubble-title {
            margin: 0;
            font-size: 1rem;
            font-weight: 600;
            color: var(--text);
        }
        .ai-assistant-bubble-greeting {
            margin: 0 0 12px 0;
            font-size: 0.875rem;
            line-height: 1.45;
            color: var(--text);
        }
        .ai-assistant-bubble-report {
            margin-bottom: 12px;
            padding: 8px 12px;
            font-size: 0.8125rem;
            border: 1px solid var(--border);
            border-radius: 8px;
            background: rgba(0, 0, 0, 0.03);
            cursor: pointer;
        }
        .ai-assistant-bubble-report:hover { background: rgba(0, 0, 0, 0.06); }
        .ai-assistant-bubble-input-wrap {
            display: flex;
            gap: 8px;
        }
        .ai-assistant-bubble-input {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid var(--border);
            border-radius: 8px;
            font-size: 0.875rem;
        }
        .ai-assistant-bubble-send {
            padding: 8px 14px;
            border: none;
            border-radius: 8px;
            background: var(--accent);
            color: #000;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
        }
        .ai-assistant-bubble-send:hover { background: #b8e00e; }
        .ai-assistant-bubble-toggle {
            width: 48px;
            height: 48px;
            flex-shrink: 0;
            border-radius: 50%;
            border: 1px solid var(--border);
            background: var(--accent);
            color: #000;
            font-size: 1.35rem;
            cursor: pointer;
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1);
            transition: transform 0.2s, background 0.2s;
        }
        .ai-assistant-bubble-toggle:hover { background: #b8e00e; transform: scale(1.05); }

        /* Modál Nastavení účtu (globální) – centrování jako pricing, prémiový vzhled */
        .settings-modal-overlay {
            position: fixed;
            inset: 0;
            z-index: 10000;
            background: rgba(0, 0, 0, 0.55);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            box-sizing: border-box;
            transition: background 0.2s ease;
            cursor: pointer;
        }
        .settings-modal-overlay[style*="display: none"] { display: none !important; }
        .settings-modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            max-width: 500px;
            width: calc(100% - 32px);
            max-height: calc(100vh - 32px);
            background: var(--surface-elevated);
            border-radius: 20px;
            box-shadow: 0 24px 48px rgba(0, 0, 0, 0.18);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            cursor: default;
        }
        .settings-modal-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px 20px;
            border-bottom: 1px solid var(--border);
        }
        .settings-modal-title { margin: 0; font-size: 1.125rem; font-weight: 600; color: var(--text); }
        .settings-modal-close {
            width: 36px; height: 36px; padding: 0; border: none; background: transparent;
            font-size: 1.5rem; line-height: 1; color: var(--text-muted); cursor: pointer; border-radius: 8px;
        }
        .settings-modal-close:hover { background: rgba(0, 0, 0, 0.06); color: var(--text); }
        .settings-modal-body { padding: 20px; }
        .settings-modal-intro { margin: 0; font-size: 0.9375rem; color: var(--text-muted); }

        /* Téma OmniShelf Kids – nastavení veselejší */
        body.viewing-as-child .settings-modal-overlay { background: rgba(0, 0, 0, 0.4); }
        body.viewing-as-child .settings-modal {
            background: var(--kids-bg, #FEF9C3);
            box-shadow: 0 24px 48px rgba(255, 217, 102, 0.25);
        }
        body.viewing-as-child .settings-modal .wishlist-modal-content h3,
        body.viewing-as-child .settings-modal .settings-section-title { color: #1d1d1f; }
        body.viewing-as-child .settings-modal-footer {
            background: var(--kids-bg-active, #FEF08A);
            border-top-color: var(--kids-yellow, #FFD966);
        }
        body.viewing-as-child .settings-modal .btn-activate-membership {
            background: var(--kids-yellow, #FFD966);
            border-color: var(--kids-yellow, #FFD966);
            color: #1d1d1f;
        }
        body.viewing-as-child .settings-modal .btn-activate-membership:hover {
            background: #F5D033;
            border-color: #F5D033;
        }

        /* Modál Nastavení police */
        .shelf-settings-modal-overlay {
            position: fixed;
            inset: 0;
            z-index: 10000;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            align-items: center;
            justify-content: center;
            padding: 20px;
            box-sizing: border-box;
        }
        .shelf-settings-modal {
            background: var(--surface-elevated);
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            max-width: 400px;
            width: 100%;
            overflow: hidden;
        }
        .shelf-settings-modal-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px 20px;
            border-bottom: 1px solid var(--border);
        }
        .shelf-settings-modal-title { margin: 0; font-size: 1.125rem; font-weight: 600; color: var(--text); }
        .shelf-settings-modal-close {
            width: 36px; height: 36px; padding: 0; border: none; background: transparent;
            font-size: 1.5rem; line-height: 1; color: var(--text-muted); cursor: pointer; border-radius: 8px;
        }
        .shelf-settings-modal-close:hover { background: rgba(0, 0, 0, 0.06); color: var(--text); }
        .shelf-settings-modal-body { padding: 20px; }
        .shelf-settings-field { margin-bottom: 16px; }
        .shelf-settings-field label { display: block; font-size: 0.875rem; font-weight: 500; color: var(--text); margin-bottom: 6px; }
        .shelf-settings-field input,
        .shelf-settings-field select {
            width: 100%; padding: 10px 12px; border: 1px solid var(--border); border-radius: 8px;
            font-size: 0.9375rem; font-family: inherit; color: var(--text); background: var(--surface);
        }
        .shelf-settings-actions { display: flex; flex-direction: column; gap: 10px; margin-top: 20px; }
        .btn-shelf-settings-rename {
            padding: 10px 16px; font-size: 0.9375rem; font-weight: 600; border: none; border-radius: 8px;
            background: var(--btn-primary); color: #fff; cursor: pointer;
        }
        .btn-shelf-settings-delete {
            padding: 10px 16px; font-size: 0.875rem; border: 1px solid var(--error); color: var(--error);
            background: transparent; border-radius: 8px; cursor: pointer;
        }
        .btn-shelf-settings-delete:hover { background: rgba(220, 38, 38, 0.08); }

        /* Lišta hromadné akce – jemné limetkové pozadí (zobrazí se jen při výběru knihy) */
        .shelf-bulk-bar {
            display: flex; align-items: center; gap: 12px; flex-wrap: wrap;
            padding: 12px 16px; margin-bottom: 12px; width: 100%;
            background: var(--accent-soft);
            border: 1px solid rgba(141, 211, 17, 0.25); border-radius: 10px;
        }
        .shelf-bulk-label { font-size: 0.9375rem; font-weight: 600; color: var(--text); }
        .shelf-bulk-select {
            padding: 8px 12px; font-size: 0.875rem; border-radius: 8px; border: 1px solid var(--border);
            background: var(--surface); color: var(--text); min-width: 200px;
        }
        .shelf-bulk-clear {
            padding: 8px 14px; font-size: 0.875rem; border: 1px solid var(--border); background: var(--surface);
            border-radius: 8px; cursor: pointer; color: var(--text-muted);
        }
        .shelf-bulk-clear:hover { background: var(--surface-elevated); color: var(--text); }
        .library-duplicate-warning-bar {
            padding: 12px 16px; margin-bottom: 12px; width: 100%;
            background: rgba(255, 149, 0, 0.12);
            border: 1px solid rgba(255, 149, 0, 0.35); border-radius: 10px;
            font-size: 0.9375rem; color: var(--text);
        }
        .library-duplicate-warning-bar strong { color: #c93400; }

        /* Ozubené kolečko v liště police */
        .btn-shelf-gear {
            width: 36px; height: 36px; padding: 0; border: none; border-radius: 8px;
            background: transparent; color: var(--text-muted); font-size: 1.1rem; cursor: pointer;
            display: inline-flex; align-items: center; justify-content: center;
        }
        .btn-shelf-gear:hover { background: rgba(0, 0, 0, 0.06); color: var(--text); }

        /* Srdcovky: hromadný výběr (checkboxy jsou jinak skryté) */
        .view-favorites .book-card-select-checkbox { display: none; }
        .view-favorites.favorites-bulk-select .book-card-select-checkbox { display: block; }
        .btn-shelf-bulk-toggle {
            padding: 8px 12px;
            font-size: 0.875rem;
            border-radius: 999px;
            border: 1px solid rgba(0,0,0,0.12);
            background: rgba(255,255,255,0.8);
            color: var(--text-secondary);
            font-weight: 900;
            cursor: pointer;
        }
        .btn-shelf-bulk-toggle.is-active {
            border-color: rgba(141, 211, 17, 0.65);
            background: rgba(141, 211, 17, 0.14);
            color: #14532d;
        }

        /* Checkbox výběru na kartě */
        .book-card-select-checkbox {
            position: absolute; top: 10px; left: 10px; z-index: 5;
            width: 20px; height: 20px; cursor: pointer; accent-color: var(--btn-primary);
        }

        /* Friends Recommendations */
        .friends-reco-section {
            /* níž pod horní lištu (lupa) */
            margin-top: 32px;
        }
        .friends-reco-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 12px;
            margin-bottom: 12px;
        }
        .friends-reco-title {
            margin: 0;
            font-size: 1.15rem;
            font-weight: 900;
            color: var(--text);
        }
        .friends-reco-header-actions {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }
        .friends-reco-tab {
            border: 1px solid rgba(0,0,0,0.10);
            background: rgba(255,255,255,0.8);
            border-radius: 999px;
            padding: 8px 12px;
            font-weight: 800;
            font-size: 0.875rem;
            cursor: pointer;
        }
        .friends-reco-tab.active {
            border-color: rgba(141, 211, 17, 0.7);
            background: rgba(141, 211, 17, 0.16);
            color: #14532d;
        }
        .friends-reco-panel { margin-top: 10px; }
        .friends-reco-seed-note {
            margin: 4px 0 12px;
            font-size: 0.85rem;
            font-weight: 800;
            color: var(--text-muted);
        }

        .friends-reco-accordion {
            border: 1px solid rgba(0,0,0,0.10);
            border-radius: 16px;
            background: rgba(255,255,255,0.9);
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
            overflow: hidden;
            margin-bottom: 12px;
        }
        .friends-reco-accordion-toggle {
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 12px;
            padding: 12px 14px;
            background: rgba(247, 254, 231, 0.7);
            border: none;
            cursor: pointer;
            font-weight: 900;
        }
        .friends-reco-accordion-body {
            padding: 12px 14px 14px;
        }
        .friends-reco-filters {
            display: grid;
            grid-template-columns: repeat(6, minmax(0, 1fr));
            gap: 10px;
        }
        .friends-reco-filter label {
            display: block;
            font-size: 0.75rem;
            color: var(--text-muted);
            margin-bottom: 4px;
            font-weight: 700;
        }
        .friends-reco-filter input,
        .friends-reco-filter select {
            width: 100%;
            padding: 9px 10px;
            border: 1px solid rgba(0,0,0,0.12);
            border-radius: 10px;
            font-size: 0.875rem;
            background: #fff;
        }
        .friends-reco-grid {
            display: grid;
            grid-template-columns: repeat(4, minmax(0, 1fr));
            gap: 14px;
        }
        @media (max-width: 1100px) {
            .friends-reco-filters { grid-template-columns: repeat(3, minmax(0, 1fr)); }
            .friends-reco-grid { grid-template-columns: repeat(3, minmax(0, 1fr)); }
        }
        @media (max-width: 820px) {
            .friends-reco-filters { grid-template-columns: repeat(2, minmax(0, 1fr)); }
            .friends-reco-grid { grid-template-columns: repeat(2, minmax(0, 1fr)); }
        }
        @media (max-width: 520px) {
            .friends-reco-grid { grid-template-columns: 1fr; }
        }

        .friends-reco-card {
            background: #fff;
            border: none;
            border-radius: 20px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            cursor: pointer;
        }
        .friends-reco-top {
            display: flex;
            gap: 12px;
            padding: 12px 12px 10px;
        }
        .friends-reco-cover {
            width: 74px;
            flex: 0 0 74px;
        }
        .friends-reco-cover-frame {
            width: 74px;
            aspect-ratio: 2/3;
            border-radius: 14px;
            background: #fff;
            border: 1px solid rgba(0,0,0,0.12);
            box-shadow: 0 8px 18px rgba(0,0,0,0.08);
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }
        .friends-reco-cover-icon { width: 100%; height: 100%; object-fit: cover; display: block; }
        .friends-reco-meta { min-width: 0; display: flex; flex-direction: column; gap: 4px; }
        .friends-reco-book-title { font-weight: 900; color: var(--text); font-size: 0.98rem; line-height: 1.2; }
        .friends-reco-book-author { color: var(--text-secondary); font-size: 0.875rem; }
        .friends-reco-book-genre { color: var(--text-muted); font-size: 0.8125rem; }

        /* Bublinový vzkaz */
        .friends-reco-bubble {
            margin: 0 12px 10px;
            padding: 10px 12px;
            border-radius: 16px;
            background: rgba(247, 254, 231, 0.85);
            border: 1px solid rgba(141, 211, 17, 0.28);
            box-shadow: 0 6px 16px rgba(0,0,0,0.06);
            position: relative;
        }
        .friends-reco-bubble::before {
            content: "";
            position: absolute;
            top: -8px;
            left: 22px;
            width: 14px;
            height: 14px;
            background: rgba(247, 254, 231, 0.95);
            border-left: 1px solid rgba(141, 211, 17, 0.28);
            border-top: 1px solid rgba(141, 211, 17, 0.28);
            transform: rotate(45deg);
        }
        .friends-reco-bubble-from {
            font-weight: 900;
            font-size: 0.85rem;
            color: #14532d;
            margin-bottom: 4px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        .friends-reco-avatar {
            width: 26px;
            height: 26px;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            background: rgba(141, 211, 17, 0.22);
            border: 1px solid rgba(141, 211, 17, 0.40);
            color: #14532d;
            font-weight: 900;
            font-size: 0.75rem;
            line-height: 1;
            flex: 0 0 26px;
        }
        .friends-reco-from-name { line-height: 1.1; }
        .friends-reco-bubble-text {
            color: var(--text-secondary);
            font-size: 0.875rem;
            line-height: 1.4;
        }

        .friends-reco-helper {
            margin: 0 12px 10px;
            font-size: 0.8125rem;
            color: var(--text-muted);
        }

        .friends-reco-bottom {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 10px;
            padding: 10px 12px 12px;
            border-top: 1px solid rgba(0,0,0,0.06);
        }
        .friends-reco-availability {
            font-size: 0.8125rem;
            font-weight: 900;
            padding: 6px 10px;
            border-radius: 999px;
            border: 1px solid rgba(0,0,0,0.10);
            background: rgba(0,0,0,0.03);
            color: var(--text);
            white-space: nowrap;
        }
        .friends-reco-availability.is-available {
            background: rgba(141, 211, 17, 0.16);
            border-color: rgba(141, 211, 17, 0.45);
            color: #14532d;
        }
        .friends-reco-availability.is-unavailable {
            background: rgba(255, 59, 48, 0.10);
            border-color: rgba(255, 59, 48, 0.30);
            color: #7f1d1d;
        }
        .friends-reco-borrow-btn {
            border: none;
            border-radius: 12px;
            padding: 10px 12px;
            font-weight: 900;
            cursor: pointer;
            background: #8DD311;
            color: #000;
        }
        .friends-reco-borrow-btn:disabled {
            opacity: 0.7;
            cursor: default;
        }

        .friends-reco-empty {
            margin-top: 12px;
            padding: 14px 16px;
            border: 1px dashed rgba(0,0,0,0.18);
            border-radius: 16px;
            background: rgba(255,255,255,0.75);
            color: var(--text-secondary);
        }

        /* Add panel */
        .friends-reco-add-form {
            border: 1px solid rgba(0,0,0,0.10);
            border-radius: 20px;
            background: rgba(255,255,255,0.9);
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
            padding: 14px;
        }
        .friends-reco-add-grid {
            display: grid;
            grid-template-columns: repeat(3, minmax(0, 1fr));
            gap: 10px;
        }
        @media (max-width: 920px) { .friends-reco-add-grid { grid-template-columns: repeat(2, minmax(0, 1fr)); } }
        @media (max-width: 560px) { .friends-reco-add-grid { grid-template-columns: 1fr; } }
        .friends-reco-add-field label { display:block; font-size: 0.75rem; color: var(--text-muted); font-weight: 800; margin-bottom: 4px; }
        .friends-reco-add-field input,
        .friends-reco-add-field select {
            width: 100%;
            padding: 9px 10px;
            border: 1px solid rgba(0,0,0,0.12);
            border-radius: 10px;
            font-size: 0.875rem;
            background: #fff;
        }
        .friends-reco-privacy { margin-top: 12px; }
        .friends-reco-privacy-title { font-weight: 900; font-size: 0.85rem; margin-bottom: 6px; }
        .friends-reco-privacy-seg { display: flex; gap: 10px; flex-wrap: wrap; }
        .friends-reco-privacy-opt { font-size: 0.875rem; font-weight: 800; color: var(--text-secondary); display: inline-flex; align-items: center; gap: 6px; }
        .friends-reco-add-message { margin-top: 10px; }
        .friends-reco-add-message label { display:block; font-size: 0.75rem; color: var(--text-muted); font-weight: 800; margin-bottom: 4px; }
        .friends-reco-add-message textarea {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid rgba(0,0,0,0.12);
            border-radius: 12px;
            font-size: 0.9rem;
            font-family: inherit;
            resize: vertical;
            background: #fff;
        }
        .friends-reco-add-actions { margin-top: 10px; display: flex; justify-content: flex-end; }
        .friends-reco-add-btn {
            border: none;
            border-radius: 12px;
            padding: 10px 14px;
            font-weight: 900;
            cursor: pointer;
            background: #8DD311;
            color: #000;
        }
        .friends-reco-add-hint { margin-top: 10px; color: var(--text-muted); font-size: 0.875rem; }

        /* AI panel */
        .friends-reco-ai-card {
            border: 1px solid rgba(0,0,0,0.10);
            border-radius: 20px;
            background: rgba(255,255,255,0.9);
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
            padding: 14px;
        }
        .friends-reco-ai-title { font-weight: 900; margin-bottom: 6px; }
        .friends-reco-ai-sub { margin: 0 0 10px 0; color: var(--text-secondary); font-size: 0.875rem; }
        .friends-reco-ai-row { display:flex; gap: 10px; flex-wrap: wrap; }
        .friends-reco-ai-row input {
            flex: 1;
            min-width: 220px;
            padding: 10px 12px;
            border: 1px solid rgba(0,0,0,0.12);
            border-radius: 12px;
            font-size: 0.9rem;
        }
        .friends-reco-ai-btn {
            border: none;
            border-radius: 12px;
            padding: 10px 14px;
            font-weight: 900;
            background: rgba(0,0,0,0.06);
            color: var(--text-muted);
            cursor: not-allowed;
        }

        /* Přesunout na kartě */
        .book-card-move-wrap { flex: 1 1 100%; width: 100%; margin-top: 6px; }
        .book-card-move-label { display: block; font-size: 0.75rem; color: var(--text-muted); margin-bottom: 4px; }
        .book-card-move-select {
            width: 100%; padding: 6px 8px; font-size: 0.75rem; border: 1px solid var(--border);
            border-radius: 6px; background: var(--surface); color: var(--text);
        }

        .edit-book-modal-body {
            padding: 20px;
            overflow-y: auto;
            flex: 1;
        }
        .edit-book-top {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }
        .edit-book-modal-cover-wrap {
            flex-shrink: 0;
        }
        .edit-book-basic {
            flex: 1;
            min-width: 0;
            display: flex;
            flex-direction: column;
            gap: 14px;
        }
        .edit-book-basic .edit-book-field input,
        .edit-book-basic .edit-book-field select {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid var(--border);
            border-radius: 8px;
            font-size: 0.9375rem;
            font-family: inherit;
            color: var(--text);
            background: var(--surface);
            box-sizing: border-box;
        }
        .edit-book-basic .edit-book-field select {
            cursor: pointer;
        }
        .edit-book-section-title {
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.06em;
            color: var(--text-muted);
            margin-top: 6px;
            margin-bottom: -4px;
        }
        .edit-book-voice-section {
            margin-bottom: 16px;
            padding: 12px 0;
            border-top: 1px solid var(--border-soft);
            border-bottom: 1px solid var(--border-soft);
        }
        .edit-book-voice-btn {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            padding: 10px 16px;
            border: 1px dashed var(--border);
            border-radius: 8px;
            background: var(--surface);
            color: var(--text);
            font-size: 0.9375rem;
            font-family: inherit;
            cursor: pointer;
            transition: background 0.15s, border-color 0.15s;
        }
        .edit-book-voice-btn:hover {
            background: var(--surface-elevated);
            border-color: var(--text-muted);
        }
        .edit-book-voice-btn.recording {
            border-color: #dc2626;
            background: #fef2f2;
        }
        .edit-book-voice-icon {
            font-size: 1.25rem;
        }
        .edit-book-waveform {
            display: flex;
            align-items: flex-end;
            justify-content: center;
            gap: 4px;
            margin-top: 12px;
            height: 32px;
        }
        .edit-book-waveform-bar {
            width: 4px;
            min-height: 8px;
            background: var(--text-muted);
            border-radius: 2px;
            animation: edit-book-wave 0.6s ease-in-out infinite alternate;
        }
        .edit-book-waveform-bar:nth-child(1) { animation-delay: 0s; }
        .edit-book-waveform-bar:nth-child(2) { animation-delay: 0.1s; }
        .edit-book-waveform-bar:nth-child(3) { animation-delay: 0.2s; }
        .edit-book-waveform-bar:nth-child(4) { animation-delay: 0.3s; }
        .edit-book-waveform-bar:nth-child(5) { animation-delay: 0.15s; }
        .edit-book-waveform-bar:nth-child(6) { animation-delay: 0.25s; }
        .edit-book-waveform-bar:nth-child(7) { animation-delay: 0.05s; }
        .edit-book-waveform-bar:nth-child(8) { animation-delay: 0.35s; }
        @keyframes edit-book-wave {
            from { height: 8px; }
            to { height: 28px; }
        }
        .edit-book-accordion {
            margin-bottom: 16px;
        }
        .edit-book-accordion-toggle {
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 16px;
            border: 1px solid var(--border);
            border-radius: 8px;
            background: var(--surface);
            color: var(--text);
            font-size: 0.9375rem;
            font-weight: 600;
            font-family: inherit;
            cursor: pointer;
            transition: background 0.15s, border-color 0.15s;
        }
        .edit-book-accordion-toggle:hover {
            background: var(--surface-elevated);
        }
        .edit-book-accordion-chevron {
            width: 20px;
            height: 20px;
            transition: transform 0.25s ease;
        }
        .edit-book-accordion.open .edit-book-accordion-chevron {
            transform: rotate(180deg);
        }
        .edit-book-accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }
        .edit-book-accordion.open .edit-book-accordion-content {
            max-height: 800px;
        }
        .edit-book-accordion-content .edit-book-modal-fields {
            padding-top: 16px;
        }
        .edit-book-cover-preview {
            aspect-ratio: 2/3;
            max-height: 180px;
            background: #e5e7eb;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }
        .edit-book-cover-preview img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .edit-book-cover-placeholder {
            font-size: 0.875rem;
            color: var(--text-muted);
        }
        .edit-book-modal-fields {
            display: flex;
            flex-direction: column;
            gap: 14px;
        }
        .edit-book-field label {
            display: block;
            font-size: 0.8125rem;
            font-weight: 600;
            color: var(--text);
            margin-bottom: 4px;
        }
        .edit-book-field input,
        .edit-book-field textarea {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid var(--border);
            border-radius: 8px;
            font-size: 0.9375rem;
            font-family: inherit;
            color: var(--text);
            background: var(--surface);
            box-sizing: border-box;
        }
        .edit-book-field textarea {
            resize: vertical;
            min-height: 80px;
        }
        .edit-book-field-location .edit-book-location-select { width: 100%; max-width: 100%; }
        .edit-book-location-new-wrap { margin-top: 10px; }
        .edit-book-location-new-wrap label { display: block; margin-bottom: 4px; font-size: 0.8125rem; color: var(--text-muted); }
        .edit-book-field-full {
            grid-column: 1 / -1;
        }
        .edit-book-modal-footer {
            padding: 16px 20px;
            border-top: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .btn-edit-book-save {
            padding: 12px 20px;
            font-size: 1rem;
            font-weight: 600;
            border-radius: 8px;
            border: none;
            background: #1a1a1a;
            color: #fff;
            cursor: pointer;
            font-family: inherit;
        }
        .btn-edit-book-save:hover {
            background: #333;
        }
        .btn-edit-book-pracovna {
            padding: 14px 20px;
            font-size: 1rem;
            color: #1a1a1a !important;
        }
        .btn-edit-book-pracovna:hover {
            color: white !important;
        }
        .edit-book-cover-change {
            display: inline-block;
            margin-top: 10px;
            padding: 10px 16px;
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--text);
            background: var(--surface);
            border: 1px dashed var(--border);
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.15s, border-color 0.15s;
        }
        .edit-book-cover-change:hover {
            background: var(--surface-elevated);
            border-color: var(--text-muted);
        }
        .edit-book-cover-change-text {
            pointer-events: none;
        }
        .edit-book-field-full textarea {
            min-height: 120px;
        }

        .ai-presentation-output {
            margin-top: 16px;
            padding: 14px;
            background: var(--surface);
            border-radius: var(--radius-sm);
            border: 1px solid var(--border);
        }
        .ai-presentation-heading {
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--text-secondary);
            margin: 12px 0 6px;
            text-transform: uppercase;
            letter-spacing: 0.03em;
        }
        .ai-presentation-heading:first-child { margin-top: 0; }
        .ai-presentation-summary,
        .ai-presentation-why {
            font-size: 0.9rem;
            color: var(--text-primary);
            line-height: 1.5;
            margin: 0;
        }
        .ai-presentation-list {
            margin: 0 0 8px;
            padding-left: 1.2rem;
            font-size: 0.9rem;
            color: var(--text-primary);
        }
        .btn-voice-briefing {
            margin-top: 14px;
            padding: 8px 14px;
            font-size: 0.85rem;
            font-weight: 500;
            border-radius: var(--radius-sm);
            border: 1px solid var(--border);
            background: var(--surface);
            color: var(--text-secondary);
            cursor: pointer;
            font-family: inherit;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            transition: all 0.2s;
        }
        .btn-voice-briefing:hover {
            border-color: var(--text);
            color: var(--text);
        }

        .discworld-collection-modal .discworld-collection-content { padding: 24px; }
        .discworld-collection-title { margin: 0 0 4px; font-size: 1.35rem; color: var(--text-primary); }
        .discworld-collection-subtitle { font-size: 0.9rem; color: var(--text-secondary); margin: 0 0 20px; }
        .discworld-summary-block, .discworld-audio-block, .discworld-qa-block { margin-bottom: 20px; }
        .discworld-universe-text { font-size: 0.95rem; line-height: 1.6; color: var(--text-primary); margin: 8px 0 0; }
        .btn-discworld-briefing { width: 100%; margin-bottom: 8px; }
        .discworld-briefing-hint { font-size: 0.8rem; color: var(--text-muted); margin: 0; line-height: 1.4; }
        .discworld-qa-hint { font-size: 0.85rem; color: var(--text-secondary); margin: 4px 0 10px; }
        .discworld-qa-row { display: flex; gap: 10px; align-items: center; flex-wrap: wrap; }
        .discworld-qa-input { flex: 1; min-width: 180px; padding: 10px 12px; border: 1px solid var(--border); border-radius: var(--radius-sm); font-size: 0.9rem; }
        .discworld-qa-answer { margin-top: 14px; padding: 14px; background: var(--surface); border-radius: var(--radius-sm); border: 1px solid var(--border); font-size: 0.9rem; line-height: 1.5; color: var(--text-primary); min-height: 48px; }

        .visual-map-shelf-container { position: relative; max-width: 100%; margin-top: 24px; border-radius: var(--radius); overflow: hidden; box-shadow: 0 8px 32px rgba(128, 90, 213, 0.18); }
        .visual-map-shelf-image { width: 100%; display: block; }
        .visual-map-hotspots { position: absolute; inset: 0; pointer-events: none; }
        .visual-map-hotspots .visual-map-hotspot { pointer-events: auto; position: absolute; width: 48px; height: 48px; border-radius: 50%; background: rgba(128, 90, 213, 0.5); border: 2px solid rgba(255,255,255,0.85); cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 20px; transition: transform 0.2s, background 0.2s, box-shadow 0.2s; box-shadow: 0 4px 16px rgba(128, 90, 213, 0.4); backdrop-filter: blur(6px); }
        .visual-map-hotspots .visual-map-hotspot:hover { transform: scale(1.12); background: rgba(128, 90, 213, 0.75); box-shadow: 0 6px 24px rgba(128, 90, 213, 0.5); }
        .visual-map-popover { position: fixed; z-index: 9999; max-width: 340px; padding: 18px 20px; background: rgba(248, 245, 255, 0.94); border-radius: 12px; border: 1px solid rgba(128, 90, 213, 0.35); box-shadow: 0 16px 40px rgba(128, 90, 213, 0.22); font-size: 0.9rem; line-height: 1.55; color: var(--text-primary); backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px); }
        .visual-map-popover .visual-map-popover-close { position: absolute; top: 8px; right: 10px; width: 28px; height: 28px; padding: 0; border: none; border-radius: 50%; background: rgba(128, 90, 213, 0.2); color: var(--text); font-size: 1.25rem; line-height: 1; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: background 0.2s; }
        .visual-map-popover .visual-map-popover-close:hover { background: rgba(128, 90, 213, 0.35); }
        .visual-map-popover .visual-map-popover-title { font-weight: 600; color: var(--text); margin-bottom: 8px; font-size: 1rem; padding-right: 28px; }
        .visual-map-popover .btn-open-full-presentation { margin-top: 12px; padding: 8px 14px; font-size: 0.85rem; border-radius: var(--radius-sm); border: 1px solid rgba(128, 90, 213, 0.5); background: rgba(128, 90, 213, 0.12); color: var(--text); cursor: pointer; transition: background 0.2s, border-color 0.2s; }
        .visual-map-popover .btn-open-full-presentation:hover { background: rgba(128, 90, 213, 0.2); border-color: var(--text); }

        .coming-soon-thanks {
            font-size: 0.95rem;
            color: var(--success);
            margin-top: 16px;
            font-weight: 500;
        }

        .ai-quiz-modal {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.4);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            padding: 20px;
        }

        .ai-quiz-modal-content {
            background: var(--surface-elevated);
            border-radius: var(--radius);
            padding: 24px;
            max-width: 440px;
            width: 100%;
            box-shadow: var(--shadow-hover);
        }

        .ai-quiz-modal h3 {
            font-size: 1.1rem;
            margin-bottom: 16px;
        }

        .ai-quiz-response {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 16px;
            line-height: 1.6;
        }

        .ai-quiz-modal .btn-close-quiz {
            margin-top: 12px;
            padding: 8px 16px;
            font-size: 0.85rem;
            border-radius: var(--radius-sm);
            border: 1px solid var(--border);
            background: var(--surface);
            cursor: pointer;
        }

        .ai-quiz-modal .btn-close-quiz:hover {
            border-color: var(--text);
            color: var(--text);
        }

        .ai-quiz-textarea {
            width: 100%;
            min-height: 120px;
            padding: 14px 16px;
            font-size: 0.9rem;
            font-family: inherit;
            line-height: 1.5;
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            background: var(--surface);
            color: var(--text);
            resize: vertical;
            transition: border-color 0.2s;
        }

        .ai-quiz-textarea::placeholder {
            color: var(--text-muted);
        }

        .ai-quiz-textarea:focus {
            outline: none;
            border-color: var(--text);
        }

        .ai-quiz-modal-actions {
            display: flex;
            gap: 12px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .ai-quiz-modal .btn-submit-quiz {
            padding: 10px 20px;
            font-size: 0.9rem;
            font-weight: 600;
            border-radius: var(--radius-sm);
            border: none;
            background: var(--btn-primary);
            color: white;
            cursor: pointer;
            font-family: inherit;
            transition: all 0.2s;
        }

        .ai-quiz-modal .btn-submit-quiz:hover {
            background: var(--accent-hover);
            transform: scale(1.02);
        }

        .ai-quiz-success {
            text-align: center;
            padding: 24px 0;
        }

        .ai-quiz-success-icon {
            font-size: 2.5rem;
            margin-bottom: 12px;
        }

        .ai-quiz-success-text {
            font-size: 1rem;
            color: var(--text);
            line-height: 1.6;
        }

        /* Library table */
        .library-section {
            margin-top: 48px;
        }

        .library-section-compact {
            margin-top: 20px;
        }

        .library-section-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text);
            margin-bottom: 20px;
        }

        .library-table-wrap {
            background: var(--surface);
            border: 1px solid var(--border-soft);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
        }

        .library-table th {
            background: var(--surface-elevated);
        }

        .library-table tbody tr:hover {
            background: var(--surface-elevated);
        }

        .library-table .title-cell-inner {
            display: flex;
            align-items: center;
            gap: 8px;
            width: 100%;
        }

        .library-table .title-cell-inner .genre-icon {
            flex-shrink: 0;
            width: 14px;
            height: 14px;
            color: var(--text-muted);
            opacity: 0.85;
        }

        .library-table .title-cell-inner .genre-icon svg {
            width: 100%;
            height: 100%;
        }

        .library-table .editable-cell {
            cursor: text;
            padding: 8px 10px;
            border-radius: 6px;
            transition: background 0.15s;
            min-width: 80px;
            display: inline-block;
            flex: 1;
            min-width: 0;
        }

        .library-table .editable-cell:hover {
            background: var(--accent-soft);
        }

        .library-table .editable-cell:focus {
            outline: 2px solid var(--btn-primary);
            outline-offset: -2px;
            background: var(--bg);
        }

        .library-empty {
            text-align: center;
            padding: 40px 24px;
            color: var(--text-muted);
            font-size: 0.9375rem;
            background: var(--surface);
            border: 1px solid var(--border-soft);
            border-radius: var(--radius);
        }

        @media (max-width: 768px) {
            html, body { overflow-x: hidden; max-width: 100vw; }
            .dashboard { flex-direction: column; min-width: 0; width: 100%; }
            /* Sidebar skrytý – zobrazí se pouze po kliknutí na hamburger */
            #sidebar-container {
                position: fixed;
                left: 0;
                top: 0;
                bottom: 0;
                width: 280px;
                max-width: 88vw;
                z-index: 2000;
                transform: translateX(-100%);
                transition: transform 0.2s ease;
                overflow-y: auto;
                overflow-x: hidden;
                background: var(--surface-elevated);
                box-shadow: 4px 0 20px rgba(0,0,0,0.12);
                visibility: hidden;
                pointer-events: none;
            }
            body.sidebar-open-mobile #sidebar-container {
                transform: translateX(0);
                visibility: visible;
                pointer-events: auto;
            }
            body.sidebar-open-mobile #sidebar-container { transform: translateX(0); }
            .sidebar-overlay-backdrop {
                display: none;
                position: fixed;
                inset: 0;
                background: rgba(0,0,0,0.4);
                z-index: 1999;
            }
            body.sidebar-open-mobile .sidebar-overlay-backdrop { display: block; }
            .sidebar {
                width: 100%;
                min-height: 100%;
                flex-direction: column;
                flex-wrap: nowrap;
                border-right: none;
                padding: 0;
            }
            .sidebar-header {
                width: 100%;
                padding: 12px 16px 12px 48px;
                border-bottom: 1px solid var(--border-soft);
                margin-bottom: 0;
                position: relative;
            }
            .btn-sidebar-close-mobile {
                display: flex;
                position: absolute;
                left: 12px;
                top: 50%;
                transform: translateY(-50%);
                width: 36px;
                height: 36px;
                align-items: center;
                justify-content: center;
                border: none;
                background: transparent;
                font-size: 1.5rem;
                color: var(--text-muted);
                cursor: pointer;
                border-radius: var(--radius);
            }
            .btn-sidebar-close-mobile:hover { color: var(--text); background: rgba(0,0,0,0.06); }
            .sidebar-nav {
                display: flex;
                flex-direction: column;
                flex-wrap: nowrap;
                gap: 0;
                padding: 8px 0;
            }
            .sidebar-nav-item {
                flex: none;
                min-width: 0;
                width: 100%;
                text-align: left;
                justify-content: flex-start;
                padding: 12px 20px;
            }
            /* Kompaktní Moje knihovna – menší rozestupy, zůstává accordion */
            .sidebar-submenu-item {
                padding-top: 10px;
                padding-bottom: 10px;
            }
            .sidebar-submenu { padding-left: 16px; }
            .sidebar-group-expandable .sidebar-nav-toggle { padding: 12px 20px; }
            .main-content {
                width: 100% !important;
                max-width: 100% !important;
                min-width: 0;
                flex: 1 1 100%;
                overflow-x: hidden;
                padding: 24px 16px 72px;
            }
            .cards-grid { grid-template-columns: 1fr; }
            .library-body-grid, .library-accordion .shelf-group-books .cards-grid,
            .shelf-group-books .books-grid {
                grid-template-columns: repeat(2, minmax(0, 1fr));
            }
            .books-grid { grid-template-columns: 1fr; }
            .upload-area { padding: 48px 24px; }
            .btn-mobile-menu-toggle { display: flex; }
        }

        @media (min-width: 769px) and (max-width: 1100px) {
            .library-body-grid, .library-accordion .shelf-group-books .cards-grid,
            .shelf-group-books .books-grid {
                grid-template-columns: repeat(3, minmax(0, 1fr));
            }
        }

        .omni-support-fab {
            position: fixed;
            bottom: 24px;
            right: 24px;
            width: 56px;
            height: 56px;
            border-radius: 50%;
            border: none;
            background: var(--btn-primary);
            color: white;
            font-size: 28px;
            cursor: pointer;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
            z-index: 9999;
            transition: transform 0.2s, box-shadow 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .omni-support-fab:hover {
            transform: scale(1.08);
            box-shadow: 0 6px 24px rgba(0,0,0,0.2);
        }
        .omni-support-panel {
            position: fixed;
            bottom: 90px;
            right: 24px;
            width: 360px;
            max-width: calc(100vw - 48px);
            max-height: 480px;
            background: var(--surface-elevated);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            box-shadow: 0 8px 40px rgba(0,0,0,0.15);
            z-index: 1000;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            opacity: 0;
            visibility: hidden;
            transform: translateY(10px) scale(0.95);
            transition: opacity 0.2s, visibility 0.2s, transform 0.2s;
        }
        .omni-support-panel.open {
            opacity: 1;
            visibility: visible;
            transform: translateY(0) scale(1);
        }
        .omni-support-panel-header {
            padding: 14px 16px;
            background: var(--surface);
            border-bottom: 1px solid var(--border);
            font-weight: 600;
            font-size: 0.95rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .omni-support-panel-header span:first-child { font-size: 1.2rem; }
        .omni-support-chat {
            flex: 1;
            overflow-y: auto;
            padding: 16px;
            display: flex;
            flex-direction: column;
            gap: 12px;
            min-height: 200px;
        }
        .omni-support-msg {
            max-width: 90%;
            padding: 10px 14px;
            border-radius: 12px;
            font-size: 0.875rem;
            line-height: 1.5;
        }
        .omni-support-msg.bot {
            align-self: flex-start;
            background: var(--surface);
            border: 1px solid var(--border-soft);
        }
        .omni-support-msg.user {
            align-self: flex-end;
            background: var(--accent-soft);
            color: var(--text);
            border: 1px solid rgba(99, 102, 241, 0.3);
        }
        .omni-support-actions {
            padding: 12px 16px;
            border-top: 1px solid var(--border-soft);
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        .omni-support-actions .btn-report-bug {
            padding: 8px 14px;
            font-size: 0.8rem;
            border-radius: var(--radius-sm);
            border: 1px solid var(--border);
            background: var(--surface);
            color: var(--text-secondary);
            cursor: pointer;
            font-family: inherit;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: all 0.2s;
        }
        .omni-support-actions .btn-report-bug:hover {
            border-color: var(--text);
            color: var(--text);
        }
        .omni-support-input-row {
            display: flex;
            gap: 8px;
            padding: 12px 16px;
            border-top: 1px solid var(--border-soft);
        }
        .omni-support-input-row input {
            flex: 1;
            padding: 10px 14px;
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            font-size: 0.875rem;
            font-family: inherit;
        }
        .omni-support-input-row input:focus {
            outline: none;
            border-color: var(--text);
        }
        .omni-support-input-row button {
            padding: 10px 16px;
            border: none;
            border-radius: var(--radius-sm);
            background: var(--btn-primary);
            color: white;
            font-size: 0.875rem;
            cursor: pointer;
            font-family: inherit;
        }
        .omni-support-input-row button:hover {
            filter: brightness(1.05);
        }
        .btn-record-audio.recording,
        .btn-speak-review.recording { background: var(--error-soft) !important; border-color: var(--error) !important; color: var(--error) !important; }
        .rec-dot { display: inline-block; width: 8px; height: 8px; background: var(--error); border-radius: 50%; animation: rec-pulse 1s infinite; }
        @keyframes rec-pulse { 0%,100%{ opacity:1 } 50%{ opacity:0.5 } }
        .qrcode-modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center; z-index: 9999; }
        .qrcode-modal { background: var(--surface-elevated); border-radius: var(--radius); padding: 24px; max-width: 360px; box-shadow: var(--shadow-card); position: relative; }
        .qrcode-container { position: relative; display: inline-flex; align-items: center; justify-content: center; padding: 16px; background: #fff; border-radius: 8px; }
        .qrcode-container canvas, .qrcode-container img { display: block; }
        .qrcode-logo-placeholder { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 48px; height: 48px; background: var(--btn-primary); color: white; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 1rem; box-shadow: 0 0 0 4px #fff; }
        .public-preview-page { min-height: 100vh; background: var(--surface); padding: 24px; }
        .public-preview-page h1 { margin-bottom: 16px; font-size: 1.25rem; }
        .public-preview-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 16px; }
        .esky-mode .shelf-group-icon { font-size: 1.4em; }
        .esky-mode .item-card-clean { border-radius: 20px; }
        .esky-mode .placeholder-book-icon { font-size: 2rem; }
        .viewing-as-child .main-content { --accent-soft: rgba(253, 230, 138, 0.25); }
        .viewing-as-child .item-card-clean { border-radius: 20px; }
        .viewing-as-child .sidebar-library-group#sidebarChildrenLibrary .sidebar-nav-item { background: #fef9c3; color: #92400e; }
        .viewing-as-child .sidebar-nav .sidebar-library-group#sidebarChildrenLibrary { background: rgba(0,0,0,0.03); border-radius: 12px; margin: 0 8px; padding: 4px 0; }
        /* Striktní Esky: v profilu dítěte jen Dětská knihovna (Moje knížky, Hry, Kvízy, Wishlist, Výměna). Nastavení zůstává viditelné. */
        .viewing-as-child #sidebarMainLibrary,
        .viewing-as-child #sidebarOtherSectors,
        .viewing-as-child #sidebarPracovna,
        .viewing-as-child .sidebar-nav-admin-only,
        .viewing-as-child .sidebar-export,
        .viewing-as-child #sidebarStats { display: none !important; }
        body.kids-theme #sidebarPracovna,
        body.kids-theme #sidebarOtherSectors,
        body.kids-theme .sidebar-nav-admin-only { display: none !important; }
        body:not(.kids-theme) .sidebar-back-to-library { display: none !important; }
        body.kids-theme .sidebar-back-to-library { display: flex !important; }
        .viewing-as-child .sidebar-nav-settings { display: flex !important; }
        .settings-family-list { display: flex; flex-direction: column; gap: 12px; margin-bottom: 12px; }
        .settings-family-item { display: flex; flex-wrap: wrap; align-items: center; gap: 8px; padding: 12px; background: var(--surface-elevated); border: 1px solid var(--border); border-radius: var(--radius-sm); }
        .settings-family-name { font-weight: 500; flex: 1; min-width: 100px; }
        .settings-family-count { font-size: 0.8rem; color: var(--text-muted); }
        .btn-remove-member { font-size: 0.8rem; padding: 6px 12px; border: 1px solid var(--error); background: transparent; color: var(--error); border-radius: var(--radius-sm); cursor: pointer; }
        .btn-remove-member:hover { background: var(--error-soft); }
        .settings-removal-request { display: flex; justify-content: space-between; align-items: center; padding: 10px 12px; background: #fef3c7; border: 1px solid #d97706; border-radius: var(--radius-sm); margin-top: 8px; }
        .btn-approve-removal, .btn-reject-removal { font-size: 0.8rem; padding: 4px 10px; margin-left: 6px; border-radius: 4px; cursor: pointer; }
        .btn-approve-removal { background: var(--success); color: white; border: none; }
        .btn-reject-removal { background: transparent; border: 1px solid var(--border); }
        .btn-add-family-member-settings { padding: 8px 14px; font-size: 0.875rem; border: 1px dashed var(--border); background: transparent; color: var(--text-secondary); border-radius: var(--radius-sm); cursor: pointer; margin-top: 4px; }
        .btn-add-family-member-settings:hover:not(:disabled) { background: var(--accent-soft); color: var(--text); }
        .btn-add-family-member-settings:disabled { opacity: 0.6; cursor: not-allowed; }
        .btn-inventory-master { display: flex; align-items: center; justify-content: center; width: 100%; padding: 14px 20px; font-size: 1rem; font-weight: 600; border: 1px solid var(--btn-primary); background: transparent; color: var(--text); border-radius: var(--radius); cursor: pointer; transition: all 0.2s; }
        .btn-inventory-master:hover { background: var(--btn-primary); color: white; }
        .inventory-modal { position: fixed; inset: 0; background: rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center; z-index: 10000; }
        .inventory-modal-content { background: var(--surface-elevated); border-radius: var(--radius); padding: 24px; max-width: 500px; width: 90%; max-height: 90vh; overflow-y: auto; }
        .inventory-report-section { margin: 16px 0; padding: 12px; border-radius: 8px; }
        .inventory-report-section.ok { background: var(--success-soft); border: 1px solid var(--success); }
        .inventory-report-section.elsewhere { background: #fef3c7; border: 1px solid #d97706; }
        .inventory-report-section.missing { background: var(--error-soft); border: 1px solid var(--error); }
        /* Přihlašovací brána – čistě bílá, černá tlačítka, tenká limetková linka pod aktivní záložkou */
        .login-gate-overlay { position: fixed; inset: 0; background: #ffffff; z-index: 20000; display: flex; align-items: center; justify-content: center; padding: 32px 24px 48px; overflow-y: auto; }
        .login-gate-overlay.gate-child-theme { background: linear-gradient(160deg, #fefce8 0%, #fef9c3 50%, #fef3c7 100%); }
        .login-gate-card { background: #fff; border-radius: 20px; box-shadow: 0 4px 24px rgba(0,0,0,0.06), 0 0 0 1px var(--border); max-width: 640px; width: 100%; overflow: hidden; display: flex; flex-direction: column; min-height: 0; }
        .login-gate-hero { display: none; }
        .login-gate-hero-inner { display: none; }
        .login-gate-overlay.gate-child-theme .login-gate-hero { display: flex; background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); padding: 40px; align-items: center; justify-content: center; }
        .login-gate-overlay.gate-child-theme .login-gate-hero-inner { display: block; text-align: center; color: #92400e; font-size: 4rem; opacity: 0.7; }
        .login-gate-body { padding: 40px 36px 36px; overflow-y: auto; }
        .login-gate-tabs { display: flex; gap: 0; margin-bottom: 24px; background: var(--border-soft); border-radius: 12px; padding: 4px; }
        .login-gate-tab { flex: 1; padding: 12px 20px; font-size: 0.9rem; font-weight: 600; border: none; border-radius: 10px; background: transparent; color: var(--text-secondary); cursor: pointer; transition: all 0.2s ease; }
        .login-gate-tab:hover { color: var(--text); }
        .login-gate-tab.active { background: #fff; color: var(--text); box-shadow: 0 1px 3px rgba(0,0,0,0.06), inset 0 -3px 0 var(--accent); }
        .login-gate-overlay.gate-child-theme .login-gate-tab.active { background: #fefce8; color: #92400e; box-shadow: 0 1px 3px rgba(0,0,0,0.06), inset 0 -3px 0 #facc15; }
        .login-gate-title { font-size: 1.6rem; font-weight: 700; color: var(--text); margin: 0 0 10px; }
        .login-gate-subtitle { font-size: 1rem; color: var(--text-secondary); margin: 0 0 28px; line-height: 1.5; max-width: 480px; }
        .login-gate-form .field { margin-bottom: 18px; }
        .login-gate-form label { display: block; font-size: 0.875rem; font-weight: 600; color: var(--text); margin-bottom: 6px; }
        .login-gate-form input { width: 100%; padding: 12px 14px; border: 1px solid var(--border); border-radius: 10px; font-size: 1rem; box-sizing: border-box; }
        .login-gate-form input:focus { outline: none; border-color: var(--btn-primary); box-shadow: 0 0 0 2px rgba(29, 29, 31, 0.1); }
        .login-gate-trial { background: rgba(0,0,0,0.03); border: 1px solid var(--border); border-radius: 12px; padding: 14px 16px; margin-top: 20px; font-size: 0.9rem; color: var(--text-secondary); text-align: center; }
        .login-gate-divider { margin: 20px 0; text-align: center; color: var(--text-muted); font-size: 0.85rem; }
        .login-gate-family-wrap { margin-top: 16px; padding-top: 16px; border-top: 1px solid var(--border); }
        .btn-login-submit { width: 100%; padding: 14px 24px; font-size: 1rem; font-weight: 600; border: none; border-radius: 12px; background: var(--btn-primary); color: #fff; cursor: pointer; margin-top: 8px; transition: background 0.2s; }
        .btn-login-submit:hover { background: #000; }
        .login-gate-remember { display: flex; align-items: center; gap: 8px; margin: 12px 0 8px; font-size: 0.9rem; color: var(--text); cursor: pointer; }
        .login-gate-remember input { width: auto; margin: 0; }
        .login-gate-mode-switch { margin: 12px 0; text-align: center; }
        .login-gate-mode-link { background: none; border: none; color: var(--text); font-size: 0.9rem; cursor: pointer; text-decoration: underline; padding: 0; }
        .login-gate-mode-link:hover { color: var(--btn-primary); }
        .settings-modal-footer { display: flex; gap: 12px; justify-content: flex-end; align-items: center; flex-wrap: wrap; }
        .btn-logout-settings {
            padding: 10px 20px;
            font-size: 0.9rem;
            border-radius: 9999px;
            border: 1px solid #d1d5db;
            background: #fff;
            color: #374151;
            cursor: pointer;
            font-weight: 600;
            order: 0;
            transition: background 0.2s, border-color 0.2s, color 0.2s;
        }
        .btn-logout-settings:hover { background: #f9fafb; border-color: #9ca3af; color: #111827; }
        .settings-modal-footer .btn-activate-membership {
            padding: 10px 20px;
            font-size: 0.9rem;
            border-radius: 9999px;
            border: 1px solid #8DD311;
            background: #8DD311;
            color: #1d1d1f;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.2s, border-color 0.2s;
        }
        .settings-modal-footer .btn-activate-membership:hover { background: #7bc00f; border-color: #7bc00f; color: #1d1d1f; }
        .settings-modal-footer .btn-modal-submit {
            padding: 10px 20px;
            font-size: 0.9rem;
            border-radius: 9999px;
            border: 1px solid #1d1d1f;
            background: #1d1d1f;
            color: #fff;
            font-weight: 600;
            cursor: pointer;
            order: 1;
            transition: background 0.2s;
        }
        .settings-modal-footer .btn-modal-submit:hover { background: #333; }
        .settings-family-name-wrap { display: inline-flex; align-items: center; gap: 6px; }
        .settings-family-pending-dot { width: 8px; height: 8px; border-radius: 50%; background: var(--accent); flex-shrink: 0; }
        .book-pending-badge { display: inline-block; margin-top: 6px; padding: 4px 10px; font-size: 0.75rem; font-weight: 600; border-radius: 8px; background: #fef3c7; color: #92400e; }
        .btn-approve-pending { padding: 8px 14px; border-radius: 8px; border: none; background: #059669; color: #fff; font-weight: 600; cursor: pointer; font-size: 0.8rem; white-space: nowrap; }
        .btn-approve-pending:hover { background: #047857; }
        .btn-reject-pending { padding: 8px 14px; border-radius: 8px; border: none; background: #dc2626; color: #fff; font-weight: 600; cursor: pointer; font-size: 0.8rem; white-space: nowrap; }
        .btn-reject-pending:hover { background: #b91c1c; }
        .sidebar-nav-settings { position: relative; }
        .settings-pending-dot { position: absolute; top: 6px; right: 8px; width: 8px; height: 8px; border-radius: 50%; background: var(--accent); display: none; pointer-events: none; }
        .settings-family-pending-dot { background: var(--accent); }
        .btn-login-family { width: 100%; padding: 12px; font-size: 0.95rem; border: 1px solid var(--btn-primary); background: transparent; color: var(--text); border-radius: 10px; cursor: pointer; font-weight: 600; margin-bottom: 12px; }
        .btn-login-family:hover { background: rgba(0, 0, 0, 0.04); }
        .btn-login-google { width: 100%; padding: 14px 24px; font-size: 1rem; font-weight: 600; border: 1px solid var(--border); border-radius: 12px; background: #fff; color: var(--text); cursor: pointer; display: inline-flex; align-items: center; justify-content: center; gap: 10px; transition: background 0.2s, border-color 0.2s; }
        .btn-login-google:hover { background: var(--surface); border-color: var(--text-muted); }
        .btn-login-google svg { width: 20px; height: 20px; flex-shrink: 0; }
        .login-family-code-wrap { display: none; margin-top: 12px; }
        .login-family-code-wrap.visible { display: block; }
        .login-gate-footer { margin-top: 28px; padding-top: 16px; border-top: 1px solid var(--border); text-align: center; position: relative; }
        .login-gate-admin-dot { position: absolute; right: 0; bottom: 0; width: 24px; height: 24px; display: flex; align-items: center; justify-content: center; font-size: 1.2rem; color: var(--text-muted); cursor: pointer; opacity: 0.5; transition: opacity 0.2s; border: none; background: none; }
        .login-gate-admin-dot:hover { opacity: 1; color: var(--text); }
        .login-gate-soon { margin-top: 24px; padding: 20px 0; border-top: 1px solid var(--border); }
        .login-gate-soon-title { font-size: 0.8rem; font-weight: 600; color: var(--text-muted); margin: 0 0 12px; text-transform: uppercase; letter-spacing: 0.05em; }
        .login-gate-soon-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; }
        .login-gate-soon-item { display: flex; flex-direction: column; align-items: center; gap: 6px; padding: 14px 8px; background: var(--surface-elevated); border-radius: 12px; border: 1px solid var(--border); color: var(--text-muted); font-size: 0.8rem; }
        .login-gate-soon-item span:first-child { font-size: 1.5rem; opacity: 0.8; }
        .login-gate-soon-item .soon-badge { font-size: 0.7rem; color: var(--text-secondary); font-weight: 600; }
        .login-quick-setup { margin-top: 24px; padding-top: 24px; border-top: 1px solid var(--border); display: none; }
        .login-quick-setup.visible { display: block; }
        .login-quick-setup h4 { font-size: 1.05rem; margin: 0 0 14px; color: var(--text); }
        .login-quick-setup .quick-q { margin-bottom: 20px; }
        .login-quick-setup .quick-q-label { font-size: 0.9rem; font-weight: 600; color: var(--text); margin-bottom: 10px; display: block; }
        .login-quick-setup .quick-q-options { display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 10px; }
        .login-quick-setup .quick-opt { padding: 14px 12px; font-size: 0.85rem; border: 2px solid var(--border); border-radius: 12px; background: #fff; cursor: pointer; transition: all 0.2s; display: flex; flex-direction: column; align-items: center; gap: 6px; text-align: center; }
        .login-quick-setup .quick-opt .quick-opt-icon { font-size: 1.5rem; line-height: 1; }
        .login-quick-setup .quick-opt:hover { border-color: var(--btn-primary); background: rgba(0,0,0,0.03); }
        .login-quick-setup .quick-opt.selected { border-color: var(--btn-primary); background: rgba(0,0,0,0.04); color: var(--text); font-weight: 600; }
        .login-quick-setup .quick-opt input { display: none; }
        .family-code-section { margin-top: 16px; padding: 16px; background: var(--surface-elevated); border: 1px solid var(--border); border-radius: var(--radius); }
        .family-code-display { display: flex; gap: 8px; margin-top: 8px; }
        .family-code-display input { flex: 1; padding: 10px 12px; font-family: monospace; font-size: 0.85rem; }
        .btn-copy-family-code { padding: 10px 16px; white-space: nowrap; border: 1px solid var(--btn-primary); background: transparent; color: var(--text); border-radius: var(--radius-sm); cursor: pointer; font-weight: 500; }
        .btn-copy-family-code:hover { background: rgba(0,0,0,0.04); }
        /* OmniShelfKids: čisté pozadí, barvy jen u ikon a knih */
        .viewing-as-child .dashboard { background: #F9F9F9; min-height: 100vh; }
        .viewing-as-child .main-content { background: transparent; }
        .viewing-as-child .item-card-clean { background: #fff; box-shadow: 0 2px 12px rgba(0,0,0,0.06); border: 1px solid var(--border); }
        .viewing-as-child .main-header { background: #fff; border-radius: 0 0 16px 16px; border-bottom: 1px solid var(--border); }
        .viewing-as-child .sidebar { background: #fefce8; border-right-color: var(--border); }
        .btn-back-to-dashboard {
            display: block;
            width: 100%;
            padding: 10px 16px;
            margin-bottom: 12px;
            font-size: 0.85rem;
            font-weight: 600;
            color: #92400e;
            background: rgba(253, 230, 138, 0.5);
            border: 1px solid rgba(217, 119, 6, 0.3);
            border-radius: var(--radius-sm);
            cursor: pointer;
            text-align: left;
            font-family: inherit;
            transition: background 0.2s, border-color 0.2s;
        }
        .btn-back-to-dashboard:hover {
            background: rgba(253, 230, 138, 0.8);
            border-color: rgba(217, 119, 6, 0.5);
        }
        .viewing-as-child .sidebar-logo-icon { background: #facc15; }
        .viewing-as-child .sidebar-logo-icon svg { color: #92400e; }
        .viewing-as-child .sidebar-logo-icon img.sidebar-logo-img { filter: none; }
        .viewing-as-child .sidebar-slogan { display: none !important; }
        .viewing-as-child .sidebar-slogan { color: var(--text-secondary); }
        .viewing-as-child #sidebarChildrenLibrary { display: flex !important; flex-direction: column; }
        .children-library-tabs { display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 20px; padding: 0 0 12px; border-bottom: 1px solid var(--border); }
        .children-library-tabs button { padding: 8px 14px; font-size: 0.875rem; font-weight: 500; border: 1px solid var(--border); background: var(--surface-elevated); color: var(--text-secondary); border-radius: var(--radius-sm); cursor: pointer; transition: all 0.15s; font-family: inherit; }
        .children-library-tabs button:hover { background: rgba(0,0,0,0.04); color: var(--text); }
        .children-library-tabs button.active { background: #8DD311; color: #000; border-color: #8DD311; }
        .viewing-as-child .children-library-tabs button.active { background: var(--kids-yellow); color: #1d1d1f; border-color: var(--kids-yellow); }
        .viewing-as-child .children-tab-parent-only { display: none !important; }
        .viewing-as-child .children-tab-btn.children-tab-parent-only { display: none !important; }
        @media (max-width: 480px) { .login-gate-soon-grid { grid-template-columns: repeat(2, 1fr); } }

        /* ===========================
           Multi-modulární architektura
           =========================== */

        /* Sidebar – přepínač modulů (Library / Vitus / ...) */
        .sidebar-module-switcher {
            padding: 12px 16px 6px;
            display: flex;
            flex-direction: column;
            gap: 8px;
            border-bottom: 1px solid var(--border-soft);
        }
        .sidebar-module-btn {
            display: flex;
            align-items: center;
            gap: 10px;
            width: 100%;
            padding: 12px 14px;
            min-height: 48px;
            box-sizing: border-box;
            border-radius: 12px;
            border: 1px solid var(--border-soft);
            background: rgba(0, 0, 0, 0.02);
            color: var(--text-secondary);
            cursor: pointer;
            font-family: inherit;
            text-align: left;
            transition: background 0.15s, border-color 0.15s, color 0.15s;
        }
        .sidebar-module-btn:hover:not(:disabled) {
            background: rgba(0, 0, 0, 0.04);
            color: var(--text);
        }
        .sidebar-module-btn.active {
            background: var(--accent-soft);
            border-color: rgba(0, 0, 0, 0.06);
            color: var(--text);
        }
        body.module-library .sidebar-module-btn.active { border-color: rgba(132, 204, 22, 0.35); }
        body.module-vitus .sidebar-module-btn.active { border-color: rgba(92, 138, 106, 0.35); }
        .sidebar-module-icon {
            width: 26px;
            height: 26px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            border-radius: 14px;
            background: rgba(0, 0, 0, 0.05);
            font-size: 1rem;
            line-height: 1;
        }
        .sidebar-module-icon img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }
        .sidebar-module-label {
            font-size: 0.9rem;
            font-weight: 800;
            letter-spacing: 0.01em;
        }
        .sidebar-module-soon {
            margin-left: auto;
            font-size: 0.7rem;
            font-weight: 900;
            color: var(--text-muted);
            border: 1px solid var(--border-soft);
            padding: 2px 8px;
            border-radius: 999px;
            background: rgba(0, 0, 0, 0.02);
        }
        .sidebar-module-btn:disabled {
            opacity: 0.55;
            cursor: not-allowed;
        }
        .sidebar-module-link {
            text-decoration: none;
            color: inherit;
        }
        .sidebar-module-link:hover { color: var(--text); }
        .sidebar-nav-link {
            text-decoration: none;
            color: inherit;
            display: block;
        }

        /* Vitus – odlišná paleta (šalvějově zelená + zemitá) */
        body.module-vitus {
            --bg: #F5F7F3;
            --surface: #F5F7F3;
            --surface-elevated: #FBFBF6;
            --btn-primary: #2F3A2E;
            --accent: #5C8A6A;
            --accent-lime: #5C8A6A;
            --accent-soft: rgba(92, 138, 106, 0.14);
            --success: #2F6F4E;
            --success-soft: rgba(47, 111, 78, 0.12);
        }

        /* Bezpečnostní pojistka: ve Vitusu nikdy neukazuj knihovní UI */
        body.module-vitus #topBar,
        body.module-vitus #libraryModulesWrap,
        body.module-vitus #scanHistorySection,
        body.module-vitus #friendsRecommendationsSection,
        body.module-vitus #readingViewWrap,
        body.module-vitus #overdueBanner,
        body.module-vitus #statisticsSection {
            display: none !important;
        }
        /* Domovská stránka (module-home) */
        body.module-home #topBar .library-global-sort-wrap,
        body.module-home #topBar .global-search-wrap { display: none; }
        body.module-home #libraryModulesWrap,
        body.module-home #readingViewWrap,
        body.module-home #scanHistorySection,
        body.module-home #friendsRecommendationsSection,
        body.module-home #overdueBanner,
        body.module-home #statisticsSection,
        body.module-home #marketplaceSection,
        body.module-home #messagesSection,
        body.module-home #vitusSection {
            display: none !important;
        }

        /* Vitus placeholder menu v sidebaru */
        .sidebar-menu--vitus { padding: 6px 0 10px; }
        .sidebar-vitus-title {
            font-size: 0.75rem;
            font-weight: 900;
            letter-spacing: 0.08em;
            text-transform: uppercase;
            color: var(--text-muted);
            padding: 10px 16px 6px;
        }
        .vitus-nav-item {
            display: flex;
            align-items: center;
            width: 100%;
            padding: 12px 16px;
            border-radius: var(--radius-sm);
            font-size: 0.9375rem;
            font-weight: 700;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.15s;
            border: none;
            background: none;
            text-align: left;
            font-family: inherit;
        }
        .vitus-nav-item:hover { background: rgba(0, 0, 0, 0.04); color: var(--text); }
        .vitus-nav-item.active { background: rgba(92, 138, 106, 0.14); color: var(--text); }

        /* Vitus dashboard */
        .vitus-section {
            padding: 22px 24px 32px;
        }
        .vitus-hero {
            border-radius: 20px;
            padding: 18px 18px;
            background:
                radial-gradient(1200px 300px at 0% 0%, rgba(92, 138, 106, 0.22), transparent 55%),
                radial-gradient(800px 260px at 100% 0%, rgba(168, 142, 98, 0.18), transparent 55%),
                linear-gradient(180deg, #FBFBF6, #F5F7F3);
            border: 1px solid var(--border);
            box-shadow: var(--shadow-card);
        }
        .vitus-hero-badge {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-size: 0.75rem;
            font-weight: 900;
            letter-spacing: 0.07em;
            text-transform: uppercase;
            color: #2F3A2E;
            background: rgba(92, 138, 106, 0.14);
            border: 1px solid rgba(92, 138, 106, 0.25);
            padding: 6px 10px;
            border-radius: 999px;
        }
        .vitus-hero-title {
            margin-top: 10px;
            font-size: 1.6rem;
            font-weight: 900;
            letter-spacing: -0.02em;
        }
        .vitus-hero-sub {
            margin-top: 6px;
            color: var(--text-secondary);
            font-weight: 600;
        }
        .vitus-panel {
            margin-top: 14px;
            border-radius: 20px;
            border: 1px solid var(--border);
            background: var(--surface-elevated);
            box-shadow: var(--shadow-card);
            overflow: hidden;
        }
        .vitus-panel-header {
            padding: 14px 16px;
            display: flex;
            align-items: baseline;
            justify-content: space-between;
            gap: 12px;
            border-bottom: 1px solid var(--border-soft);
        }
        .vitus-panel-title { font-size: 1.05rem; font-weight: 900; }
        .vitus-panel-hint { font-size: 0.8rem; color: var(--text-muted); font-weight: 700; }
        .vitus-panel-body { padding: 14px 16px 18px; }
        .vitus-muted { color: var(--text-secondary); font-weight: 600; }

        /* Vitus – UI blocks (Moje Apatyka + Poličky + Kúry) */
        .vitus-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 14px;
            margin-top: 14px;
        }
        .vitus-card {
            border: 1px solid var(--border);
            border-radius: 20px;
            background: var(--surface-elevated);
            box-shadow: var(--shadow-card);
            overflow: hidden;
        }
        .vitus-card--wide { margin-top: 14px; }
        .vitus-card-head {
            padding: 14px 16px;
            border-bottom: 1px solid var(--border-soft);
            background: linear-gradient(180deg, rgba(92, 138, 106, 0.08), transparent);
        }
        .vitus-card-title { font-size: 1.05rem; font-weight: 900; }
        .vitus-card-sub { margin-top: 2px; font-size: 0.85rem; color: var(--text-secondary); font-weight: 600; }

        .vitus-form { padding: 14px 16px 16px; }
        .vitus-form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 10px; }
        .vitus-form-row--inline { display: flex; flex-wrap: wrap; align-items: center; gap: 10px 16px; margin-bottom: 8px; }
        .vitus-form-row--inline.vitus-form-row--full { display: flex; }
        .vitus-field { display: flex; flex-direction: column; gap: 6px; }
        .vitus-field-inline { display: flex; align-items: center; gap: 8px; min-width: 0; }
        .vitus-field-inline .vitus-label { flex-shrink: 0; width: auto; min-width: 0; margin: 0; white-space: nowrap; }
        .vitus-field-inline .vitus-input { flex: 1; min-width: 80px; }
        .vitus-form--compact .vitus-form-row--inline .vitus-field-inline { flex: 0 1 auto; }
        .vitus-form--compact .vitus-form-row--full .vitus-field-inline { flex: 1 1 100%; }
        .vitus-form--compact .vitus-form-row--full .vitus-field-inline .vitus-input { flex: 1; min-width: 0; }
        .vitus-cover-block { margin-top: 8px; margin-bottom: 8px; }
        .vitus-cover-preview { margin-bottom: 4px; }
        .vitus-cover-preview img { max-width: 120px; max-height: 100px; object-fit: contain; border-radius: 10px; border: 1px solid var(--border); }
        .vitus-cover-from-scan { font-size: 0.8rem; color: var(--text-secondary); font-weight: 600; margin: 4px 0 0 0; }
        .vitus-field--full { grid-column: 1 / -1; }
        .vitus-label { font-size: 0.75rem; font-weight: 900; color: var(--text-muted); letter-spacing: 0.06em; text-transform: uppercase; }
        .vitus-input {
            width: 100%;
            padding: 10px 12px;
            border-radius: 12px;
            border: 1px solid var(--border);
            background: #fff;
            color: var(--text);
            font-family: inherit;
            font-size: 0.95rem;
            font-weight: 600;
        }
        body.module-vitus .vitus-input { background: #FBFBF6; }
        .vitus-select { cursor: pointer; }
        .vitus-actions { display: flex; align-items: center; gap: 10px; margin-top: 6px; }
        .vitus-form-hint { font-size: 0.85rem; color: var(--text-secondary); font-weight: 700; }

        .vitus-btn {
            border-radius: 12px;
            border: 1px solid var(--border);
            background: rgba(0,0,0,0.02);
            padding: 10px 12px;
            font-family: inherit;
            font-weight: 900;
            cursor: pointer;
            transition: background 0.15s, transform 0.15s;
        }
        .vitus-btn:disabled {
            opacity: 0.55;
            cursor: not-allowed;
            transform: none !important;
        }
        .vitus-btn:hover { background: rgba(0,0,0,0.04); transform: scale(1.01); }
        .vitus-btn.is-loading {
            position: relative;
            padding-right: 40px;
        }
        .vitus-btn.is-loading::after {
            content: '';
            position: absolute;
            right: 14px;
            top: 50%;
            width: 14px;
            height: 14px;
            margin-top: -7px;
            border-radius: 50%;
            border: 2px solid rgba(92, 138, 106, 0.35);
            border-top-color: rgba(92, 138, 106, 0.95);
            animation: vitusSpin 0.8s linear infinite;
        }
        @keyframes vitusSpin { to { transform: rotate(360deg); } }
        .vitus-btn--primary {
            background: rgba(92, 138, 106, 0.14);
            border-color: rgba(92, 138, 106, 0.25);
            color: #2F3A2E;
        }
        .vitus-btn--dose {
            background: rgba(168, 142, 98, 0.16);
            border-color: rgba(168, 142, 98, 0.26);
            color: #3A2F24;
        }
        .vitus-btn--ghost { background: transparent; }

        .vitus-shelves { padding: 14px 16px 18px; display: grid; gap: 12px; }
        .vitus-shelf {
            border: 1px solid var(--border-soft);
            background: rgba(92, 138, 106, 0.06);
            border-radius: 16px;
            padding: 12px;
        }
        .vitus-shelf-title { font-weight: 900; color: #2F3A2E; margin-bottom: 10px; }
        .vitus-shelf-grid { display: grid; grid-template-columns: 1fr; gap: 10px; }

        .vitus-med-card {
            border: 1px solid rgba(0,0,0,0.06);
            background: #FBFBF6;
            border-radius: 14px;
            padding: 10px 10px;
            box-shadow: 0 1px 2px rgba(0,0,0,0.04);
            display: grid;
            grid-template-columns: 56px 1fr;
            gap: 10px;
            cursor: pointer;
        }
        .vitus-med-main { min-width: 0; }
        .vitus-med-top { display: flex; align-items: flex-start; justify-content: space-between; gap: 10px; }
        .vitus-med-name { font-weight: 1000; letter-spacing: -0.01em; }
        .vitus-med-badges { display: inline-flex; gap: 6px; flex-wrap: wrap; justify-content: flex-end; }
        .vitus-med-cover {
            width: 56px;
            height: 56px;
            border-radius: 14px;
            overflow: hidden;
            border: 1px solid rgba(0,0,0,0.06);
            background: rgba(92, 138, 106, 0.10);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #2F3A2E;
            flex-shrink: 0;
        }
        .vitus-med-cover img { width: 100%; height: 100%; object-fit: cover; display: block; }
        .vitus-med-cover--empty span { font-size: 1.4rem; }
        .vitus-badge {
            font-size: 0.72rem;
            font-weight: 1000;
            padding: 3px 8px;
            border-radius: 999px;
            border: 1px solid rgba(0,0,0,0.06);
            background: rgba(0,0,0,0.03);
            color: var(--text-secondary);
            white-space: nowrap;
        }
        .vitus-badge--qty {
            background: rgba(92, 138, 106, 0.12);
            border-color: rgba(92, 138, 106, 0.20);
            color: #2F3A2E;
        }
        .vitus-badge--warn {
            background: rgba(168, 142, 98, 0.16);
            border-color: rgba(168, 142, 98, 0.24);
            color: #3A2F24;
        }
        .vitus-badge--danger {
            background: rgba(220, 38, 38, 0.12);
            border-color: rgba(220, 38, 38, 0.18);
            color: #7f1d1d;
        }
        .vitus-med-meta { margin-top: 6px; display: grid; gap: 4px; }
        .vitus-meta-item { font-size: 0.86rem; color: var(--text-secondary); font-weight: 650; }
        .vitus-med-actions { margin-top: 8px; display: flex; gap: 8px; }
        .vitus-med-actions .vitus-btn { cursor: pointer; }

        .vitus-cures-grid { display: grid; grid-template-columns: 1.2fr 0.8fr; gap: 14px; padding: 14px 16px 18px; }
        .vitus-checkboxes { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; padding: 8px 10px; border: 1px dashed rgba(92, 138, 106, 0.25); border-radius: 14px; background: rgba(92, 138, 106, 0.06); }
        .vitus-checkbox { display: flex; align-items: center; gap: 8px; font-weight: 800; color: var(--text-secondary); }
        .vitus-active-title { font-weight: 1000; margin-bottom: 10px; }
        .vitus-active-cures { display: grid; gap: 10px; }
        .vitus-cure-card {
            border: 1px solid rgba(0,0,0,0.06);
            background: #FBFBF6;
            border-radius: 16px;
            padding: 12px;
        }
        .vitus-cure-top { display: flex; align-items: baseline; justify-content: space-between; gap: 10px; }
        .vitus-cure-name { font-weight: 1000; }
        .vitus-cure-days { font-weight: 1000; color: #2F6F4E; }
        .vitus-cure-meta { margin-top: 6px; display: flex; flex-wrap: wrap; gap: 6px; color: var(--text-secondary); font-weight: 700; font-size: 0.86rem; }

        .vitus-empty { color: var(--text-secondary); font-weight: 700; padding: 10px 0; }

        @media (max-width: 980px) {
            .vitus-grid { grid-template-columns: 1fr; }
            .vitus-cures-grid { grid-template-columns: 1fr; }
            .vitus-form-row { grid-template-columns: 1fr; }
            .vitus-checkboxes { grid-template-columns: 1fr; }
        }

        /* Vitus – accordion + scan panel */
        .vitus-accordion {
            border: 1px solid var(--border);
            border-radius: 20px;
            background: var(--surface-elevated);
            box-shadow: var(--shadow-card);
            overflow: hidden;
        }
        .vitus-accordion-summary {
            list-style: none;
            cursor: pointer;
            padding: 14px 16px;
            border-bottom: 1px solid var(--border-soft);
            background:
                radial-gradient(900px 200px at 0% 0%, rgba(92, 138, 106, 0.18), transparent 55%),
                linear-gradient(180deg, rgba(168, 142, 98, 0.10), transparent);
        }
        .vitus-accordion-summary::-webkit-details-marker { display: none; }
        .vitus-accordion-title { font-size: 1.05rem; font-weight: 1000; }
        .vitus-accordion-sub { margin-top: 4px; font-size: 0.86rem; color: var(--text-secondary); font-weight: 650; }
        .vitus-accordion-body { padding: 14px 16px 16px; }
        .vitus-add-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 14px; }
        .vitus-scan-pad { padding: 14px 16px 16px; }
        .vitus-scan-target { display: flex; align-items: center; gap: 10px; flex-wrap: wrap; margin-bottom: 10px; }
        .vitus-scan-target-label { font-size: 0.75rem; font-weight: 900; color: var(--text-muted); letter-spacing: 0.06em; text-transform: uppercase; }
        .vitus-pill { display: inline-flex; align-items: center; gap: 8px; padding: 6px 10px; border-radius: 999px; border: 1px solid rgba(92, 138, 106, 0.22); background: rgba(92, 138, 106, 0.08); font-weight: 900; color: #2F3A2E; cursor: pointer; }
        .vitus-pill input { accent-color: #5C8A6A; }
        .vitus-dropzone {
            border: 1px dashed rgba(92, 138, 106, 0.35);
            border-radius: 16px;
            padding: 14px;
            background: rgba(92, 138, 106, 0.06);
            transition: background 0.15s, border-color 0.15s;
        }
        .vitus-dropzone.is-dragover { background: rgba(92, 138, 106, 0.12); border-color: rgba(92, 138, 106, 0.55); }
        .vitus-dropzone-inner { text-align: center; }
        .vitus-dropzone-icon { font-size: 1.6rem; }
        .vitus-dropzone-title { font-weight: 1000; margin-top: 6px; }
        .vitus-dropzone-sub { margin-top: 4px; color: var(--text-secondary); font-weight: 650; font-size: 0.86rem; }
        .vitus-dropzone-tip { margin-top: 8px; padding: 6px 10px; border-radius: 8px; background: rgba(92, 138, 106, 0.1); color: var(--text-secondary); font-size: 0.78rem; font-weight: 600; }
        .vitus-dropzone-tip strong { color: var(--vitus-primary, #3d6b4f); }
        .vitus-scan-preview { margin-top: 10px; padding: 10px 12px; border-radius: 14px; border: 1px solid rgba(0,0,0,0.06); background: #FBFBF6; color: var(--text-secondary); font-weight: 750; }
        .vitus-scan-file-list { margin-top: 8px; display: flex; flex-wrap: wrap; gap: 6px; }
        .vitus-scan-file-pill {
            font-size: 0.75rem;
            font-weight: 900;
            padding: 4px 8px;
            border-radius: 999px;
            border: 1px solid rgba(92, 138, 106, 0.20);
            background: rgba(92, 138, 106, 0.10);
            color: #2F3A2E;
        }
        .vitus-actions--scan { justify-content: space-between; }
        .vitus-scan-tips { font-weight: 900; color: #2F6F4E; text-decoration: none; }
        .vitus-scan-tips:hover { text-decoration: underline; }
        .vitus-inline-link {
            border: none;
            background: transparent;
            padding: 0;
            font: inherit;
            font-weight: 900;
            color: #2F6F4E;
            cursor: pointer;
            text-decoration: underline;
        }
        .vitus-cover-preview { margin-top: 10px; }
        .vitus-cover-preview img { width: 100%; max-width: 240px; border-radius: 16px; border: 1px solid rgba(0,0,0,0.06); display: block; }

        /* Vitus – modal (detail léku) */
        .vitus-modal-overlay[hidden] { display: none !important; }
        .vitus-modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.45);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            z-index: 9999;
        }
        .vitus-modal {
            width: min(980px, 96vw);
            max-height: 90vh;
            overflow: auto;
            background: var(--surface-elevated);
            border-radius: 20px;
            border: 1px solid rgba(0,0,0,0.12);
            box-shadow: 0 18px 60px rgba(0,0,0,0.25);
        }
        .vitus-modal-top {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 10px;
            padding: 14px 16px;
            border-bottom: 1px solid var(--border-soft);
            background: linear-gradient(180deg, rgba(92, 138, 106, 0.10), transparent);
        }
        .vitus-modal-title { font-weight: 1000; }
        .vitus-modal-close {
            width: 40px;
            height: 40px;
            border-radius: 12px;
            border: 1px solid rgba(0,0,0,0.10);
            background: rgba(0,0,0,0.02);
            cursor: pointer;
            font-size: 1.2rem;
        }
        .vitus-modal-body { padding: 14px 16px 18px; max-height: 85vh; overflow-y: auto; }
        .vitus-modal-grid { display: grid; grid-template-columns: 240px 1fr; gap: 14px; }
        .vitus-modal-cover { display: grid; gap: 10px; align-content: start; }
        .vitus-modal-cover-img {
            width: 100%;
            aspect-ratio: 1 / 1;
            object-fit: cover;
            border-radius: 18px;
            border: 1px solid rgba(0,0,0,0.06);
            background: rgba(92, 138, 106, 0.06);
        }
        .vitus-modal-cover-empty {
            width: 100%;
            aspect-ratio: 1 / 1;
            border-radius: 18px;
            border: 1px dashed rgba(92, 138, 106, 0.25);
            background: rgba(92, 138, 106, 0.06);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-secondary);
            font-weight: 800;
        }
        .vitus-form--modal { padding: 0; }
        .vitus-ai-disclaimer {
            margin-top: 10px;
            font-size: 0.78rem;
            color: var(--text-muted);
            font-weight: 700;
            line-height: 1.35;
        }
        .vitus-input--large { min-height: 44px; font-size: 1rem; padding: 10px 14px; }
        .vitus-textarea, .vitus-textarea-add {
            min-height: 60px;
            resize: vertical;
            font-size: 1rem;
            line-height: 1.5;
            padding: 10px 14px;
            overflow-y: auto;
        }
        .vitus-textarea--name { min-height: 52px; font-size: 1.1rem; font-weight: 600; }
        .vitus-textarea--ai, .vitus-textarea-add--ai { min-height: 80px; }
        .vitus-textarea--herbalist { min-height: 60px; background: rgba(92, 138, 106, 0.08); border-color: rgba(92, 138, 106, 0.3); }
        .vitus-field-inline--full { flex: 1 1 100%; }
        .vitus-field-inline--full .vitus-input { min-width: 0; }
        .vitus-detail-block {
            margin-top: 18px;
            padding: 16px;
            border-radius: 14px;
            border: 1px solid rgba(92, 138, 106, 0.25);
            background: rgba(92, 138, 106, 0.06);
        }
        .vitus-detail-block--herbalist {
            border-color: rgba(92, 138, 106, 0.4);
            background: rgba(92, 138, 106, 0.1);
        }
        .vitus-detail-block--sos { background: rgba(168, 142, 98, 0.08); border-color: rgba(168, 142, 98, 0.3); }
        .vitus-detail-block-title {
            font-size: 0.9rem;
            font-weight: 900;
            color: #2F3A2E;
            margin: 0 0 12px;
            letter-spacing: 0.02em;
        }
        .vitus-sos-buttons { display: flex; flex-wrap: wrap; gap: 10px; }
        .vitus-btn--sos {
            background: rgba(168, 142, 98, 0.2);
            color: #2F3A2E;
            font-weight: 800;
        }
        .vitus-btn--sos:disabled { opacity: 0.6; cursor: not-allowed; }
        @media (max-width: 980px) {
            .vitus-add-grid { grid-template-columns: 1fr; }
            .vitus-modal-grid { grid-template-columns: 1fr; }
        }

        /* Spodní Tab Bar (mobil) – vždy nahoře kvůli proklikům */
        .bottom-tab-bar {
            display: none;
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 56px;
            padding-bottom: env(safe-area-inset-bottom, 0);
            background: var(--surface-elevated);
            border-top: 1px solid var(--border);
            z-index: 1100;
            flex-direction: row;
            align-items: center;
            justify-content: space-around;
            box-shadow: 0 -2px 12px rgba(0,0,0,0.06);
        }
        .bottom-tab-bar[hidden] { display: none !important; }
        @media (max-width: 768px) {
            .bottom-tab-bar:not([hidden]) { display: flex; }
            .dashboard .main-content { padding-bottom: 72px; }
        }
        .bottom-tab-item {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 2px;
            padding: 10px 12px;
            min-height: 48px;
            min-width: 0;
            border: none;
            background: transparent;
            color: var(--text-muted);
            font-size: 0.7rem;
            font-weight: 700;
            cursor: pointer;
            -webkit-tap-highlight-color: transparent;
            text-decoration: none;
            box-sizing: border-box;
        }
        .bottom-tab-item:hover { color: var(--text); }
        .bottom-tab-item.active { color: var(--accent); }
        .bottom-tab-icon {
            width: 26px;
            height: 26px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .bottom-tab-icon img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }
        .bottom-tab-label { line-height: 1.1; }

        /* Domovská stránka – hlavní police (dle předlohy) */
        .home-dashboard-section {
            padding: 0 0 32px;
            max-width: 640px;
            margin: 0 auto;
        }
        .home-hero {
            padding: 32px 24px 40px;
            margin: 0 0 24px;
        }
        .home-hero-gradient {
            background: linear-gradient(180deg, rgba(141, 211, 17, 0.15) 0%, rgba(184, 230, 78, 0.08) 30%, rgba(232, 248, 212, 0.05) 60%, transparent 100%);
        }
        .home-hero-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text);
            margin: 0 0 12px;
            line-height: 1.25;
        }
        .home-hero-subtitle {
            font-size: 0.9375rem;
            color: var(--text);
            opacity: 0.85;
            margin: 0;
            line-height: 1.5;
        }
        .home-dashboard-inner {
            display: flex;
            flex-direction: column;
            gap: 28px;
            padding: 0 20px;
        }
        .home-modules-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            list-style: none;
            margin: 0;
            padding: 0;
        }
        .home-module-card {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 20px 16px;
            background: #fff;
            border: 1px solid rgba(141, 211, 17, 0.35);
            border-radius: 16px;
            text-decoration: none;
            color: var(--text);
            font-weight: 600;
            font-size: 0.9375rem;
            transition: border-color 0.2s, box-shadow 0.2s;
            position: relative;
            box-sizing: border-box;
        }
        .home-module-card:hover {
            border-color: var(--accent);
            box-shadow: 0 2px 12px rgba(141, 211, 17, 0.15);
        }
        .home-module-icon {
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .home-module-icon img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }
        .home-module-soon {
            position: absolute;
            top: 8px;
            right: 8px;
            font-size: 0.65rem;
            font-weight: 700;
            color: var(--text-muted);
            background: var(--surface);
            padding: 2px 6px;
            border-radius: 6px;
        }
        .home-section-title {
            font-size: 1rem;
            font-weight: 600;
            color: var(--text);
            margin: 0 0 12px;
        }
        .home-notifications {
            background: var(--surface-elevated);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 16px;
        }
        .home-notifications-list {
            list-style: none;
            margin: 0;
            padding: 0;
        }
        .home-notification-item {
            margin-bottom: 8px;
        }
        .home-notification-item:last-child {
            margin-bottom: 0;
        }
        .home-notification-link {
            display: block;
            padding: 10px 12px;
            border-radius: 10px;
            color: var(--text);
            text-decoration: none;
            font-size: 0.9375rem;
            transition: background 0.2s;
        }
        .home-notification-link:hover {
            background: rgba(141, 211, 17, 0.12);
        }
        .home-notifications-empty {
            font-size: 0.9375rem;
            color: var(--text-muted);
            margin: 0;
            padding: 12px 0;
        }
        .home-overview {
            background: #F5F7F3;
            border: 1px solid rgba(92, 138, 106, 0.2);
            border-radius: 16px;
            padding: 16px;
        }
        .home-overview-cards {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        .home-overview-card {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            padding: 12px;
            background: #FBFBF6;
            border-radius: 12px;
        }
        .home-overview-icon {
            font-size: 1.5rem;
            line-height: 1;
        }
        .home-overview-content {
            flex: 1;
        }
        .home-overview-content strong {
            display: block;
            font-size: 0.9375rem;
            margin-bottom: 4px;
        }
        .home-overview-content p {
            font-size: 0.875rem;
            color: var(--text-muted);
            margin: 0;
        }
        @media (min-width: 480px) {
            .home-modules-grid {
                grid-template-columns: repeat(4, 1fr);
            }
        }
